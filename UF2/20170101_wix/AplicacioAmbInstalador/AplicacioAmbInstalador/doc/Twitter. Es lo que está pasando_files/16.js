webpackJsonp([16],Array(58).concat([function(t,e,i){(function(e){var s=i(59),n=i(67),o=i(72),a=i(75),r=i(76),c=i(27),h=i(101),l=i(102),d=i(103),u=i(104),m=i(105),p=i(207),g=i(208),f=i(210),v=i(220),S=i(222),w=i(223),b=i(323),C=i(409),y=i(412),T=i(414),D=i(415),I=i(416),k=i(417),M=i(418),x=i(419),P=i(421),A=i(422),E=i(423),R=i(429),N=i(88),F=i(430),O=i(431),L=i(432),U=i(433),$=i(434),B=i(435),V=i(436),q=i(438),j=i(439),H=i(443),z=i(445),W=i(448),G=i(452),Q=i(454),K=i(455),J=i(456),Y=i(457),X=i(459),Z=i(460),tt=i(461),et=i(463),it=i(464),st=i(465),nt=i(466),ot=i(344),at=i(468),rt=i(475),ct=i(476),ht=i(509),lt=i(510),dt=i(511),ut=i(512),mt=i(513),pt=i(514),gt=i(519),ft=i(520),vt=i(521),St=i(522),wt=i(458),bt=i(523),Ct=i(524),yt=i(527),Tt=i(528),Dt=i(529),It=i(530),_t=i(531),kt=i(532),Mt=i(536),xt=i(537),Pt=i(553),At=i(34),Et=i(554),Rt=i(555);t.exports=function(t){if(b.set(t.dm),c(t),et.attachTo(document,{noTeardown:!0}),mt.attachTo(document),y.attachTo("body"),N.attachTo(document),vt.attachTo("body",{noTeardown:!0}),m.attachTo(document,{noTeardown:!0}),u.attachTo("#spam_challenge_dialog",{noTeardown:!0}),Tt.attachTo(document,t,{noTeardown:!0}),t.loggedIn){Y.attachTo(document,t,{noTeardown:!0});var i=b.get("poll_options");i?C.attachTo(document,{foregroundPollInterval:i.foreground_poll_interval,burstPollInterval:i.burst_poll_interval,burstPollDuration:i.burst_poll_duration,maxPollInterval:i.max_poll_interval,noTeardown:!0}):C.attachTo(document,{foregroundPollInterval:1e3*t.deciders.dm_polling_frequency_in_seconds,noTeardown:!0}),t.deciders.live_pipeline_consume&&V.attachTo(document),$.attachTo("#list-membership-dialog",t,{noTeardown:!0}),B.attachTo("#list-operations-dialog",t,{noTeardown:!0}),f.attachTo("#create-custom-timeline-dialog",t),v.attachTo("#curate-dialog",t),z.attachTo("#moments-summary-list-dialog",t),w(t),D.attachTo(document,{noTeardown:!0}),k.attachTo(document,{noTeardown:!0}),I.attachTo(document,{noTeardown:!0}),rt.attachTo(document,{currentUserPath:t.routes.profile,noTeardown:!0})}St.attachTo(document),At.getDecider("native_notifications")&&(Q.attachTo(document,{defaultIcon:t.defaultNotificationIcon}),K.attachTo(document)),At.getDecider("installNativePush")&&(lt.attachTo(document),ht.attachTo(document,{autoSubscribe:At.getDecider("autoSubscribeNativePush"),allowRegistration:At.getDecider("enableNativePush"),noTeardown:!0})),Pt.attachTo(document,{noTeardown:!0}),xt.attachTo(document,t.typeaheadData,{noTeardown:!0}),ft.attachTo(document,{noTeardown:!0}),gt.attachTo(document,{noTeardown:!0}),O.attachTo("#goto-user-dialog",t),at({profile_user:t.profile_user,deviceEnabled:t.deviceEnabled,deviceVerified:t.deviceVerified,formAuthenticityToken:t.formAuthenticityToken,loggedIn:t.loggedIn}),R.attachTo(document,{noTeardown:!0});var Nt={itemType:"tweet",noTeardown:!0,loggedIn:t.loggedIn,eventData:{scribeContext:{component:"gallery"}}};E.attachTo(".Gallery",t,Nt),kt.attachTo(".Gallery",t,Nt),W.attachTo(".Gallery",t,Nt),Z.attachTo(document,{noTeardown:!0}),X.attachTo(document,t),L.attachTo(document,t,{noTeardown:!0,loggedIn:t.loggedIn,keyboardShortcuts:t.keyboardShortcuts}),g.attachTo(document,t,{noTeardown:!0}),pt.attachTo("#retweet-tweet-dialog",t,{noTeardown:!0}),S.attachTo("#delete-tweet-dialog",t,{noTeardown:!0}),dt.attachTo("#quick-promote-dialog",t,{noTeardown:!0}),r.attachTo("#block-user-dialog",t,{noTeardown:!0}),M.attachTo(document,{noTeardown:!0}),x.attachTo("#embed-tweet-dialog",t,{noTeardown:!0}),a.attachTo("#block-dialog",t,{noTeardown:!0}),ut.attachTo("#report-dialog",t,{noTeardown:!0}),s.attachTo("#age-gate-dialog",t,{noTeardown:!0}),U.attachTo("#leadgen-confirm-dialog",t),wt("uiWantsToRefreshTimestamps"),it.attachTo(document),nt.attachTo(document,{noTeardown:!0}),Dt.attachTo(document,{noTeardown:!0}),_t.attachTo("#translation-feedback-dialog",t,{noTeardown:!0}),j.attachTo("#media-edit-dialog",{noTeardown:!0}),J.attachTo(".dashboard",{eventData:{scribeContext:{component:"dashboard_nav"}}}),A.attachTo("#feedback_dialog",t.debugData,{noTeardown:!0}),P.attachTo(document,t.debugData,{noTeardown:!0}),e(".uz_block_user_survey")[0]&&Rt.attachTo(".uz_block_user_survey"),ct(t),F.attachTo(document,t,{noTeardown:!0}),p.attachTo(document,t,{noTeardown:!0}),h.attachTo("#bouncer-dialog",t,{noTeardown:!0}),l.attachTo("#buy-now-dialog",t,{noTeardown:!0}),d.attachTo(document,{noTeardown:!0}),tt.attachTo("#offers-dialog",t,{noTeardown:!0}),st.attachTo("#payment-order-detail-dialog",t,{noTeardown:!0}),q.attachTo("#location-picker-dialog",t,{noTeardown:!0}),n.attachTo("#auth-webview-dialog",t,{noTeardown:!0}),G.attachTo(document),Mt.attachTo(document,t,{noTeardown:!0}),bt.attachTo("#sms-confirmation-dialog"),Ct.attachTo("#sms-confirmation-dialog",t,{noTeardown:!0}),yt.attachTo(document),T.attachTo(document,{includeLongVideos:At.getDecider("dynamic_video_ads_include_long_videos")}),Et.attachTo(document,t,{noTeardown:!0}),It.attachTo(document,{noTeardown:!0}),o.attachTo("#page-container",t),ot.attachTo("#page-container",{liveVideoContinuePlayingBehindModalsEnabled:t.liveVideoContinuePlayingBehindModalsEnabled}),H.attachTo(document)}}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({submitButtonSelector:"#age-gate-dialog-submit-button",monthSelector:"#age-gate-month",daySelector:"#age-gate-day",yearSelector:"#age-gate-year",requiredSelector:".age-gate-error",ageGateCookieKey:"age-gated"}),this.setUpDialog=function(t,e){e.ageGated?this.showError():(this.reset(),this.ageData=e,this.setDateOption(),this.open())},this.fillYearSelect=function(){for(var t=(new Date).getFullYear(),e=t;e>t-100;e--)this.yearSelect.options.add(new Option(e,e));this.yearSelect.options.add(new Option(_("Antes de {{year}}",{year:e}),e))},this.month={1:"enero",2:"febrero",3:"marzo",4:"abril",5:"may",6:"junio",7:"julio",8:"agosto",9:"septiembre",10:"octubre",11:"noviembre",12:"diciembre"},this.fillMonthSelect=function(){for(var t=1;t<=12;t++)this.monthSelect.options.add(new Option(this.month[t],t))},this.fillDaySelect=function(t,e){t||(t=1),e||(e=31);for(var i=t;i<=e;i++)this.daySelect.options.add(new Option(i,i))},this.resetSelect=function(t,e){t.options.length=0,t.options.add(new Option(e,(-1),(!0),(!0))),t.options[0].disabled=!0},this.reset=function(){this.resetSelect(this.yearSelect,"Año"),this.resetSelect(this.monthSelect,"Mes"),this.resetSelect(this.daySelect,"Día"),this.hideRequired()},this.setDateOption=function(){this.fillYearSelect(),this.fillMonthSelect(),this.fillDaySelect()},this.showRequired=function(){this.select("requiredSelector").removeClass("hidden")},this.hideRequired=function(){this.select("requiredSelector").addClass("hidden")},this.getDateFromSelect=function(){var t={};return t.year=this.yearSelect.options[this.yearSelect.selectedIndex].value,t.month=this.monthSelect.options[this.monthSelect.selectedIndex].value,t.day=this.daySelect.options[this.daySelect.selectedIndex].value,t},this.getNumberOfDaysGivenMonthYear=function(t,e){return e<0&&(e=2012),new Date(e,t,0).getDate()},this.validateDate=function(){var t=this.getDateFromSelect(),e=t.year>=0&&t.month>=0&&t.month<=12&&t.day>=0&&t.day<=this.getNumberOfDaysGivenMonthYear(t.month,t.year);return e?new Date(t.year,t.month-1,t.day):("-1"===t.year||"-1"===t.month||"-1"===t.day?this.showRequired():this.trigger("uiShowMessage",{message:"Fecha no válida. Por favor, introduce tu fecha de nacimiento."}),null)},this.updateDays=function(){var t,e=this.getDateFromSelect();this.hideRequired(),e.month<1||e.month>12||(this.resetSelect(this.daySelect,"Day"),t=this.getNumberOfDaysGivenMonthYear(e.month,e.year),this.fillDaySelect(1,t),e.day>0&&e.day<=t&&(this.daySelect.selectedIndex=e.day))},this.showError=function(){this.trigger("uiShowMessage",{message:"No cumples con los requisitos de edad mínima para seguir a esta cuenta."})},this.setAgeGateCookie=function(){r(this.attr.ageGateCookieKey,(new Date).getTime())},this.submitAgeGating=function(){var t=this.validateDate();t&&(t.getTime()<=this.ageData.minBirthDate?this.trigger("uiAgeGatePassed",a.merge(this.ageData.originalData,{passedAgeGating:!0})):(this.showError(),this.setAgeGateCookie()),this.close())},this.after("initialize",function(){this.monthSelect=this.select("monthSelector")[0],this.daySelect=this.select("daySelector")[0],this.yearSelect=this.select("yearSelector")[0],this.on(document,"uiNeedsAgeGateDialog",this.setUpDialog),this.on("click",{submitButtonSelector:this.submitAgeGating}),this.on("change",{monthSelector:this.updateDays,yearSelector:this.updateDays,daySelector:this.hideRequired})})}var n=i(10),o=i(60),_=i(22),a=i(25),r=i(52),c=n(s,o);t.exports=c},,,,,,,,function(t,e,i){function s(){this.defaultAttrs({authWebViewDialogIframeSelector:".auth-webview-card-iframe",authWebViewDialogTitleSelector:".modal-title",authWebViewActionSelector:".AuthWebViewCard-authWebViewAction",authWebViewCardCtaClass:"AuthWebViewCard-button",authWebViewCardImageClass:"AuthWebViewCard-productImageWrapper",authWebViewTweetSelector:".tweet",commerceCardSelector:".AuthWebViewCard",top:47}),this.openAuthWebViewDialog=function(t,e){if(this.attr.loggedIn){var i=e.webviewUrl;e.tweetId&&(i=this.appendQueryParam(i,"referringTweetId",e.tweetId)),e.impressionId&&(i=this.appendQueryParam(i,"impressionId",e.impressionId)),this.select("authWebViewDialogIframeSelector").attr("src",i),this.select("authWebViewDialogTitleSelector").html(e.webviewTitle),this.open()}else this.trigger(document,"uiOpenSignupDialog")},this.appendQueryParam=function(t,e,i){var s=document.createElement("a");s.href=t;var n=encodeURIComponent(e)+"="+encodeURIComponent(i);""===s.search?s.search=n:s.search+="&"+n;var o=s.href;return s=null,o},this.closeDialog=function(t,e){this.select("authWebViewDialogIframeSelector").attr("src","about:blank"),this.off(window,"message",this.adjustIframeHeight),this.off(window,"message",this.proxyIframeEvents)},this.adjustIframeHeight=function(t){this.fitIframeHeight(t,{iframeSelector:this.attr.authWebViewDialogIframeSelector,isQualified:function(t){return t.name&&"auth_webview"===t.name&&t.height}})},this.setActiveViewSelector=function(t,e){this.activeViewSelector=e.selector||""},this.setupMessageListener=function(){this.on(window,"message",this.adjustIframeHeight),this.on(window,"message",this.proxyIframeEvents)},this.after("initialize",function(){this.activeViewSelector="",this.on("uiDialogOpened",this.setupMessageListener),this.on("uiDialogClosed",this.closeDialog),this.on(window,"uiOpenAuthWebViewDialog",this.openAuthWebViewDialog),this.on(document,"uiCommerceSetActiveViewSelector",this.setActiveViewSelector)})}var n=i(10),o=i(60),a=i(68),r=i(69),c=i(71),h=i(37),l=n(s,o,a,r,c,h);t.exports=l},,function(t,e,i){(function(e){function s(){this.fitIframeHeight=function(t,i){if(t&&i){var s=i.iframeSelector||this.attr.iframeSelector,o={};if(t.originalEvent&&(t=t.originalEvent),n(t.origin,window.location)&&"string"==typeof t.data&&e.isFunction(i.isQualified))try{o=JSON.parse(t.data),o&&i.isQualified(o)&&(this.$node.find(s).css("height",o.height+"px"),e.isFunction(i.additonalTreatment)&&i.additonalTreatment(this.$node.find(s)))}catch(a){}}}}var n=i(70);t.exports=s}).call(e,i(1))},function(t,e){var i=["twitter.com","donate.twitter.com"],s=function(t,e){return[t,e].join("//")};t.exports=function(t,e){return i.reduce(function(i,n){return i||t===s(e.protocol,n)},t===s(e.protocol,e.host))}},function(t,e,i){function s(){this.proxyIframeEvents=function(t){if(t){var e={};if(t.originalEvent&&(t=t.originalEvent),n(t.origin,window.location)&&"string"==typeof t.data)try{e=JSON.parse(t.data),e&&e.name&&"b2c"===e.name&&e.eventName&&this.trigger(e.eventName,e.data)}catch(i){}}}}var n=i(70);t.exports=s},function(t,e,i){(function(e){function s(){this.viewportHelpers=o,this.defaultAttrs({autoplayableContainerSelector:".has-autoplayable-media",mediaSelector:".animated-gif, .PlayableMedia, .js-macaw-cards-iframe-container",autoplayingMediaDataAttr:"data-autoplaying-media",scrollThrottle:100,watchDocumentScroll:!0,autoplayOnFractionInViewport:.25}),this.watchContainers=function(){this.$containers=this.select("autoplayableContainerSelector"),this.throttledProcessWatchedContainers()},this.stopAutoplaying=function(){this.$currentlyAutoplayingContainer&&(this.$currentlyAutoplayingContainer.attr(this.attr.autoplayingMediaDataAttr,!1),this.$currentlyAutoplayingMedia.trigger("uiStopAutoplayingMedia"),this.$currentlyAutoplayingContainer=void 0,this.$currentlyAutoplayingMedia=void 0)},this.processWatchedContainers=function(){if(0!==this.$containers.length&&this.$viewport){var t=this.viewportHelpers.getGlobalNavHeight(),e=this.viewportHelpers.getElementClosestToMiddleOfViewport({$container:this.$viewport,$elements:this.$containers,topThreshold:t,fractionInViewport:this.attr.autoplayOnFractionInViewport});e&&!e.is(this.$currentlyAutoplayingContainer)&&(this.stopAutoplaying(),e.attr(this.attr.autoplayingMediaDataAttr,!0),this.$currentlyAutoplayingContainer=e,this.$currentlyAutoplayingMedia=e.find(this.attr.mediaSelector),this.$currentlyAutoplayingMedia.trigger("uiAutoplayMedia")),this.$currentlyAutoplayingContainer&&!this.viewportHelpers.isPartiallyContainedInViewport({$container:this.$viewport,$element:this.$currentlyAutoplayingContainer,topThreshold:t,fractionInViewport:this.attr.autoplayOnFractionInViewport})&&this.stopAutoplaying()}},this.resetWatchedContainers=function(){this.$containers=e(),this.stopAutoplaying(),this.watchContainers()},this.cleanup=function(){this.off(document,"uiPageChanged"),this.off(this.$viewport,"resize"),this.$viewport=void 0,this.attr.watchDocumentScroll?this.off(document,"scroll",this.throttledProcessWatchedContainers):this.off("scroll",this.throttledProcessWatchedContainers)},this.before("teardown",function(){this.cleanup()}),this.after("initialize",function(){this.$currentlyAutoplayingContainer=void 0,this.$currentlyAutoplayingMedia=void 0,this.$viewport=e(window),this.$containers=e(),this.throttledProcessWatchedContainers=a.throttle(this.processWatchedContainers.bind(this),this.attr.scrollThrottle),this.on(document,"uiPageChanged",this.resetWatchedContainers),this.attr.watchDocumentScroll?this.on(document,"scroll",this.throttledProcessWatchedContainers):this.on("scroll",this.throttledProcessWatchedContainers),this.on(this.$viewport,"resize",this.throttledProcessWatchedContainers),this.on(document,"uiDynamicCardLoaded uiDynamicCardUnloaded",this.throttledProcessWatchedContainers),this.on(document,"uiWatchAutoplayMedia uiSwiftLoaded",this.watchContainers),this.on(document,"uiPageHidden",this.stopAutoplaying),this.on(document,"uiPageVisible",this.processWatchedContainers)})}var n=i(10),o=i(73),a=i(25);t.exports=n(s)}).call(e,i(1))},,,function(t,e,i){function s(){this.defaultAttrs({blockUserLabelSelector:".block-user-label",blockUserTextSelector:".block-user-text",blockButtonSelector:".block-button",blockInputSelector:"input[name=block_user]"}),this.setUpDialog=function(t,e){this.eventData=e,this.setTriggeredTarget(),this.setScreenNameText(),this.isComplete=!1,this.open()},this.setTriggeredTarget=function(){"user"===this.eventData.target?this.$node.addClass("block-from-user"):this.$node.removeClass("block-from-user")},this.setScreenNameText=function(){var t=this.select("blockUserLabelSelector");t.text(_("¿Bloquear a @{{screenName}}?",this.eventData)),this.select("blockUserTextSelector").text(_("@{{screenName}} ya no podrá seguirte ni enviarte mensajes y tú no verás notificaciones de @{{screenName}}.",this.eventData))},this.submitBlock=function(){this.trigger("uiBlockAction",{eventData:this.eventData,tweetId:this.eventData.tweetId,userId:this.eventData.userId,screenName:this.eventData.screenName,impressionId:this.eventData.impressionId,disclosureType:this.eventData.disclosureType,scribeContext:{component:"block_dialog",element:"user"===this.eventData.target?"user":"tweet"}}),this.trigger("uiDidTriggerBlockingAction",{userId:this.eventData.userId}),this.isComplete=!0,this.close()},this.around("close",function(t){this.isOpen()&&!this.isComplete&&this.trigger("uiBlockDialogCancel",this.eventData),t()}),this.after("initialize",function(){this.on(document,"uiNeedsBlockDialog",this.setUpDialog),this.on("click",{blockButtonSelector:this.submitBlock})})}var n=i(10),_=i(22),o=i(60),a=n(o,s);t.exports=a},function(t,e,i){function s(){this.defaults={cancelSelector:".cancel-action",blockSelector:".block-action"},this.openBlockUser=function(t,e){var i={userOnly:!0,modal:"block"};this.attr.sourceEventData=e,this.displayTweet(e.tweetId,i),this.open()},this.blockUser=function(){this.trigger("uiDidBlockUser",{sourceEventData:this.attr.sourceEventData}),this.close()},this.after("initialize",function(){this.on("click",{cancelSelector:this.close,blockSelector:this.blockUser}),this.on(document,"uiOpenBlockUserDialog",this.openBlockUser)})}var n=i(10),o=i(60),a=i(77);t.exports=n(s,o,a)},,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){function s(){this.defaultAttrs({safeOrigins:["https://localhost.twitter.com","https://twitter.com"],iframeSelector:"#bouncer-flow",contentSelector:".BouncerContent",spinnerSelector:".BouncerSpinner",dismissButtonSelector:".js-close"}),this.openBouncerDialog=function(t,e){this.select("iframeSelector").attr("src",e.bounce.bounce_location||"/account/access"),this.open()},this.onBeforeIframeUnload=function(){this.setIframeLoading(!0),this.position()},this.onIframeLoad=function(){this.setIframeLoading(!1),this.position()},this.setIframeLoading=function(t){if(t)this.$bouncerContent.hide(),this.$dismissButton.hide(),this.$spinner.show(),this.$bouncerContent.height(this.$spinner.height()),this.$iframe.height(this.$spinner.height());else{this.$spinner.hide(),this.$dismissButton.show(),this.$bouncerContent.show();var e=this.$iframe.contents().find("body").height()+20;e>this.$iframe.height()&&(this.$bouncerContent.height(e),this.$iframe.height(e))}},this.onCancel=function(){this.trigger("uiBouncerCancelled"),this.close()},this.onComplete=function(){this.trigger("uiBouncerCompleted"),this.close()},this.on2FAComplete=function(){this.trigger("uiBouncer2FACompleted"),this.close()},this.aroundAfterClose=function(t){t(),this.reset()},this.reset=function(){this.setIframeLoading(!0)},this.dispatchBouncerMessage=function(t,e){var i=t.originalEvent,s=i&&i.data;if(this.attr.safeOrigins.indexOf(i.origin)!==-1&&s&&s.bouncer&&s.event){var n=s.event;"beforeunload"===n?this.onBeforeIframeUnload():"load"===n?this.onIframeLoad():"cancel"===n?this.onCancel():"complete"===n?this.onComplete():"2fa_complete"===n&&this.on2FAComplete()}},this.after("initialize",function(){this.on(document,"dataRequestBounced",this.openBouncerDialog),this.on(document,"uiPreOpenBouncerDialog",this.open),this.on("uiDialogClosed",this.onCancel),this.on(window,"message",this.dispatchBouncerMessage),this.around("afterClose",this.aroundAfterClose),this.$modalContent=this.select("modalContentSelector"),this.$iframe=this.select("iframeSelector"),this.$bouncerContent=this.select("contentSelector"),this.$spinner=this.select("spinnerSelector"),this.$dismissButton=this.select("dismissButtonSelector"),this.reset()})}var n=i(10),o=i(60),a=n(s,o);t.exports=a},function(t,e,i){(function(e){function s(){this.defaultAttrs({buyNowDialogIframeSelector:".buy-now-card-iframe",buyNowActionSelector:".BuyNowCard-buyNowAction",buyNowCardCtaClass:"BuyNowCard-button",buyNowCardImageClass:"BuyNowCard-productImageWrapper",buyNowTweetSelector:".tweet",commerceCardSelector:".BuyNowCard",top:47,defaultHeight:"400px",productDetailViewSelector:".BuyNow-productDetailView",paymentInfoViewSelector:".BuyNow-paymentInfoView"}),this.openDialog=function(t,i){if(!this.attr.loggedIn)return void this.trigger(document,"uiOpenSignupDialog");if(i&&i.el){var s=e(i.el).closest(this.attr.buyNowTweetSelector),n=s.data("tweet-id"),a="/i/pay/status/"+n;this.promotedMetadata=this.extractPromotedMetadata(s),this.scribingData=this.getCardDataFromContainer(s),this.trigger("uiBuyNowCardClicked",o.merge(this.scribingData,this.promotedMetadata,{action:e(i.el).data("action")})),this.select("buyNowDialogIframeSelector").attr("src",a),this.open()}},this.openBuyNowDialogFromId=function(t,e){var i=e.buyNowTweetId;if(!this.attr.loggedIn)return void this.trigger(document,"uiOpenSignupDialog");this.promotedMetadata={impressionId:e.impressionId,disclosureType:e.disclosureType};var s="/i/pay/status/"+i;this.select("buyNowDialogIframeSelector").attr("src",s),this.open()},this.closeDialog=function(t,e){this.activeViewSelector===this.attr.paymentInfoViewSelector?this.trigger("uiCommerceFlowAborted",{component:"store_profile",scribingData:this.scribingData}):this.purchaseSuccess||this.trigger("uiCommerceFlowAborted",{component:"product_detail",scribingData:this.scribingData}),this.purchaseSuccess=!1,this.select("buyNowDialogIframeSelector").attr("src","about:blank"),this.select("buyNowDialogIframeSelector").css("height",this.attr.defaultHeight),this.off(window,"message",this.adjustIframeHeight)},this.adjustIframeHeight=function(t){var e={iframeSelector:this.attr.buyNowDialogIframeSelector,isQualified:function(t){return t.name&&"buy_now"===t.name&&t.height}};this.fitIframeHeight(t,e)},this.showSuccessMessage=function(t,e){this.purchaseSuccess=!0,this.trigger("uiCloseDialog"),this.trigger("uiShowMessage",{message:e.message}),this.trigger("uiCommerceBuyNowSuccess",this.promotedMetadata)},this.setActiveViewSelector=function(t,e){this.activeViewSelector=e.selector||""},this.extractPromotedMetadata=function(t){return{impressionId:t.data("impression-id"),disclosureType:t.data("disclosure-type")}},this.setupMessageListener=function(){this.on(window,"message",this.adjustIframeHeight)},this.after("initialize",function(){this.purchaseSuccess=!1,this.activeViewSelector="",this.on("uiDialogOpened",this.setupMessageListener),this.on("uiDialogClosed",this.closeDialog),this.on(window,"MacawCardOpenBuyNowDialog",this.openBuyNowDialogFromId),this.on(document,"uiCommerceShowSuccessMessage",this.showSuccessMessage),this.on(document,"uiCommerceSetActiveViewSelector",this.setActiveViewSelector),this.on(document,"click",{buyNowActionSelector:this.openDialog})})}var n=i(10),o=i(25),a=i(60),r=i(68),c=i(69),h=i(37),l=n(s,a,r,c,h);t.exports=l}).call(e,i(1))},function(t,e,i){function s(){this.convertCardDataToScribeData=function(t){return t&&{items:[this.getCard2Item(t)]}},this.scribeFlowAborted=function(t,e){this.scribe({page:"buy_now",component:e.component,action:"exit"},this.convertCardDataToScribeData(e.scribingData))},this.scribeBuyNowCardCtaClicked=function(t,e){var i=this.convertCardDataToScribeData(e);this.scribe({action:e.action},i)},this.after("initialize",function(){this.on("uiCommerceFlowAborted",this.scribeFlowAborted),this.on("uiBuyNowCardClicked",this.scribeBuyNowCardCtaClicked)})}var n=i(10),o=i(40),a=i(37);t.exports=n(s,o,a)},function(t,e,i){function s(){this.defaultAttrs({challengeSelector:"#recaptcha_challenge_field",responseSelector:"#recaptcha_response_field",submitSelector:"#recaptcha_submit",captchaName:"Captcha",bodyTextSelector:".modal-text",captchaFormSelector:"#captcha-challenge-form",recaptchaPublicKey:"6LfbTAAAAAAAAE0hk8Vnfd1THHnn9lJuow6fgulO"}),this.refreshCaptchaDialog=function(t,e){this.reloadCaptcha(),this.open()},this.reloadCaptcha=function(){window.Recaptcha&&window.Recaptcha.reload()},this.submitCaptcha=function(){var t=this.select("challengeSelector").val(),e=this.select("responseSelector").val();this.trigger("uiSubmitSpamChallenge",{challenge:t,response:e,challengeName:this.attr.captchaName})},this.getRecaptcha=function(t,e){this.isRecaptchaDefined()&&window.Recaptcha.create(this.attr.recaptchaPublicKey,"captcha-challenge-form",{theme:"clean",callback:function(){window.Recaptcha.focus_response_field(),t&&e.select("bodyTextSelector").text(t),e.open()}})},this.isRecaptchaDefined=function(){return"undefined"!=typeof window.Recaptcha},this.openCaptchaDialog=function(t,e){this.getRecaptcha(e.message,this)},this.after("initialize",function(){this.on("click",{submitSelector:this.submitCaptcha}),this.on(document,"uiOpenSpamCaptchaChallenge",this.openCaptchaDialog),this.on(document,"uiCloseSpamCaptchaChallenge",this.blurAndCloseImmediately),this.on(document,"uiRefreshSpamCaptchaChallenge",this.refreshCaptchaDialog)})}var n=i(10),o=i(60);t.exports=n(s,o)},function(t,e,i){(function(e){function s(){this.defaultAttrs({confirmDialogSelector:"#confirm_dialog",cancelSelector:"#confirm_dialog_cancel_button",submitSelector:"#confirm_dialog_submit_button",modalSizes:{small:"modal-small",medium:"modal-medium",large:"modal-large"}}),this.openWithOptions=function(t,i){if(!this.openState){this.attr.eventParams={action:i.action},this.attr.top=i.top,this.eventNode=t.target;var s={title_text:i.titleText,body_text:i.bodyText,cancel_text:i.cancelText,submit_text:i.submitText},n=r["dialogs/confirm_dialog"].render(s,r);e("#confirm_dialog").length?e("#confirm_dialog").replaceWith(n):e("body").append(n),this.$dialogContainer=e("#confirm_dialog"),this.$dialog=this.$dialogContainer.find(this.attr.modalSelector);var o=this.attr.modalSizes[i.modalSize];"undefined"!=typeof o&&this.$dialog.addClass(o),this.open()}},this.submit=function(t,e){this.trigger(this.eventNode,"ui{{action}}Confirm"),this.close()},this.cancel=function(t,e){this.trigger(this.eventNode,"ui{{action}}Cancel"),"click"===t.type&&this.close()},this.after("initialize",function(){this.on(document,"uiOpenConfirmDialog",this.openWithOptions),this.on("click",{submitSelector:this.submit,cancelSelector:this.cancel}),this.on("uiDialogCloseRequested",{confirmDialogSelector:this.cancel})})}var n=i(10),o=i(60),a=i(106),r=i(107);t.exports=n(s,o,a)}).call(e,i(1))},function(t,e,i){function s(){this.rewriteEventName=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var s="string"==typeof e[0]||e[0].defaultBehavior?0:1,o=e[s],a=o.type||o;e[s]=n(a,this.attr.eventParams,!0),o.type&&(o.type=e[s],e[s]=o),t.apply(this,e)},this.around("on",this.rewriteEventName),this.around("off",this.rewriteEventName),this.around("trigger",this.rewriteEventName)}var n=i(23);t.exports=s},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){function s(){this.defaultAttrs({keepBadgeStorageKey:"keep_badge_until",keepBadgeInterval:1e3}),this.processNewNotifications=function(t,e){e&&e.b&&"ok"===e.b.status&&e.b.response&&this.possiblyUpdateBadgeAndHighlighting(e.b.response)},this.possiblyUpdateBadgeAndHighlighting=function(t){t.show_badge_highlighting&&t.count>=0&&(this.trigger("uiUpdateConnectBadge",t),t.timestamp>=0&&(t.count>0||this.pastStorageTime())&&this.trigger("uiUpdateActivityHighlighting",t.timestamp),this.updateStorageTime())},this.pastStorageTime=function(){var t=(new Date).getTime(),e=this.storage.getItem(this.attr.keepBadgeStorageKey)||{until:0};return e.until<t},this.updateStorageTime=function(){var t=(new Date).getTime();this.storage.setItem(this.attr.keepBadgeStorageKey,{until:t+this.attr.keepBadgeInterval})},this.after("initialize",function(){this.storage=new o("connect_badge"),this.updateStorageTime(0),this.on(document,"dataNotificationsReceived",this.processNewNotifications)})}var n=i(10),o=i(96);t.exports=n(s)},function(t,e,i){(function(e){function s(){this.defaultAttrs({copyFoundMediaLinkDialogSelector:"#copy-found-media-link-dialog",foundMediaLinkDestinationSelector:".found-media-link-destination"}),this.openDialog=function(t,i){var s=o.get(i.fileId);if(s){e(this.attr.copyFoundMediaLinkDialogSelector).remove();var n={attribution_name:s.attribution.name,details_url:s.detailsUrl},r=a["dialogs/copy_found_media_link"].render(n,a);this.$dialogContainer=e(r).appendTo("body"),this.$dialog=this.$dialogContainer.find(this.attr.modalSelector),this.open(),this.selectLink()}},this.after("afterClose",function(){this.$dialogContainer.remove(),this.$dialog=e(),this.$dialogContainer=e()}),this.selectLink=function(){this.select("foundMediaLinkDestinationSelector").focus().select()},this.after("initialize",function(){this.on("click",{foundMediaLinkDestinationSelector:this.selectLink}),this.on(document,"uiNeedsCopyFoundMediaDialog",this.openDialog)})}var n=i(10),o=i(209),a=i(107),r=i(60),c=n(r,s);t.exports=c}).call(e,i(1))},,function(t,e,i){function s(){this.defaultAttrs({createOrUpdateEventName:"uiCreateCustomTimeline",orderSelector:"[name=create-timeline-order]:checked"}),this.around("params",function(t){var e=t();return e.tweetId=this.tweetId,e.impressionId=this.impressionId,e}),this.openDialog=function(t,e){this.tweetId=e.tweetId,this.impressionId=e.impressionId;var i={is_create_dialog:!0,id_prefix:"create",curation_reverse_chron:!0},s=c["dialogs/create_or_edit_custom_timeline_dialog"].render(i,c);this.$node.html(s),this.$dialog=this.$dialogContainer.find(this.attr.modalSelector),this.open()},this.after("open",function(){o.attachTo(".custom-timeline-name-field",{maxLength:25,superwarnLength:20,warnLength:15,textSelector:"#custom-timeline-name",counterSelector:".custom-timeline-name-count"}),o.attachTo(".custom-timeline-description-field",{maxLength:160,superwarnLength:150,warnLength:140,textSelector:"#custom-timeline-description",counterSelector:".custom-timeline-description-count"})}),this.after("initialize",function(){this.on(document,"uiOpenCreateCustomTimelineDialog",this.openDialog)})}var n=i(10),o=i(211),a=i(60),r=i(219),c=i(107);t.exports=n(a,r,s)},function(t,e,i){function s(){this.after("initialize",function(){this.initTextNode()})}var n=i(10),o=i(212),a=i(217),r=n(s,o,a);t.exports=r},,,,,,,,function(t,e){t.exports=function(){var t=/^\s*$/;this.defaultAttrs({top:90,saveSelector:".update-custom-timeline-button",nameSelector:"[name=name]",descriptionSelector:"[name=custom-timeline-description]",dialogTitleSelector:".modal-title",maxReachedSelector:".max-reached"}),this.params=function(){return{name:this.$name.val(),description:this.$description.val(),order:this.select("orderSelector").val()}},this.saveCustomTimeline=function(t,e){this.disableSaveButton(),this.trigger(this.attr.createOrUpdateEventName,this.params())},this.disableSaveButton=function(){this.$saveButton.attr("disabled",!0)},this.toggleSaveButton=function(e,i){var s=t.test(this.$name.val()),n=this.select("maxReachedSelector").length>0;this.$saveButton.attr("disabled",s||n)},this.after("open",function(){this.$saveButton=this.select("saveSelector"),this.$name=this.select("nameSelector"),this.$description=this.select("descriptionSelector"),this.toggleSaveButton()}),this.after("initialize",function(){this.on(document,"dataCustomTimelineUpdated",this.close),this.on("click",{saveSelector:this.saveCustomTimeline}),this.on("input",{nameSelector:this.toggleSaveButton}),this.on("uiTextChanged",this.toggleSaveButton)})}},function(t,e,i){(function(e){function s(){this.defaultAttrs({top:90,closeOnOtherDialogOpened:!0,timelineSelectorSelector:".timeline-selector",wasMemberSelector:".timeline-item .was-member",wasNotMemberSelector:".timeline-item .was-not-member",submitSelector:".js-submit"}),this.openDialog=function(t,e){var i=c["dialogs/curate_dialog"].render({},c);this.$node.html(i),this.$dialog=this.$dialogContainer.find(this.attr.modalSelector),this.tweetId=e.tweetId,this.impressionId=e.impressionId,this.trigger("uiNeedsFullCustomTimelines",{tweetId:e.tweetId}),this.scribe({component:"curate_dialog",action:"open"},e),this.open()},this.renderFullTimelinesList=function(t,e){this.select("timelineSelectorSelector").html(e.html)},this.submitChanges=function(){function t(t){return t.map(function(){return e(this).attr("data-timeline-id")}).get()}this.select("submitSelector").attr("disabled",!0);var i=this.select("wasMemberSelector").filter(":not(:checked)"),s=this.select("wasNotMemberSelector").filter(":checked"),n={removed:t(i),added:t(s),tweetId:this.tweetId,impressionId:this.impressionId};this.trigger("uiCurateTweets",n)},this.after("initialize",function(){this.on(document,"uiOpenCurateDialog",this.openDialog),this.on(document,"dataGotFullCustomTimelines",this.renderFullTimelinesList),this.on(document,"dataTweetsCurated",this.close),
this.on("click",{submitSelector:this.submitChanges})})}var n=i(10),o=i(60),a=i(221),r=i(40),c=i(107);t.exports=n(o,s,a,r)}).call(e,i(1))},function(t,e){t.exports=function(){this.defaultAttrs({createCustomTimelineSelector:".js-create-custom-timeline-button"}),this.openCreateDialog=function(){this.trigger("uiOpenCreateCustomTimelineDialog",{tweetId:this.tweetId,impressionId:this.impressionId})},this.after("initialize",function(){this.on("click",{createCustomTimelineSelector:this.openCreateDialog})})}},function(t,e,i){(function(e){function s(){this.defaultAttrs({cancelSelector:".cancel-action",deleteSelector:".delete-action"}),this.openDeleteTweet=function(t,e){this.attr.sourceEventData=e,this.displayTweet(e.tweetId,{modal:"delete"}),this.id=e.id,this.open()},this.deleteTweet=function(){this.trigger("uiDidDeleteTweet",{id:this.id,sourceEventData:this.attr.sourceEventData})},this.deleteTweetSuccess=function(t,e){this.trigger("uiDidDeleteTweetSuccess",this.attr.sourceEventData),this.close()},this.restoreFocusToTweet=function(t){e(t.target).is(this.$dialog)&&this.activeEl&&this.trigger(e(this.activeEl).closest(".tweet"),"uiShouldAddFocusStyle")},this.after("initialize",function(){this.on("click",{cancelSelector:this.close,deleteSelector:this.deleteTweet}),this.on(document,"uiOpenDeleteDialog",this.openDeleteTweet),this.on(document,"dataDidDeleteTweet",this.deleteTweetSuccess),this.on(document,"uiDialogRestorePreviousFocus",this.restoreFocusToTweet),this.on(document,"uiCloseDeleteTweetDialog",this.close)})}var n=i(10),o=i(60),a=i(77),r=n(s,o,a);t.exports=r}).call(e,i(1))},function(t,e,i){(function(e){function s(t){var e="#dm_dialog";F.attachTo(document,t),A.attachTo(document),E.attachTo(e,t,{timestampSelector:".time"}),R.attachTo(document,t),N.attachTo(".dm-media-container"),U.attachTo(document),O.attachTo(document),n.attachTo(document),h.attachTo(document),T.attachTo(document),D.attachTo(document),I.get("welcome_message_add_to_conversation_enabled")&&l.attachTo(document),I.get("live_pipeline_subscribe")&&m.attachTo(document,{darkTraffic:!I.get("typing_indicators_ui")}),y.attachTo(".DMInbox",{notifications:I.get("notifications"),usePushNotifications:I.get("usePushForNotifications")}),a.attachTo(".DMCompose",{maxParticipants:I.get("participant_max")||t.dm_participant_max||50,currentUserId:t.userId}),c.attachTo(e),I.get("notifications")&&M.attachTo(document,{conversationSelector:".DMConversation-content"}),d.attachTo(document),p.attachTo(document),S.attachTo(document),b.attachTo(document),C.attachTo(document),u.attachTo(document),g.attachTo(document),v.attachTo(document),w.attachTo(document),f.attachTo(document),I.get("typing_indicators_publish")&&r.attachTo(document),k.attachTo(document),P.attachTo(document),I.get("twitter_video_player")||x.attachTo(document);var i=t.dm_options||{};L.attachTo(document,{open:i.show_dm_dialog,text:i.default_composer_text,welcomeMessageId:i.welcome_message_id,conversation:{id:i.conversation_id},compose:{id:i.recipient_id,screenName:i.recipient,name:i.recipient_name,avatar:i.recipient_avatar}}),$.attachTo(document),B.attachTo(document),I.get("card_prefetch")&&o.attachTo(".DMComposer",{cardPrefetchInterval:I.get("card_prefetch_interval_in_seconds")})}var n=i(224),o=i(238),a=i(240),r=i(247),c=i(248),h=i(360),l=i(361),d=i(362),u=i(364),m=i(365),p=i(366),g=i(367),f=i(368),v=i(376),S=i(377),w=i(378),b=i(379),C=i(380),y=i(381),T=i(383),D=i(384),I=i(323),k=i(385),M=i(386),x=i(387),P=i(388),A=i(389),E=i(390),R=i(399),N=i(400),F=i(402),O=i(403),L=i(404),U=i(405),$=i(406),B=i(407),V=!!e("#dm_dialog").length;t.exports=V?s:e.noop}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({noShowError:!0}),this.addParticipants=function(t,e){e=e||{},this.post({url:"/i/direct_messages/add_participants",data:{id:e.conversation_id,participant_ids:e.participant_ids},eventData:e,success:r(t.target,"dataDMConversationResult"),error:r(t.target,"dataDMError")})},this.after("initialize",function(){this.on("uiAddConversationParticipants",this.addParticipants)})}var n=i(10),o=i(225),a=i(237),r=a.triggerFn;t.exports=n(s,o)},,,,,,,,,,,,,function(t,e,i){(function(e){t.exports={triggerFn:function(t,i,s){return i=Array.isArray(i)?i:[i],function(n){i.forEach(function(i){var o=e.isFunction(i)?i(n):i,a=e.isFunction(s)?s(n):s;o&&e(t).trigger(o,a||n)})}},chain:function(){var t=Array.prototype.slice.call(arguments);return function(){var i=Array.prototype.slice.call(arguments);for(var s in t)e.isFunction(t[s])&&t[s].apply(t[s],i)}}}}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({basePrefetchEndpointUrl:"/i/cards/preview/v1",cardPrefetchInterval:1e4,prefetchOnLeadingEdge:!0}),this.filterCachedUri=function(t){return!this.prefetchedUri[t]},this.prefetchCardWithUri=function(t){this.prefetchedUri[t]=!0,this.get({url:this.attr.basePrefetchEndpointUrl,data:{card_uri:t}})},this.setCardUriParam=function(t,e){var i=e&&e.urls;Array.isArray(i)&&(1===i.length?this.trigger("uiSetDmCreateCardUriParam",{cardUri:i[0]}):this.trigger("uiResetDmCreateCardUriParam"))},this.prefetchCard=function(t,e){var i=e&&e.urls;Array.isArray(i)&&1===i.length&&i.filter(this.filterCachedUri,this).forEach(this.prefetchCardWithUri,this)},this.after("initialize",function(){this.prefetchedUri={},this.on("uiGotUrlInText",this.setCardUriParam),this.on("uiGotUrlInText",a(this.prefetchCard,this.attr.cardPrefetchInterval,this.attr.cardPrefetchInterval,this.attr.prefetchOnLeadingEdge))})}var n=i(10),o=i(225),a=i(239),r=n(s,o);t.exports=r},,function(t,e,i){function s(){this.attributes({nextButtonSelector:".dm-initiate-conversation",dmTypeaheadSelector:".DMDialogTypeahead",maxParticipants:50,currentUserId:null}),this.enable=function(){this.select("nextButtonSelector").removeClass("disabled").attr("disabled",!1)},this.disable=function(){this.select("nextButtonSelector").addClass("disabled").attr("disabled",!0)},this.isGroupSelected=function(t,e){return e&&e.groups&&e.groups.length},this.initiateConversationFromSelectedGroup=function(t,e){var i=e.groups[0];this.initiateConversation("uiRenderConversationView",{conversation_id:i.id,name:i.name})},this.isNextButtonSelected=function(t,e){return"click"===t.type||"keydown"===t.type&&t.which===r.ENTER},this.initiateConversationFromSelectedAccounts=function(){var t,e;switch(this.selectedAccounts.length){case 0:t="uiRenderNewConversationView",e={name:"@"+this.manualScreenName,screen_names:this.manualScreenName?[this.manualScreenName]:[]};break;case 1:var i=this.selectedAccounts[0];t="uiRenderConversationView",e={conversation_id:o.generateConversationId(this.attr.currentUserId,i.id),name:i.name,is_oto:!0};break;default:var s=this.selectedAccounts.map(function(t){return t.id});t="uiRenderNewConversationView",e={name:o.generateConversationName(this.selectedAccounts),recipient_ids:s}}this.initiateConversation(t,e)},this.reset=function(t,e){this.trigger("uiInitializeDMTypeahead"),this.defaultComposerText=e&&e.default_composer_text||"",this.hasTweetAttachment=e&&e.has_tweet_attachment||!1},this.storeSelectedAccounts=function(t,e){this.selectedAccounts=e.accounts||[]},this.handleTextChange=function(t,e){var i=(e.text||"").replace(/^@/,"");this.manualScreenName=c.isValidUsername("@"+i)?i:""},this.initiateConversation=function(t,e){this.trigger(t,h.merge(e,{default_composer_text:this.defaultComposerText,has_tweet_attachment:this.hasTweetAttachment,retain_tweet_attachment:!0})),this.reset()},this.updateState=function(t,e){var i=this.manualScreenName,s=this.selectedAccounts.length;i||s?this.enable():this.disable()},this.after("handleTextChange",this.updateState),this.after("storeSelectedAccounts",this.updateState),this.after("reset",this.updateState),this.after("initialize",function(){this.attachChild(l,this.$node,{maxItems:this.attr.maxParticipants-1}),this.selectedAccounts=[],this.on("uiDMTypeaheadSelectedItemsChanged",this.storeSelectedAccounts),this.on("uiDMTypeaheadSelectedItemsChanged",a(this.initiateConversationFromSelectedGroup,this.isGroupSelected)),this.on("uiTextChanged",this.handleTextChange),this.on("click keydown",{nextButtonSelector:a(this.initiateConversationFromSelectedAccounts,this.isNextButtonSelected)}),this.on(document,"uiOpenNewDM",this.reset)})}var n=i(10),o=i(241),a=i(243),r=i(244),c=i(218),h=i(25),l=i(245),d=i(215),u=n(s,d);t.exports=u},function(t,e,i){var _=i(22),s=i(242),n={generateConversationName:function(t){return 1===t.length?t[0].name:2===t.length?_("{{first}}, {{second}}",{first:t[0].name,second:t[1].name}):t.length>2?_("{{first}} + {{count}}",{first:t[0].name,count:t.length-1}):void 0},generateConversationId:function(t,e){if(t&&e){var i=[t,e];return(s.compare(i[0],i[1])<0?i:i.reverse()).join("-")}},sortRecipients:function(t){return(t||[]).sort(function(t,e){return s.compare(t.id,e.id)})}};t.exports=n},,,,function(t,e,i){(function(e){function s(){this.attributes({textSelector:"textarea.TokenizedMultiselect-input",selectedClass:"is-selected",suggestionClass:"DMTypeaheadSuggestion",suggestionSelector:".DMTypeaheadSuggestion",highlightedClass:"is-highlighted",highlightedSelector:".is-highlighted",suggestionsContainerSelector:".DMTypeaheadSuggestionsContainer",tokenIdDelimiter:"::",suggestionsTemplate:"dm/typeahead_suggestions",topAccountsLength:5,accountsDatasource:"dmAccounts",conversationsDatasource:"dmConversations",typeaheadSrc:"compose_message",preselectedItems:[],maxItems:50}),this.buildAccountTemplateData=function(t){var e=t.id_str,i=this.generateTokenId(this.attr.accountsDatasource,e),s=this.isItemSelected(i),n=this.isPreSelected(e),o=n?"":this.attr.suggestionClass,a=this.hasBusinessContext(t);return{data_token_id:i,data_token_text:t.name,suggestion_class:o,title:{text:t.name,screen_name:t.screen_name,verified:t.verified},avatar:{images:{src:t.profile_image_url_https,alt:t.name}},selected:s,preselected:n,is_group:!1,has_business_context:a}},this.buildGroupTemplateData=function(t){return{data_token_id:this.generateTokenId(this.attr.conversationsDatasource,t.id),data_token_text:t.emojified_title,suggestion_class:this.attr.suggestionClass,html:t.html,is_group:!0}},this.buildTemplateDataFromDMConversation=function(t){return t.is_group?this.buildGroupTemplateData(t):1===t.participants.length?this.buildAccountTemplateData(t.participants[0]):void 0},this.processEmptyQuerySuggestions=function(t){var e=t.suggestions.dmConversations||[],i=e.map(this.buildTemplateDataFromDMConversation.bind(this)),s=a["dm/typeahead_initial_suggestions"].render({suggestions:i,has_suggestions:Boolean(i.length)},a);this.trigger("uiTokenizedMultiselectSuggestions",{html:s,preserve_previous_hightlight:!1})},this.processNonEmptyQuerySuggestions=function(t){var e=(t.suggestions.dmAccounts||[]).map(this.buildAccountTemplateData.bind(this)),i=(t.suggestions.dmConversations||[]).map(this.buildGroupTemplateData.bind(this)),s=i.length?e.slice(0,this.attr.topAccountsLength):e,n=a[this.attr.suggestionsTemplate].render({accounts:s,groups:i,has_accounts:s.length,has_groups:i.length},a);this.trigger("uiTokenizedMultiselectSuggestions",{html:n,preserve_previous_hightlight:!0})},this.processSuggestions=function(t,e){var i=e.queryData&&e.queryData.query;e.suggestions&&this.currentQuery===i&&(""===i?this.processEmptyQuerySuggestions(e):this.processNonEmptyQuerySuggestions(e))},this.requestEmptyQuerySuggestions=function(){var t=this.attr.preselectedItems||[],e={id:this.typeaheadId,queryData:{query:"",dmConversationsOptions:{excludeGroups:this.selectedItems.length||t.length,sortBySortId:!0,excludeOneToOnes:!1}},datasources:[this.attr.conversationsDatasource]};this.trigger("uiNeedsTypeaheadSuggestions",e)},this.requestSuggestions=function(t,e){if(this.currentQuery=e.text,""===this.currentQuery)return void this.requestEmptyQuerySuggestions();var i=this.attr.preselectedItems||[],s=this.selectedItems.length||i.length,n=s?[this.attr.accountsDatasource]:[this.attr.accountsDatasource,this.attr.conversationsDatasource],o={id:this.typeaheadId,queryData:{query:e.text,typeaheadSrc:this.attr.typeaheadSrc,dmConversationsOptions:{excludeGroups:s,sortBySortId:!1,excludeOneToOnes:!s}},datasources:n};this.trigger("uiNeedsTypeaheadSuggestions",o)},this.splitTokenId=function(t){var e=t.split(this.attr.tokenIdDelimiter);return{datasource:e[0],id:e[1]}},this.handleItemSelected=function(t,e){this.selectedItems=e.selected_items||[];var i=this.selectedItems.map(function(t){var e=this.splitTokenId(t.id);return{datasource:e.datasource,id:e.id,text:t.text}},this),s=i.filter(function(t){return t.datasource===this.attr.accountsDatasource},this).map(function(t){return{id:t.id,name:t.text}}),n=i.filter(function(t){return t.datasource===this.attr.conversationsDatasource},this).map(function(t){return{id:t.id,name:t.text}});this.trigger("uiDMTypeaheadSelectedItemsChanged",{accounts:s,groups:n})},this.generateTokenId=function(t,e){return t+this.attr.tokenIdDelimiter+e},this.isItemSelected=function(t){var i=this.selectedItems.map(function(t){return t.id});return e.inArray(t+"",i||[])>=0},this.isPreSelected=function(t){return e.inArray(t+"",this.attr.preselectedItems||[])>=0},this.hasBusinessContext=function(t){return"enabled"===t.customer_service_state},this.resetAndInitialize=function(t,e){this.select("suggestionsContainerSelector").empty(),this.trigger("uiResetTokenizedMultiselect"),this.attr.preselectedItems=e&&e.preselectedItems&&e.preselectedItems.length?e.preselectedItems:[],e&&e.maxItems&&(this.attr.maxItems=e.maxItems,this.trigger("uiTokenizedMultiSelectMaxItems",{maxItems:e.maxItems})),this.selectedItems=[],this.requestEmptyQuerySuggestions(),this.currentQuery=""},this.after("handleItemSelected",this.requestEmptyQuerySuggestions),this.handleTokenChangeAccessibility=function(t,e){var i=this.splitTokenId(e.id);if(i.datasource===this.attr.accountsDatasource){var s="uiTokenizedMultiselectTokenAdded"===t.type?_("Se añadió a {{user}}",{user:e.text}):_("Se eliminó a {{user}}",{user:e.text});this.trigger("uiShouldSpeakMessage",{message:s})}},this.after("initialize",function(){this.typeaheadId="dm_typeahead"+Math.floor(1e6*Math.random()),this.attachChild(o,this.$node,this.attr),this.on("uiTokenizedMultiselectTokenAdded uiTokenizedMultiselectTokenRemoved",this.handleTokenChangeAccessibility),this.on("uiTokenizedMultiselectTextChanged",this.requestSuggestions),this.on(document,"dataTypeaheadSuggestionsResults",this.processSuggestions),this.on("uiTokenizedMultiselectItemSelectionChanged",this.handleItemSelected),this.on("uiInitializeDMTypeahead",this.resetAndInitialize),this.selectedItems=[],this.requestEmptyQuerySuggestions()})}var _=i(22),n=i(10),o=i(246),a=i(107),r=i(215),c=n(s,r);t.exports=c}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.keymap=r;var t=0,i=1;this.attributes({textSelector:"textarea.TokenizedMultiselect-input",inputContainerSelector:".TokenizedMultiselect-inputContainer",textMinWidth:100,tokenClass:"InputToken",tokenSelector:".InputToken",tokenTemplate:"dm/tokenized_multiselect_token",focusedTokenSelector:".InputToken:focus",tokenDeleteClass:"InputToken-delete",tokenDeleteSelector:".InputToken-delete",highlightedClass:"is-highlighted",highlightedSelector:".is-highlighted",selectedClass:"is-selected",suggestionClass:"TokenizedMultiselect-suggestion",suggestionSelector:".TokenizedMultiselect-suggestion",suggestionsContainerSelector:".TokenizedMultiselect-suggestionsContainer",maxItems:50}),this.handleKeyPress=function(e){if("keydown"===e.type&&!e.shiftKey){var s=e.which||e.keycode,n=this.select("focusedTokenSelector").length,o=this.select("highlightedSelector").length,a=!this.$text.val();switch(s){case r.TAB:n?(e.preventDefault(),e.stopPropagation(),this.focusInput()):o&&(e.preventDefault(),e.stopPropagation(),this.tokenizeHighlightedSuggestion());break;case r.ENTER:e.preventDefault(),this.toggleTokenization();break;case r.ESC:o&&(e.preventDefault(),e.stopPropagation(),this.clearHighlight());break;case r.BACKSPACE:n?(this.removeFocusedToken(),e.preventDefault()):a&&(this.removeLastToken(),e.preventDefault());break;case r.DELETE:n&&this.removeFocusedToken();break;case r.UP:e.preventDefault(),n&&this.focusInput(),this.moveSuggestionHighlight(i);break;case r.DOWN:e.preventDefault(),n&&this.focusInput(),this.moveSuggestionHighlight(t);break;case r.LEFT:n?this.focusNeighbor(i):a&&this.focusLastToken();break;case r.RIGHT:n&&this.focusNeighbor(t)}}},this.focusNeighbor=function(e){var i=e===t?"next":"prev",s=this.select("focusedTokenSelector");s.length&&s[i]().focus()},this.focusLastToken=function(){this.select("tokenSelector").last().focus()},this.focusInput=function(){this.$text.focus()},this.removeFocusedToken=function(e){var i=this.select("focusedTokenSelector");e&&"click"===e.type?this.focusInput():this.focusNeighbor(t),this.removeToken(i)},this.removeLastToken=function(){this.removeToken(this.select("tokenSelector").last())},this.removeToken=function(t){t.length&&(this.trigger("uiTokenizedMultiselectTokenRemoved",{text:t.attr("data-token-text"),id:t.attr("data-token-id")}),t.remove())},this.getFirstSuggestion=function(){return this.select("suggestionSelector").first()},this.getHighlightedSuggestion=function(){return this.select("highlightedSelector").first()},this.getNeighboringSuggestion=function(e,i){var s=i===t?"nextAll":"prevAll";return e[s](this.attr.suggestionSelector).first()},this.moveSuggestionHighlight=function(t){var e=this.getHighlightedSuggestion(),i=this.getNeighboringSuggestion(e,t);e.length?i.length&&this.setHighlight(i):this.setHighlight(this.getFirstSuggestion())},this.toggleTokenization=function(){var t=this.getHighlightedSuggestion(),e=t.attr("data-token-id");this.isTokenized(t)?(this.removeToken(this.select("tokenSelector").filter('[data-token-id="'+e+'"]')),this.$text.val("").focus()):this.tokenizeHighlightedSuggestion()},this.tokenizeHighlightedSuggestion=function(){var t=this.getHighlightedSuggestion();if(this.canTokenize(t)){var i=e(a[this.attr.tokenTemplate].render({token_class:this.attr.tokenClass,token_delete_class:this.attr.tokenDeleteClass,token_text:t.attr("data-token-text"),token_id:t.attr("data-token-id")},a));t.addClass(this.attr.selectedClass),this.$text.before(i),this.$text.val("").focus(),this.trigger("uiTokenizedMultiselectTokenAdded",{text:i.attr("data-token-text"),id:i.attr("data-token-id")})}},this.isTokenized=function(t){return e.inArray(t.attr("data-token-id"),this.getSelectedItemsIds())>=0},this.canTokenize=function(t){var e=this.select("tokenSelector").length>=this.attr.maxItems;return!e&&t.length&&!this.isTokenized(t)},this.getSelectedItemsIds=function(){return e.map(this.select("tokenSelector"),function(t){return e(t).attr("data-token-id")})},this.getSelectedItems=function(){return e.map(this.select("tokenSelector"),function(t){return{id:e(t).attr("data-token-id"),text:e(t).attr("data-token-text")}})},this.handleTextChange=function(t,e){this.trigger("uiTokenizedMultiselectTextChanged",{text:e.text,selected_items:this.getSelectedItemsIds()})},this.handleMouseOver=function(t){this.setHighlight(e(t.target).closest(this.attr.suggestionSelector))},this.updateWidth=function(){var t=this.select("tokenSelector").last();if(t.length){var e=this.select("inputContainerSelector").width()-t.position().left-t.outerWidth(!0),i=e<this.attr.textMinWidth?"100%":e;this.$text.outerWidth(i)}this.$text.prop("scrollHeight")>this.$text.prop("clientHeight")&&this.$text.outerWidth("100%")},this.selectedItemsChanged=function(){this.trigger("uiTokenizedMultiselectItemSelectionChanged",{selected_items:this.getSelectedItems()})},this.updateScroll=function(){var t=this.getHighlightedSuggestion(),e=this.select("suggestionsContainerSelector"),i=e.prop("scrollTop"),s=t.position().top+t.outerHeight();if(s>e.height()){var n=s-e.height();e.scrollTop(i+n)}else t.position().top<0&&e.scrollTop(i+t.position().top)},this.reset=function(){this.select("tokenSelector").remove(),this.$text.val("")},this.setMaxItems=function(t){this.attr.maxItems=t.maxItems},this.handleTokenChange=function(){this.updateWidth(),this.selectedItemsChanged()},this.updateSuggestions=function(t,e){var i=e.html,s=e.preserve_previous_hightlight,n=this.select("highlightedSelector").first().attr("data-token-id");if(this.clearHighlight(),this.select("suggestionsContainerSelector").html(i),s){var o=this.select("suggestionSelector").filter('[data-token-id="'+n+'"]').first(),a=o.length?o:this.select("suggestionSelector").first();this.setHighlight(a)}},this.clearHighlight=function(){this.select("suggestionSelector").removeAttr("id aria-selected").removeClass(this.attr.highlightedClass),this.$text.removeAttr("aria-activedescendant")},this.setHighlight=function(t){this.clearHighlight();var e="tokenizedMultiselectHighlight"+Math.floor(1e10*Math.random()).toString();t.addClass(this.attr.highlightedClass).attr({id:e,"aria-selected":!0}),this.$text.attr("aria-activedescendant",e)},this.after("moveSuggestionHighlight",this.updateScroll),this.after("tokenizeHighlightedSuggestion",this.handleTokenChange),this.after("toggleTokenization",this.handleTokenChange),this.after("removeFocusedToken",this.handleTokenChange),this.after("removeLastToken",this.handleTokenChange),this.after("reset",this.handleTokenChange),this.setupAria=function(){var t="TokenizedMultiselectOwns"+Math.floor(1e10*Math.random()).toString();this.select("suggestionsContainer").attr("id",t),this.$text.attr("aria-owns",t)},this.after("initialize",function(){this.initTextNode(),this.attr.placeholderText=this.$text.attr("placeholder"),this.setupAria(),this.on("uiTextChanged",this.handleTextChange),this.on("uiTextChanged",this.updateWidth),this.on("keyup keydown keypress paste",this.handleKeyPress),this.on("uiResetTokenizedMultiselect",this.reset),this.on("uiTokenizedMultiSelectMaxItems",this.setMaxItems),this.on("uiTokenizedMultiselectSuggestions",this.updateSuggestions),this.on("mouseover",{suggestionSelector:this.handleMouseOver}),this.on("click",{suggestionSelector:this.toggleTokenization,tokenDeleteSelector:this.removeFocusedToken})})}var n=i(10),o=i(212),a=i(107),r=i(244),c=n(s,o);t.exports=c}).call(e,i(1))},function(t,e,i){function s(){this.publishTyping=function(t,e){e&&e.conversation_id&&(this.trigger("dataDMTypingPublished"),this.post({url:"/i/direct_messages/publish_typing",data:{conversation_id:e.conversation_id}}))},this.after("initialize",function(){this.on("uiDMUserTyping",this.publishTyping)})}var n=i(10),o=i(225);t.exports=n(s,o)},function(t,e,i){function s(){this.attributes({conversation:".DMConversationContainer",groupAvatars:!1,maxCharacters:1e4}),this.openConversation=function(t,e){var i="uiRenderNewConversationView"===t.type?"uiOpenNewConversationView":"uiOpenConversationView";this.select("conversation").trigger(i,e)},this.after("initialize",function(){this.attachChild(a,this.attr.conversation),this.attachChild(c,this.attr.conversation),this.attachChild(r,this.attr.conversation,{groupAvatars:this.attr.groupAvatars,maxCharacters:this.attr.maxCharacters}),this.attachChild(h,this.attr.conversation),this.on("uiRenderConversationView uiRenderNewConversationView",this.openConversation)})}var n=i(10),o=i(215),a=i(249),r=i(250),c=i(358),h=i(359);t.exports=n(s,o)},function(t,e,i){function s(){this.attributes({addParticipantsSelector:".DMAddParticipants",addParticipantsInputSelector:".TokenizedMultiselect-input",addParticipantsDoneSelector:".DMAddParticipants-done",dialogBodySelector:".DMAddParticipants-content",spinnerSelector:".DMAddParticipants-spinner"}),this.setParticipants=function(t,e){this.conversationId&&this.conversationId===e.conversation_id&&(this.resetDMTypeahead(e),this.select("dialogBodySelector").css("visibility","visible"),this.select("spinnerSelector").addClass("u-hidden"),this.select("addParticipantsInputSelector").focus())},this.resetDMTypeahead=function(t){var e=t||{},i=e.participants&&e.participants.map(function(t){return t.id});this.trigger(this.attr.addParticipantsSelector,"uiInitializeDMTypeahead",{preselectedItems:i,maxItems:e.additional_participants_allowed})},this.prepareAddParticipants=function(t,e){this.conversationId=e.conversation_id,this.select("dialogBodySelector").css("visibility","hidden"),this.select("spinnerSelector").removeClass("u-hidden"),this.resetDMTypeahead(),this.trigger("uiNeedsDMConversation",{conversation_id:e.conversation_id})},this.addParticipants=function(){this.conversationId&&this.selectedAccounts.length&&this.trigger("uiAddConversationParticipants",{conversation_id:this.conversationId,participant_ids:this.selectedAccounts}),this.trigger("uiDMAddParticipantsDone")},this.handleSelectedItems=function(t,e){var i=e&&e.accounts&&e.accounts.length?e.accounts:[];this.selectedAccounts=i.map(function(t){return t.id})},this.possibleAddParticipants=function(t,e){("click"===t.type||"keydown"===t.type&&t.which===a.ENTER)&&this.addParticipants()},this.after("initialize",function(){this.attachChild(o,this.select("addParticipantsSelector")),this.selectedAccounts=[],this.on("uiDMTypeaheadSelectedItemsChanged",this.handleSelectedItems),this.on(document,"dataDMConversationResult",this.setParticipants),this.on("uiAddParticipants",this.prepareAddParticipants),this.on("click keydown",{addParticipantsDoneSelector:this.possibleAddParticipants})})}var n=i(10),o=i(245),a=i(244),r=i(215);t.exports=n(s,r)},function(t,e,i){(function(e){function s(){this.attributes({messageClass:"DirectMessage",sentMessageSelector:".DirectMessage--sent",emojiOnlyMessageSelector:".DirectMessage--emoji",receivedMessageSelector:".DirectMessage--received",newMessagesPillSelector:".DMConversation-newMessagesPill",pageBackRange:1e3,dmComposerSelector:".DMComposer",dmComposerSectionSelector:".DMConversation-composer",viewConversation:".DMConversation",conversationContentSelector:".DMConversation-content",conversationScrollContainer:".DMConversation-scrollContainer",conversationActionsDropdownSelector:".DMConversationActions",conversationActionsContentSelector:".DMConversationActions-content",conversationNameSelector:".DMConversation-name",conversationReadonlyClass:"is-readonly",spinnerSelector:".DMConversation-spinner",quickReplyOptionPanelSelector:".DMConversation-quickReply",conversationAvatarSelector:".DMUpdateAvatar",sendingStateSelector:".DMConversation-sendingStateIndicator",maxCharacters:1e4}),this.prepareConversationView=function(t,e){e=e||{};var i="uiOpenNewConversationView"===t.type,s=i&&e.screen_names&&1===e.screen_names.length;this.trigger("uiDMDialogClearActions"),this.trigger("uiUpdateConversationType",{is_oto:e.is_oto}),this.trigger("uiUpdateConversationState",{is_readonly:e.is_readonly}),this.triggerOnConversationAvatar("uiDMResetConversationAvatar");var n=e.name||e.generated_name,o=s?"text":"html";this.$conversationName[o](n),this.trigger("uiClearRichHeaderState"),this.$content.empty().removeAttr("data-thread-id").attr("data-thread-id",e.conversation_id),this.$viewConversation.removeAttr("data-thread-id").attr("data-thread-id",e.conversation_id),this.removeConversationActions(),this.hideNewMessagesPill(),this.trigger("uiRemoveQuickReply"),i?this.hideSpinner():(this.showSpinner(),this.loadConversationData(e)),this.trigger("uiDMConversationUpdated",e)},this.currentConversationId=function(){return this.$content.attr("data-thread-id")},this.isExistingConversation=function(){return!!this.currentConversationId()},this.isDataForCurrentConversation=function(t){return!this.isExistingConversation()||t.conversation_id===this.currentConversationId()},this.processConversationResult=function(t,e){if(t&&t.preventDefault(),e&&this.isDataForCurrentConversation(e)){if(this.isExistingConversation()||this.initializeDMComposer(null,e),this.$content.attr("data-thread-id",e.conversation_id),this.$viewConversation.attr("data-thread-id",e.conversation_id),this.$conversationName.empty().removeData("raw-name"),e.conversation&&e.conversation.title){var i=e.conversation.title;this.$conversationName.html(i.html).data("raw-name",i.raw),i.screen_name&&this.trigger("uiSetRichHeaderState",i)}this.updateConversationAvatar(e),this.trigger("uiUpdateConversationType",{is_oto:e.is_oto}),this.trigger("uiUpdateConversationState",{is_readonly:e.is_readonly}),e.conversation_actions?this.updateConversationActions(e.conversation_actions.html):this.removeConversationActions();var s=this.$content.children(),n=s.first().attr("data-message-id"),o=s.last().attr("data-message-id");this.isPageVisible()&&this.$content.is(":visible")&&e.conversation&&e.conversation.is_unread&&this.trigger("dataMarkDMsAsRead",{last_message_id:e.sort_event_id||-1,recipient_id:e.conversation_id}),this.updateConversationHTML(e,n,o),e.has_more===!1&&this.hideSpinner(),this.trigger("uiDMConversationUpdated",e)}},this.processUserUpdatesResult=function(t,i){if(!i.should_request_inbox&&!i.is_empty){var s=this.$content.attr("data-thread-id");(i.conversations||[]).forEach(function(t){t.conversation_id===s&&this.processConversationResult(null,t)},this),(i.update_events||[]).filter(function(_){return _.conversation_id===s}).forEach(function(t){switch(t.type){case"conversation_delete":this.trigger("uiCloseDMConversation");break;case"message_delete":this.$content.find('[data-message-id="'+t.message_id+'"]').remove(),0===this.$content.children().length&&this.trigger("uiCloseDMConversation"),this.updateQR(),this.trigger("uiDMMesageDeleted",{dmId:t.message_id});break;case"mark_spam":case"unmark_spam":t.messages.forEach(function(t){var i=e(t.html);this.$content.find('[data-message-id="'+t.message_id+'"]').replaceWith(i)},this)}},this),this.updateRapidFire()}},this.isPageVisible=function(){return"visible"===document.visibilityState},this.removeAnimationClass=function(t,i){var s=e(t.target).closest(this.attr.emojiOnlyMessageSelector);s.removeClass("is-animating")},this.removeConversationActions=function(){this.$conversationActionsDropdown.addClass("u-hidden"),this.$conversationActionsContent.empty()},this.updateConversationActions=function(t){this.$conversationActionsContent.html(t),this.$conversationActionsDropdown.removeClass("u-hidden")},this.updateConversationState=function(t,e){this.$viewConversation.toggleClass(this.attr.conversationReadonlyClass,!!e.is_readonly)},this.generateConversationHTML=function(t,e,i){var s=t.items,o=Object.keys(s);o.sort(n.compare);var a=!(e&&i),r="",c="";return o.forEach(function(t){a||n.compare(t,e)<0?r+=s[t]:n.compare(t,i)>0&&(c+=s[t])}),{prepend:r,append:c}},this.applyNewHtml=function(t,e,i,s){var n=this.$container[0].scrollHeight-this.$container.scrollTop();this.$content.prepend(e.prepend);var o=this.$container[0].scrollHeight-n;this.$container.scrollTop(o),this.$content.append(e.append),this.updateRapidFire(s),this.addAnimation(s),this.updateScrollPosition(t,s),this.updateQR(s)},this.updateConversationHTML=function(t,e,i){var s=this.generateConversationHTML(t,e,i),n=s.append||s.prepend;n&&this.applyNewHtml(t,s,e,i)},this.updateRapidFire=function(t){if(t){var i=this.attr.messageClass,s=this.$content.find('[data-message-id="'+t+'"]').nextAll().addBack();s.each(function(t,s){var n=e(this),o=n.next(),a=n.hasClass(i);if(a&&o.hasClass(i)){var r=n.find("[data-user-id]").attr("data-user-id"),c=n.find("[data-time]").attr("data-time"),h=n.find("[data-custom-profile-id]").attr("data-custom-profile-id"),l=o.find("[data-user-id]").attr("data-user-id"),d=o.find("[data-time]").attr("data-time"),u=o.find("[data-custom-profile-id]").attr("data-custom-profile-id");n.css("height"),r===l&&d-c<60&&h===u&&!n.hasClass("DirectMessage--emoji")&&!o.hasClass("DirectMessage--emoji")?n.addClass("is-rapidFire"):n.removeClass("is-rapidFire")}else a&&!o.hasClass(i)&&n.removeClass("is-rapidFire")})}},this.addAnimation=function(t){this.$content.find('[data-message-id="'+t+'"]').nextAll(this.attr.emojiOnlyMessageSelector).addClass("is-animating")},this.requestNextPage=function(){this.trigger("uiNeedsDMConversation",{conversation_id:this.$content.attr("data-thread-id"),max_entry_id:this.$content.children().first().attr("data-message-id")})},this.hideNewMessagesPill=function(){this.$newMessagesPill.addClass("is-hidden")},this.showNewMessagesPill=function(){
this.$newMessagesPill.removeClass("is-hidden"),setTimeout(this.hideNewMessagesPill.bind(this),3500)},this.showSpinner=function(){this.$spinner.removeClass("u-hidden")},this.hideSpinner=function(){this.$spinner.addClass("u-hidden")},this.isMessageVisible=function(t){return t.position().top<this.$container[0].clientHeight},this.findMessage=function(t){return this.$content.find('[data-message-id="'+t+'"]')},this.hasNewReceivedMessages=function(t){return t.nextAll(this.attr.receivedMessageSelector).length},this.updateScrollPosition=function(t,e){var i=!e,s=this.findMessage(e),n=s.nextAll(this.attr.sentMessageSelector).length,o=this.hasNewReceivedMessages(s);i?(this.$container.scrollTop(this.$container[0].scrollHeight),this.applyMarker(t.last_read_event_id)):o?this.isMessageVisible(s)?this.scrollToBottom():this.showNewMessagesPill():n&&(this.scrollToBottom(),this.removeMarker())},this.updateQR=function(t){var e=!t,i=this.findMessage(t),s=this.hasNewReceivedMessages(i);if(e||s){var n=this.$content.children().last().data("quick-reply-json");this.trigger("uiRemoveQuickReply"),n&&(this.trigger("uiShowQuickReply",{qrJson:n,isFirstResult:e}),this.scrollToBottom())}},this.addDMComposerSectionQuickReplyClass=function(){this.$dmComposerSection.addClass("is-showingQuickReply")},this.removeDMComposerSectionQuickReplyClass=function(){this.$dmComposerSection.removeClass("is-showingQuickReply")},this.scrollToBottom=function(){this.$container.stop().clearQueue().animate({scrollTop:this.$container[0].scrollHeight-this.$container[0].clientHeight},250),this.hideNewMessagesPill()},this.initializeDMComposer=function(t,e){this.trigger(this.attr.dmComposerSelector,"uiInitializeDMComposer",e)},this.loadConversationData=function(t){this.$viewConversation.trigger("uiNeedsDMConversation",{conversation_id:t.conversation_id,fromInitData:t.fromInitData})},this.updateConversationAvatar=function(t){var e=t.conversation&&t.conversation.avatar;e?this.triggerOnConversationAvatar("uiDMSetConversationAvatar",{html:e.html,full_size_url:e.full_size_url,conversation_id:t.conversation_id,is_custom:e.is_custom,is_oto:t.is_oto}):this.triggerOnConversationAvatar("uiDMResetConversationAvatar")},this.triggerOnConversationAvatar=function(t,e){this.$avatar.trigger(t,e)},this.showComposeSection=function(){this.select("dmComposerSectionSelector").show()},this.hideComposeSection=function(){this.select("dmComposerSectionSelector").hide(),this.scrollToBottom()},this.handleViewChange=function(t,e){var i="uiDMDialogClosed"===t.type||"conversation"!==e.activity?"uiDMConversationActivityHidden":"uiDMConversationActivityVisible";this.trigger(i,e)},this.handleTypingIndicatorShown=function(){var t=this.$content.children().last();this.isMessageVisible(t)&&this.scrollToBottom()},this.removeCardsFromConversation=function(){this.trigger(this.select("conversationScrollContainer"),"uiUnloadAllCards")},this.after("initialize",function(){this.attachChild(c,this.$node),this.attachChild(m,this.$node),this.attachChild(p,this.$node),this.attachChild(g,this.$node.find(".EmojiBar")),this.attachChild(v,this.$node),this.attachChild(S,this.$node),this.attachChild(w,this.$node),this.attachChild(b,this.$node),this.attachChild(E,this.select("quickReplyOptionPanelSelector")),this.attachChild(C,this.$node,{tweetSelector:".DirectMessage-message",mediaNotDisplayedSelector:".Sensitive-warning",mediaContainerSelector:".Sensitive-content",hiddenClass:"u-hidden"}),this.attachChild(y,this.$node),this.attachChild(T,this.$node,{eventData:{scribeContext:{component:"dm_existing_conversation_dialog"}}}),this.attachChild(D,this.$node),this.attachChild(I,this.$node),this.attachChild(k,this.$node.find(".DMUpdateAvatar")),this.attachChild(M,this.$node),this.attachChild(l,this.select("dmComposerSelector"),{defaultText:"",condensedText:"",suppressFlashMessage:!0,eventData:{scribeContext:{component:"tweet_box_dm"}},dmOnly:!0,mediaCategoryPrefix:"dm_",fileDataString:"media",fileInputString:"media",maxLength:this.attr.maxCharacters,warnLength:this.attr.maxCharacters-20,superwarnLength:this.attr.maxCharacters-10,timeToDismissSelectedQRInMS:d.get("dm_quick_reply_options_panel_dismiss_in_ms")}),this.attachChild(h,this.$node),this.attachChild(f,this.$node),this.attachChild(u,this.select("sendingStateSelector")),this.attachChild(A,this.select("conversationScrollContainer"),{containerSelector:this.attr.conversationScrollContainer,cardContainerSelector:".DirectMessage",unloadedCardsFilter:".DirectMessage .js-macaw-cards-iframe-container"}),this.attachChild(R,this.$node),this.attachChild(P,this.select("conversationScrollContainer"),{watchDocumentScroll:!1}),this.on("uiDMConversationActivityHidden","uiPauseAllMedia"),this.$avatar=this.select("conversationAvatarSelector"),this.$container=this.select("conversationScrollContainer"),this.$content=this.select("conversationContentSelector"),this.$viewConversation=this.select("viewConversation"),this.$conversationName=this.select("conversationNameSelector"),this.$spinner=this.select("spinnerSelector"),this.$newMessagesPill=this.select("newMessagesPillSelector"),this.$conversationActionsContent=this.select("conversationActionsContentSelector"),this.$conversationActionsDropdown=this.select("conversationActionsDropdownSelector"),this.$dmComposerSection=this.select("dmComposerSectionSelector"),this.on(document,"dataDMConversationResult dataDMSendSuccess",this.processConversationResult),this.on("dataDMDeleteSuccess",this.processUserUpdatesResult),this.on("uiOpenConversationView uiOpenNewConversationView",this.prepareConversationView),this.on("uiOpenConversationView uiOpenNewConversationView",this.initializeDMComposer),this.on("uiUpdateConversationState",this.updateConversationState),this.on("uiWantsConversationHistory",a.throttle(this.requestNextPage,1e3)),this.on(document,"uiDMDialogClosed uiDMActivityOpened",this.handleViewChange),this.on("uiDMConversationActivityHidden",this.removeCardsFromConversation),this.on("uiFeedbackPanelOpened",this.hideComposeSection),this.on("uiFeedbackPanelClosed",this.showComposeSection),this.on("uiB2CFeedbackUpdateView",this.scrollToBottom),this.on("uiShowQuickReplyOptionPanel",this.addDMComposerSectionQuickReplyClass),this.on("uiQuickReplyRemoved",this.removeDMComposerSectionQuickReplyClass),this.on("uiUpdateQR",function(){this.updateQR()}),this.on("uiDMTypingIndicatorShown",this.handleTypingIndicatorShown),this.on("click",{newMessagesPillSelector:this.scrollToBottom}),this.on("mouseover",{emojiOnlyMessageSelector:this.removeAnimationClass}),this.on(document,"dataDMUserUpdates",this.processUserUpdatesResult)})}var n=i(242),o=i(10),a=i(25),r=i(215),c=i(251),h=i(252),l=i(253),d=i(323),u=i(324),m=i(325),p=i(326),g=i(327),f=i(328),v=i(329),S=i(331),w=i(332),b=i(333),C=i(334),y=i(335),T=i(336),D=i(338),I=i(339),k=i(340),M=i(341),x=i(342),P=i(344),A=i(352),E=i(356),R=i(357),N=o(s,r,x);t.exports=N}).call(e,i(1))},function(t,e,i){function s(){this.attributes({conversationIdSelector:"[data-conversation-id]",conversationTypeSelector:"[data-is-oto]",addParticipantsSelector:".js-actionAddParticipants",viewParticipantsSelector:".js-actionViewParticipants",editConversationNameSelector:".js-actionEditConversationName",deleteConversationSelector:".js-actionDeleteConversation",reportConversationSelector:".js-actionReportConversation",enableNotificationsSelector:".js-actionEnableNotifications",disableNotificationsSelector:".js-actionDisableNotifications",actionsContainerSelector:".DMConversationActions-content"}),this.getConversationId=function(){return this.select("conversationIdSelector").attr("data-conversation-id")},this.isGroupConversation=function(){return!this.select("conversationTypeSelector").data("is-oto")},this.toggleNotificationsAction=function(t){this.select("enableNotificationsSelector").toggleClass("u-hidden",!!t),this.select("disableNotificationsSelector").toggleClass("u-hidden",!t)},this.toggleNotifications=function(t){this.trigger("uiToggleNotifications",{conversation_id:this.getConversationId(),enable_notifications:t})},this.updateNotificationsState=function(t,e){switch(t.type){case"dataDMConversationResult":e.conversation_actions&&this.getConversationId()===e.conversation_actions.conversation_id&&this.toggleNotificationsAction(e.conversation_actions.notifications);break;case"dataNotificationsEnabled":case"dataNotificationsDisableFailed":this.getConversationId()===e.sourceEventData.conversation_id&&this.toggleNotificationsAction(!0);break;case"dataNotificationsDisabled":case"dataNotificationsEnableFailed":this.getConversationId()===e.sourceEventData.conversation_id&&this.toggleNotificationsAction(!1)}},this.triggerAction=function(t){this.trigger(t,{conversation_id:this.getConversationId(),is_group:this.isGroupConversation()})},this.updateUIOnToggle=function(t,e){this.toggleNotificationsAction(e.enable_notifications)},this.after("initialize",function(){this.on("uiToggleNotifications",this.updateUIOnToggle),this.on("uiEnableDMNotifications",this.toggleNotifications.bind(this,!0)),o.getDecider("dm_granular_mute_controls")?this.on("uiDisableDMNotifications","uiShowDMMuteNotificationsConfirmation"):this.on("uiDisableDMNotifications",this.toggleNotifications.bind(this,!1)),this.on("click",{enableNotificationsSelector:"uiEnableDMNotifications",disableNotificationsSelector:"uiDisableDMNotifications",addParticipantsSelector:this.triggerAction.bind(this,"uiAddParticipants"),viewParticipantsSelector:this.triggerAction.bind(this,"uiViewParticipants"),editConversationNameSelector:this.triggerAction.bind(this,"uiEditConversationName"),deleteConversationSelector:this.triggerAction.bind(this,"uiShowDMDeleteConversationConfirmation"),reportConversationSelector:this.triggerAction.bind(this,"uiShowDMReportConversationConfirmation"),actionsContainerSelector:"uiCloseDropdowns"}),this.on("dataDMConversationResult dataNotificationsEnabled dataNotificationsDisabled dataNotificationsEnableFailed dataNotificationsDisableFailed",this.updateNotificationsState)})}var n=i(10),o=i(34),a=n(s);t.exports=a},function(t,e,i){function s(){this.requestAnimationFrame=window.requestAnimationFrame.bind(window),this.attributes({conversationContentSelector:".DMConversation-content",pageBackRange:500,scrollContainerSelector:".DMConversation-scrollContainer",spinnerSelector:".DMConversation-spinner"}),this.checkForConversationHistory=function(){this.requestAnimationFrame(function(){var t=!this.$spinner.hasClass("u-hidden")&&0!==this.$scrollContainer.prop("clientHeight")&&(this.$content.prop("clientHeight")<this.$scrollContainer.prop("clientHeight")||this.$scrollContainer.prop("scrollTop")<this.attr.pageBackRange);t&&this.trigger("uiWantsConversationHistory")}.bind(this))},this.after("initialize",function(){this.$content=this.select("conversationContentSelector"),this.$scrollContainer=this.select("scrollContainerSelector"),this.$spinner=this.select("spinnerSelector"),this.on(this.$scrollContainer,"scroll",o.debounce(this.checkForConversationHistory,250)),this.on("uiDMConversationUpdated",this.checkForConversationHistory)})}var n=i(10),o=i(25);t.exports=n(s)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){var i={};t.exports={get:function(t){return i[t]},set:function(t){i=t||{}},clear:function(){this.set({})}}},function(t,e,i){function s(){this.attributes({template:"dm/dm_sending_state_indicator",indicatorDelay:1e3}),this.state={current:0,conversationId:void 0,isVisible:!1,previousInFlight:0,total:0},this.render=function(){this.$node.html(o[this.attr.template].render({total:this.state.total,current:this.state.current},o)),this.state.isVisible?this.timeout=setTimeout(function(){this.state.isVisible?this.$node.slideDown(300):this.$node.hide()}.bind(this),this.attr.indicatorDelay):(clearTimeout(this.timeout),this.$node.slideUp(100))},this.updateCount=function(t,e){var i=e[this.state.conversationId]||0;0===i?(this.state.total=0,this.state.current=0):0===this.state.previousInFlight?(this.state.total=i,this.state.current=1):this.state.previousInFlight<i?this.state.total=this.state.total+1:this.state.previousInFlight>i&&(this.state.current=this.state.current+1),this.state.previousInFlight=i,this.state.isVisible=i>0},this.updateConversationId=function(t,e){this.state={isVisible:!1,total:0,conversationId:e.conversation_id,current:0,previousInFlight:0},this.trigger("uiDMConversationNeedsInFlightState")},this.after("updateCount",this.render),this.after("updateConversationId",this.render),this.after("initialize",function(){this.on(document,"dataDMMessagesInFlight",this.updateCount),this.on(document,"uiRenderConversationView",this.updateConversationId)})}var n=i(10),o=i(107);t.exports=n(s)},function(t,e,i){function s(){this.attributes({notice:".DMDeleteConversation",confirm:".DMDeleteConversation-confirm",cancel:".DMDeleteConversation-cancel",groupVariantClass:"DMDeleteConversation--group"}),this.showConfirmation=function(t,e){var i=e&&e.is_group;this.select("notice").toggleClass(this.attr.groupVariantClass,!!i).trigger("uiShowDMNotice")},this.hideConfirmation=function(){this.select("notice").trigger("uiDismissDMNotice")},this.state=function(t,e){return this._state=e||this._state||{},this._state},this.deleteConversation=function(){var t=this.state();this.trigger("uiDeleteConversation",{conversation_id:t.conversation_id}),this.hideConfirmation(),this.trigger("uiDMInboxWantsRefreshed")},this.after("initialize",function(){this.on("uiShowDMDeleteConversationConfirmation",this.state),this.on("uiShowDMDeleteConversationConfirmation",this.showConfirmation),this.on("click",{confirm:this.deleteConversation,cancel:this.hideConfirmation})})}var n=i(10),o=n(s);t.exports=o},function(t,e,i){function s(){this.attributes({notice:".DMDeleteMessage",confirm:".DMDeleteMessage-confirm",cancel:".DMDeleteMessage-cancel"}),this.showConfirmation=function(){this.select("notice").trigger("uiShowDMNotice")},this.hideConfirmation=function(){this.select("notice").trigger("uiDismissDMNotice")},this.state=function(t,e){return this._state=e||this._state||{},this._state},this.deleteMessage=function(){var t=this.state();this.trigger("uiDMDialogDeleteMessage",{id:t.messageId,conversation_id:t.conversationId}),this.hideConfirmation(),this.trigger("uiDMInboxWantsRefreshed")},this.after("initialize",function(){this.on("uiShowDMDeleteMessageConfirmation",this.state),this.on("uiShowDMDeleteMessageConfirmation",this.showConfirmation),this.on("click",{confirm:this.deleteMessage,cancel:this.hideConfirmation})})}var n=i(10),o=n(s);t.exports=o},function(t,e,i){(function(e){function s(){this.attributes({emojiSuggestionSelector:".EmojiBar-suggestion"}),this.suggest=function(t,i){var s=e(t.target).closest(this.attr.emojiSuggestionSelector).data("text");s&&this.trigger("uiEmojiSuggestion",{text:s})},this.after("initialize",function(){this.on("click",{emojiSuggestionSelector:this.suggest})})}var n=i(10);t.exports=n(s)}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.attributes({feedbackDismissSelector:".DMFeedback-dismiss",feedbackSelector:".DMFeedback",feedbackPageFrameSelector:"iframe.B2CFeedback"}),this.showFeedback=function(t,e){this.$b2cFeedback.is(":visible")||this.$b2cFeedback.show();var i="/i/pages/feedback?cardUri="+encodeURIComponent(t)+"&lang="+e;this.$feedbackIframe.attr("src")!==i&&this.$feedbackIframe.attr("src",i),this.trigger("uiFeedbackPanelOpened")},this.dismissFeedback=function(){var t=this.$feedbackIframe.data("current-view");this.closeFeedback(),this.trigger("uiB2CFeedbackDismiss",{cardName:this.feedback.name,feedbackId:this.feedback.feedback_id,currentView:t})},this.closeFeedback=function(){this.$b2cFeedback.hide(),this.$feedbackIframe.attr("src",""),this.trigger("uiFeedbackPanelClosed")},this.handleFeedbackError=function(t,e){var i=e&&e.errorMessage;this.trigger(document,"uiShowError",{message:i}),this.trigger("dataDMError",{message:i})},this.handleFeedbackTweetBtnClick=function(t,e){this.closeFeedback(),this.trigger(document,"uiOpenTweetDialog",{title:"Twittea sobre tu experiencia",canTweetDefaultText:!1,text:e&&e.prefilledText})},this.updateFeedbackPanel=function(t,i){var s=e("html").attr("lang")||"en";i&&i.feedback&&(this.feedback=i.feedback,this.showFeedback(this.feedback.card_uri,s))},this.handleFeedbackUpdateView=function(t,e){this.$feedbackIframe.data("current-view",e.view)},this.resizeIframe=function(t){this.fitIframeHeight(t,{iframeSelector:this.attr.feedbackPageFrameSelector,isQualified:function(t){return t.name&&"commerce_page"===t.name&&t.height}})},this.closeFeedbackPanelWithId=function(t,e){this.feedback&&e.dmId===this.feedback.dm_id&&this.closeFeedback()},this.after("initialize",function(){this.$b2cFeedback=this.select("feedbackSelector"),this.$feedbackIframe=this.select("feedbackPageFrameSelector"),this.on("uiB2CCloseFeedbackAnchor uiDMDialogClearActions",this.closeFeedback),this.on("uiB2CFeedbackPostError",this.handleFeedbackError),this.on("uiB2CTweetBtnClicked",this.handleFeedbackTweetBtnClick),this.on("uiB2CFeedbackUpdateView",this.handleFeedbackUpdateView),this.on("uiDMConversationUpdated",this.updateFeedbackPanel),this.on("uiDMMesageDeleted",this.closeFeedbackPanelWithId),this.on(window,"message",this.resizeIframe),this.on(window,"message",this.proxyIframeEvents),this.on("click",{feedbackDismissSelector:this.dismissFeedback})})}var n=i(10),o=i(71),a=i(69),r=(i(22),n(s,o,a));t.exports=r}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({deleteSelector:".DMDeleteMessageAction",reportSelector:".DMReportMessageAction"}),this.hideMessage=function(t,e){if("not_spam"!==e.report_as){this.hiddenMessages=this.hiddenMessages||{};var i=".DMConversation [data-message-id='"+e.id+"'] {display: none !important;}";this.hiddenMessages[e.id]=this.insertCSSRule(this.stylesheet,i)}},this.unhideMessage=function(t,e){this.hiddenMessages=this.hiddenMessages||{};var i=this.hiddenMessages[e.id];null!=i&&this.removeCSSRule(this.stylesheet,i)},this.messageAction=function(t,i){var s=e(i.target);this.trigger(t,{messageId:s.closest("[data-message-id]").attr("data-message-id"),conversationId:s.closest("[data-thread-id]").attr("data-thread-id")})},this.after("initialize",function(){this.stylesheet=this.createStyleSheet("hidden-dms"),this.on("uiDMDialogReportDM uiDMDialogDeleteMessage",this.hideMessage),this.on("dataDMDeleteFailed dataDMReportFailed",this.unhideMessage),this.on("click",{deleteSelector:this.messageAction.bind(this,"uiShowDMDeleteMessageConfirmation"),reportSelector:this.messageAction.bind(this,"uiShowDMReportMessageConfirmation")})})}var n=i(10),o=i(330),a=n(s,o);t.exports=a}).call(e,i(1))},function(t,e){function i(){this.createStyleSheet=function(t){var e=document.createElement("style");return e.type="text/css",t&&(e.id=t),document.getElementsByTagName("head")[0].appendChild(e),e.sheet||new s},this.rules=function(t){return t.cssRules?t.cssRules:t.rules},this.insertCSSRule=function(t,e){return t.insertRule(e,this.rules(t).length)},this.removeCSSRule=function(t,e){t.deleteRule(e)}}t.exports=i;var s=function(){function t(){this.cssRules=[]}return t.prototype.insertRule=function(t,e){return this.cssRules[e]={cssText:t},e},t.prototype.deleteRule=function(t){delete this.cssRules[t],this.cssRules=this.cssRules.filter(function(t){})},t}()},function(t,e,i){(function(e){function s(){this.attributes({notice:".DMMuteNotifications",cancel:".DMMuteNotifications-cancel",muteConfirmation:".DMMuteNotifications-mute"}),this.showConfirmation=function(){this.select("notice").trigger("uiShowDMNotice")},this.hideConfirmation=function(){this.select("notice").trigger("uiDismissDMNotice")},this.muteNotifications=function(t){var i=e(t.target),s=i.data("mute-duration");this.trigger("uiToggleNotifications",{conversation_id:this.conversationId,enable_notifications:!1,mute_duration:s}),this.hideConfirmation()},this.updateCurrentConversation=function(t,e){this.conversationId=e.conversation_id},this.after("initialize",function(){this.on("uiShowDMMuteNotificationsConfirmation",this.showConfirmation),this.on(document,"uiRenderConversationView",this.updateCurrentConversation),this.on("click",{muteConfirmation:this.muteNotifications,cancel:this.hideConfirmation})})}var n=i(10),o=n(s);t.exports=o}).call(e,i(1))},function(t,e,i){function s(){this.attributes({notice:".DMReportConversation",abuseConfirmation:".DMReportConversation-abuse",spamConfirmation:".DMReportConversation-spam",cancel:".DMReportConversation-cancel",groupVariantClass:"DMReportConversation--group"}),this.showConfirmation=function(t,e){var i=e&&e.is_group;this.select("notice").toggleClass(this.attr.groupVariantClass,!!i).trigger("uiShowDMNotice")},this.hideConfirmation=function(){this.select("notice").trigger("uiDismissDMNotice")},this.state=function(t,e){return this._state=e||this._state||{},this._state},this.reportConversation=function(t){var e=this.state();this.trigger("uiReportConversation",{conversation_id:e.conversation_id,report_as:t}),this.hideConfirmation(),this.trigger("uiDMInboxWantsRefreshed")},this.after("initialize",function(){this.on("uiShowDMReportConversationConfirmation",this.state),this.on("uiShowDMReportConversationConfirmation",this.showConfirmation),this.on("click",{abuseConfirmation:this.reportConversation.bind(this,"abuse"),spamConfirmation:this.reportConversation.bind(this,"spam"),cancel:this.hideConfirmation})})}var n=i(10),o=n(s);t.exports=o},function(t,e,i){function s(){this.attributes({notice:".DMReportMessage",abuseConfirmation:".DMReportMessage-abuse",spamConfirmation:".DMReportMessage-spam",cancel:".DMReportMessage-cancel"}),this.showConfirmation=function(){this.select("notice").trigger("uiShowDMNotice")},this.hideConfirmation=function(){this.select("notice").trigger("uiDismissDMNotice")},this.state=function(t,e){return this._state=e||this._state||{},this._state},this.reportMessage=function(t){var e=this.state();this.trigger("uiDMDialogReportDM",{id:e.messageId,conversation_id:e.conversationId,report_as:t}),this.hideConfirmation(),this.trigger("uiDMInboxWantsRefreshed")},this.after("initialize",function(){this.on("uiShowDMReportMessageConfirmation",this.state),this.on("uiShowDMReportMessageConfirmation",this.showConfirmation),this.on("click",{abuseConfirmation:this.reportMessage.bind(this,"abuse"),spamConfirmation:this.reportMessage.bind(this,"spam"),cancel:this.hideConfirmation})})}var n=i(10),o=n(s);t.exports=o},function(t,e,i){(function(e){function s(){this.defaultAttrs({mediaNotDisplayedSelector:".media-not-displayed",displayMediaSelector:".display-this-media",alwaysDisplaySelector:".always-display-media",appealNsfwMediaSelector:".appeal-nsfw-media",mediaContainerSelector:".js-media-container, .js-adaptive-media-container, .js-old-media-container",tweetSelector:".tweet",hiddenClass:"hidden"}),this.showMedia=function(t){t=t||this.$node,t.find(this.attr.mediaNotDisplayedSelector).hide(),t.find(this.attr.mediaContainerSelector).removeClass(this.attr.hiddenClass)},this.showLimitedMedia=function(t){t.stopImmediatePropagation();var i=e(t.target).closest(this.attr.tweetSelector);this.trigger("uiShowLimitedMedia"),this.showMedia(i)},this.updateMediaSettings=function(t){t.stopImmediatePropagation(),this.trigger("uiUpdateViewPossiblySensitive",{do_show:!0}),this.showMedia()},this.appealNsfwMedia=function(t){var i=e(t.target).closest(this.attr.mediaNotDisplayedSelector),s=i.find(this.attr.appealNsfwMediaSelector);if(!s.hasClass(this.attr.hiddenClass)){var n=i.closest(this.attr.tweetSelector);this.trigger("uiAppealNsfwMedia",{user_id:n.attr("data-user-id"),tweet_id:n.attr("data-tweet-id"),report_type:"dispute_media"}),i.find(this.attr.appealNsfwMediaSelector).hide()}},this.after("initialize",function(){this.on("click",{displayMediaSelector:this.showLimitedMedia,alwaysDisplaySelector:this.updateMediaSettings,appealNsfwMediaSelector:this.appealNsfwMedia})})}var n=i(10);t.exports=n(s)}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({warningSelector:".suspicious-content-warning",messageSelector:".dm",conversationSelector:".js-dm-conversation",reportButtonsSelector:".suspicious-content-response",reportAsSpamSelector:".js-message-is-spam",reportAsSafeSelector:".js-message-is-safe"}),this.showMessage=function(t,i){t.preventDefault();var s=e(t.target),n=s.prev(this.attr.messageSelector);s.hide(),n.show()},this.reportMessage=function(t,i,s){var n=e(i.target),o=n.closest(this.attr.messageSelector).attr("data-message-id"),a=n.closest(this.attr.conversationSelector).attr("data-thread-id");this.trigger("uiDMDialogReportDM",{id:o,conversation_id:a,report_as:t}),this.select("reportButtonsSelector").hide(),this.trigger("uiDMInboxWantsRefreshed")},this.after("initialize",function(){this.on("uiRevealSuspiciousDM",this.showMessage),this.on("uiReportDMAsSpam",this.reportMessage.bind(this,"spam")),this.on("uiReportDMAsSafe",this.reportMessage.bind(this,"not_spam")),this.on("click",{warningSelector:"uiRevealSuspiciousDM",reportAsSpamSelector:"uiReportDMAsSpam",reportAsSafeSelector:"uiReportDMAsSafe"})})}var n=i(10),o=n(s);t.exports=o}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({sharedTweetSelector:".DirectMessage-tweet"}),this.openSharedTweet=function(t,e){this.trigger("uiDMDialogSharedTweetClick")},this.after("initialize",function(){this.on("click",{sharedTweetSelector:this.openSharedTweet})})}var n=i(10),o=i(337),a=n(s,o);t.exports=a},function(t,e,i){(function(e){var s=i(213),n=i(25),o=i(52),a=i(42);t.exports=function(){this.defaultAttrs({jsMediaPreviewSelector:".js-media-preview",jsTweetSelector:".js-stream-tweet",jsLinkSelector:".js-link",jsPermalinkSelector:".js-permalink",jsDetailsLinkSelector:".js-details",jsAdaptivePhotoSelector:".js-adaptive-photo",quoteTweetSelector:".QuoteTweet-container",quoteTweetClass:"QuoteTweet-container",quoteTweetInnerSelector:".QuoteTweet-innerContainer",pushState:!0,expandoHandleSelector:".js-open-close-tweet span",dropdownSelector:".ProfileTweet-action .dropdown-menu",withheldTweetClass:"withheld-tweet",profileTweetActionButtonSelector:".js-actionButton",profileTweetActionCountSelector:".js-actionCount",jsTweetTextContainer:".js-tweet-text-container",jsExpandedTweetTextSelector:".js-expanded-tweet-text",jsTweetText:".js-tweet-text",newWindowClass:"js-new-window"}),this.shouldNavigateToPermalink=function(t){return this.attr.isMobile||this.isQuoteTweet(t)},this.isQuoteTweet=function(t){return t.hasClass(this.attr.quoteTweetClass)},this.handleMediaPreviewClick=function(t,i){var s=e(i.el),n=s.closest(this.attr.jsTweetSelector);this.shouldExpandWhenTargetIs(e(t.target),n)&&(t.preventDefault(),t.stopPropagation(),this.handleClick(t,n,!0))},this.handleQuoteTweetClick=function(t){var e=t.closest("[data-tweet-id]").attr("data-tweet-id"),i=t.find(this.attr.quoteTweetInnerSelector).attr("data-item-id"),s=[{id:e,item_type:a.tweet},{id:i,item_type:a.quotedTweet}];this.trigger("uiQuoteTweetClick",{items:s})},this.handleTweetClick=function(t,i){var s=e(i.el);this.isQuoteTweet(s)&&this.handleQuoteTweetClick(s),this.shouldExpandWhenTargetIs(e(t.target),s)&&(t.preventDefault(),t.stopPropagation(),this.handleClick(t,s,!1))},this.handleClick=function(t,e,i){var s=e.hasClass(this.attr.quoteTweetClass),o=e.find(this.attr.jsPermalinkSelector),a=s?o.attr("href"):e.data("permalink-path"),r=s?o.data("conversation-id"):e.data("conversation-id"),c=e.closest("[data-impression-id]"),h={impressionId:c.attr("data-impression-id"),disclosureType:c.attr("data-disclosure-type"),impressionCookie:c.attr("data-impression-cookie"),href:a,conversation_id:r};!i&&this.shouldNavigateToPermalink(e)&&this.setImpressionCookieOnProfileTweet(e),e.trigger("uiHasClickedTweet",n.merge(h,{organicExpansion:!0})),this.modifierKey(t)||o.length&&(o.attr("target")||o.hasClass(this.attr.newWindowClass))?this.openNewTab(a):this.trigger("uiNavigate",h)},this.openNewTab=function(t){var e=window.open(t,"_blank");e.opener=null},this.setImpressionCookieOnProfileTweet=function(t){if(t.hasClass("profile-promoted-tweet")){var e=t.closest("[data-impression-cookie]").attr("data-impression-cookie");if(e){var i=new Date,s=1e4,n=new Date(i.getTime()+s);this.setCookie(e,n)}}},this.shouldExpandWhenTargetIs=function(t,e){return!this.selectedText()&&!e.hasClass(this.attr.withheldTweetClass)&&(this.targetIsWhitelistedToExpandTweet(t,e)||!this.targetIsBlacklistedToExpandTweet(t,e))},this.targetIsWhitelistedToExpandTweet=function(t,e){var i=[this.attr.expandoHandleSelector,this.attr.jsDetailsLinkSelector,this.attr.jsMediaPreviewSelector,this.attr.quoteTweetSelector];return t.closest(i.join(),e).length>0},this.targetIsBlacklistedToExpandTweet=function(t,e){var i=["a","button",this.attr.jsLinkSelector,this.attr.dropdownSelector,this.attr.jsAdaptivePhotoSelector];return t.closest(i.join(),e).length},this.selectedText=function(){return s.getSelection()},this.modifierKey=function(t){return t.shiftKey||t.ctrlKey||t.metaKey||t.which>1},this.preventFocusOnClick=function(t){t.preventDefault()},this.setCookie=function(t,e){o("ic",t,{expires:e})},this.after("initialize",function(){this.on("click",{jsMediaPreviewSelector:this.handleMediaPreviewClick,quoteTweetSelector:this.handleTweetClick,jsTweetSelector:this.handleTweetClick}),this.on("uiShortcutEnter",{quoteTweetSelector:this.handleTweetClick}),this.on("mousedown",{profileTweetActionButtonSelector:this.preventFocusOnClick,profileTweetActionCountSelector:this.preventFocusOnClick,quoteTweetSelector:this.preventFocusOnClick})})}}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({ctaQuickReplySelector:".DMCtaView",directMessageSelector:".DirectMessage",quickReplyJsonData:"quick-reply-json"}),this.getClosestQRJson=function(t){return t.closest(this.attr.directMessageSelector).data(this.attr.quickReplyJsonData)},this.getCtaEventDataFromQR=function(t){var e=t&&t.type&&t.type.name;switch(e){case o.LOCATION_TYPE:return{name:"uiLocationQRCtaClicked"}}},this.handleCtaClick=function(t,i){var s=this.getCtaEventDataFromQR(this.getClosestQRJson(e(t.target)));s&&this.trigger(s.name,s.data)},this.after("initialize",function(){this.on("click",{ctaQuickReplySelector:this.handleCtaClick})})}var n=i(10),o=i(321),a=n(s);t.exports=a}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({locationAttachmentSelector:".DMLocationAttachment",expandedMapUriData:"expanded-url"}),this.getClosestExpandedMapUri=function(t){return t.closest(this.attr.locationAttachmentSelector).data(this.attr.expandedMapUriData)},this.handleClick=function(t,i){t.preventDefault();var s=this.getClosestExpandedMapUri(e(t.target));s&&this.trigger("uiLocationAttachmentClicked",{src:s})},this.after("initialize",function(){this.on("click",{locationAttachmentSelector:this.handleClick})})}var n=i(10),o=n(s);t.exports=o}).call(e,i(1))},function(t,e,i){function s(){this.attributes({avatarSelector:".DMUpdateAvatar-avatar",popoverSelector:".DMPopover",popoverContentSelector:".DMPopover-content",viewAvatarSelector:".DMUpdateAvatar-view",removeAvatarSelector:".DMUpdateAvatar-remove",changeAvatarSelector:".DMUpdateAvatar-change",spinnerClass:"DMSpinner",fileDataSelector:"input.file-data",fileDataString:"media_data[]",emptyFileDataString:"media_data_empty",fileInputString:"media[]",emptyFileInputString:"media_empty",fileNameSelector:"input.file-name",fileNameString:"media_file_name",fileSelector:"input.file-input",gifSupport:!1,videoSupport:!1,shouldInterceptTab:!1}),this.resetAvatar=function(t,e){this.avatarHTML=void 0,this.fullSizeUrl=void 0,this.conversationId=void 0,this.customAvatar=!1,this.editAllowed=!1,this.isLoading=!1},this.updateAvatar=function(t,e){e&&e.html&&this.avatarHTML===e.html||(this.avatarHTML=e.html,this.fullSizeUrl=e.full_size_url,this.conversationId=e.conversation_id,this.customAvatar=e.is_custom,this.editAllowed=e.is_oto===!1,this.isLoading=!1)},this.showAvatar=function(){this.fullSizeUrl&&this.trigger("uiDMDialogMediaPreview",{imgUrl:this.fullSizeUrl})},this.removeAvatar=function(){this.isLoading=!0,this.trigger("uiDMRemoveConversationAvatar",{conversation_id:this.conversationId
})},this.changeAvatar=function(){this.select("fileSelector").click()},this.handleFileSelected=function(t,e){t.preventDefault(),this.reset(),this.isLoading=!0;var i=e.fileId;this.beginSru(i),this.trigger("uiDMUpdateConversationAvatar",{conversation_id:this.conversationId,fileId:i})},this.updateFailed=function(){this.isLoading=!1},this.addFileError=function(t){var e=o(t);e&&this.trigger("uiShowError",{message:e}),this.updateFailed()},this.toggleSpinner=function(t){this.$avatar.toggleClass(this.attr.spinnerClass,t)},this.disablePopover=function(){this.select("popoverSelector").trigger("uiDisableDMPopover")},this.enablePopover=function(){this.select("popoverSelector").trigger("uiEnableDMPopover")},this.render=function(){this.isLoading?(this.$avatar.empty(),this.toggleSpinner(!0),this.disablePopover()):(this.avatarHTML?this.$avatar.html(this.avatarHTML):this.$avatar.empty(),this.toggleSpinner(!1),this.editAllowed?this.enablePopover():this.disablePopover(),this.$node.attr("data-has-custom-avatar",this.customAvatar))},this.after("resetAvatar",this.render),this.after("updateAvatar",this.render),this.after("removeAvatar",this.render),this.after("handleFileSelected",this.render),this.after("updateFailed",this.render),this.after("initialize",function(){this.$avatar=this.select("avatarSelector"),this.on("uiDMResetConversationAvatar",this.resetAvatar),this.on("uiDMSetConversationAvatar",this.updateAvatar),this.on("uiFileSelected",this.handleFileSelected),this.on("dataDMUpdateConversationAvatarFailed dataDMRemoveConversationAvatarFailed",this.updateFailed),this.on("click",{viewAvatarSelector:this.showAvatar,changeAvatarSelector:this.changeAvatar,removeAvatarSelector:this.removeAvatar,popoverContentSelector:"uiCloseDropdowns"})})}var n=i(10),o=i(271),a=i(272);t.exports=n(s,a)},function(t,e,i){function s(){this.attributes({maxCharacters:20,conversationIdSelector:"[data-conversation-id]",displayedNameSelector:".DMUpdateName-name",beginEditModeSelector:".DMUpdateName-name.edit-allowed",confirmButtonSelector:".DMUpdateName-confirm",inputGroupSelector:".DMUpdateName-form",spinnerSelector:".DMUpdateName-spinner",dmUpdateNameSelector:".DMUpdateName",displayedScreenNameSelector:".DMUpdateName-screenName",textSelector:".DMUpdateName-input",updateNameContainerSelector:".DMUpdateName-controls",isVerifiedClass:"is-verified",isRichHeaderClass:"is-richHeader",hiddenClass:"u-hidden",invalidInputClass:"is-invalid"}),this.getConversationId=function(){return this.select("conversationIdSelector").attr("data-conversation-id")},this.getCurrentName=function(){return this.select("displayedNameSelector").data("raw-name")},this.handleCommandInputs=function(t,e){switch(t.keyCode){case r.ESC:t.stopPropagation(),this.hideEditMode();break;case r.ENTER:t.stopPropagation(),this.requestUpdateConversationName()}},this.showEditMode=function(){this.select("displayedNameSelector").addClass(this.attr.hiddenClass),this.select("inputGroupSelector").removeClass(this.attr.hiddenClass),this.select("textSelector").focus().val(this.getCurrentName()),this.inEditMode=!0},this.hideEditMode=function(t,e){this.select("displayedNameSelector").removeClass(this.attr.hiddenClass),this.select("inputGroupSelector").addClass(this.attr.hiddenClass),this.inEditMode=!1},this.showSpinner=function(){this.select("textSelector").unbind("blur"),this.hideEditMode(),this.select("displayedNameSelector").addClass(this.attr.hiddenClass),this.select("spinnerSelector").removeClass(this.attr.hiddenClass)},this.hideSpinner=function(){this.on(this.attr.textSelector,"blur",this.hideEditMode),this.hideEditMode(),this.select("spinnerSelector").addClass(this.attr.hiddenClass),this.select("displayedNameSelector").removeClass(this.attr.hiddenClass)},this.requestUpdateConversationName=function(){if(!this.select("inputGroupSelector").hasClass(this.attr.invalidInputClass)){var t=this.select("textSelector").val();this.trigger("uiUpdateConversationName",{conversation_id:this.getConversationId(),name:t}),this.showSpinner()}},this.updateDisplayedName=function(t,e){this.select("displayedNameSelector").html(e.conversation.title.html),this.hideSpinner()},this.prepareUpdateNameUI=function(t,e){"undefined"==typeof e.is_oto||e.is_oto?(this.hideSpinner(),this.select("updateNameContainerSelector").addClass(this.attr.hiddenClass),this.select("displayedNameSelector").removeClass("edit-allowed js-tooltip").removeAttr("title")):this.inEditMode||(this.hideSpinner(),this.select("updateNameContainerSelector").removeClass(this.attr.hiddenClass),this.select("displayedNameSelector").attr("title","Haz clic para editar el nombre del grupo").addClass("edit-allowed js-tooltip"))},this.handleInputChange=function(t,e){var i=o.getTweetLength(e.text)>this.attr.maxCharacters;this.select("inputGroupSelector").toggleClass(this.attr.invalidInputClass,i)},this.detectInputChange=function(){var t=this.select("textSelector").val();this.previousText!==t&&(this.trigger("uiTextChanged",{text:t}),this.previousText=t)},this.clearRichHeaderState=function(){this.$dmUpdateName.removeClass(this.attr.isRichHeaderClass),this.$dmUpdateName.removeClass(this.attr.isVerifiedClass)},this.setRichHeaderState=function(t,e){this.$dmUpdateName.addClass(this.attr.isRichHeaderClass),this.$dmUpdateName.toggleClass(this.attr.isVerifiedClass,e.is_verified),this.$displayedScreenName.text("@"+e.screen_name)},this.after("initialize",function(){this.$dmUpdateName=this.select("dmUpdateNameSelector"),this.$displayedScreenName=this.select("displayedScreenNameSelector"),this.on("click",{beginEditModeSelector:this.showEditMode}),this.on("mousedown",{confirmButtonSelector:this.requestUpdateConversationName}),this.on(this.attr.textSelector,"blur",this.hideEditMode),this.on(this.attr.textSelector,"keydown",this.handleCommandInputs),this.on("uiEditConversationName",this.showEditMode),this.on("uiUpdateConversationType",this.prepareUpdateNameUI),this.on("dataUpdateConversationNameSuccess",this.updateDisplayedName),this.on("dataUpdateConversationNameFailure",this.hideSpinner),this.on("uiTextChanged",this.handleInputChange),this.on("uiInputPoll",this.detectInputChange),this.on("uiClearRichHeaderState",this.clearRichHeaderState),this.on("uiSetRichHeaderState",this.setRichHeaderState),a.attachTo(this.select("textSelector"))})}var n=(i(22),i(10)),o=i(218),a=i(214),r=i(244),c=n(s);t.exports=c},function(t,e,i){function s(){this.attributes({markerSelector:".DMConversation-lastReadMarker",markerTemplate:"dm/last_read_marker",messageIdAttr:"data-message-id",receivedMessagesSelector:".DirectMessage--received",scrollContainerSelector:".DMConversation-scrollContainer"}),this.removeMarker=function(){this.select("markerSelector").slideUp({duration:350})},this.applyMarker=function(t){var e=this.findLastReadNode(t),i=e.nextAll().filter(this.attr.receivedMessagesSelector),s=i.first(),a=!!s.length;if(a){s.prev().removeClass("is-rapidFire");var r=i.length,c={unread_count:r};c["unread_count_"+n.PluralRules.rule_for(i.length)]=!0,s.before(o[this.attr.markerTemplate].render(c));var h=s.prop("offsetTop")-.33*this.$scrollContainer.height();this.$scrollContainer.scrollTop(h)}},this.findLastReadNode=function(t){return this.$node.find("["+this.attr.messageIdAttr+"="+t+"]")},this.after("initialize",function(){this.$scrollContainer=this.select("scrollContainerSelector")})}var n=i(343),o=i(107);t.exports=s},,function(t,e,i){(function(e){function s(){this.viewportHelpers=o,this.utils=a,this.defaultAttrs({playableMediaContainerSelector:".PlayableMedia",playableMediaLoadThreshold:500,scrollThrottle:100,watchedClass:"watched",watchedSelector:".watched",watchDocumentScroll:!0,liveVideoContinuePlayingBehindModals:!1}),this.updateWatchedMedia=function(){this.$media=this.select("playableMediaContainerSelector");var t=this.$media.not(this.attr.watchedSelector);r.attachTo(t,{liveVideoContinuePlayingBehindModalsEnabled:this.attr.liveVideoContinuePlayingBehindModalsEnabled}),t.addClass(this.attr.watchedClass),this.throttledProcessWatchedMedia()},this.processWatchedMedia=function(){this.isInFullscreen()||this.$media.each(function(t,i){var s=e(i),n=o.isWithinBounds(this.$container,s,this.attr.playableMediaLoadThreshold),a=s.hasClass("playable-media-loaded");!a&&n?s.trigger("uiLoadPlayableMedia"):a&&!n&&s.trigger("uiUnloadPlayableMedia")}.bind(this))},this.isInFullscreen=function(){return document.webkitFullscreenElement||document.msFullscreenElement||document.fullscreenElement||document.mozFullScreenElement},this.fullscreenChange=function(){clearInterval(this.fullscreenTimeout),this.isInFullscreen()?this.stopListeningOnProcessEvents():this.fullscreenTimeout=setTimeout(this.listenOnProcessEvents.bind(this),2e3)},this.listenOnProcessEvents=function(){this.on(this.$container,"resize",this.throttledProcessWatchedMedia),this.attr.watchDocumentScroll?this.on(document,"scroll",this.throttledProcessWatchedMedia):this.on("scroll",this.throttledProcessWatchedMedia)},this.stopListeningOnProcessEvents=function(){this.off(this.$container,"resize",this.throttledProcessWatchedMedia),this.attr.watchDocumentScroll?this.off(document,"scroll",this.throttledProcessWatchedMedia):this.off("scroll",this.throttledProcessWatchedMedia)},this.beforeTeardown=function(){this.$media.removeClass(this.attr.watchedClass)},this.before("teardown",this.beforeTeardown),this.after("initialize",function(){this.$container=e(window),this.throttledProcessWatchedMedia=a.throttle(this.processWatchedMedia.bind(this),this.attr.scrollThrottle),this.on(document,"uiPageChanged uiWatchPlayableMedia",this.updateWatchedMedia),this.listenOnProcessEvents(),this.on(document,"fullscreenchange webkitfullscreenchange msfullscreenchange mozfullscreenchange",this.fullscreenChange),this.updateWatchedMedia()})}var n=i(10),o=i(73),a=i(25),r=i(345);t.exports=n(s)}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.VideoPlayer=h,this.defaultAttrs({playerSelector:".PlayableMedia-player",autoplayOnHover:!1,playerLoadedClass:"playable-media-loaded",liveVideoContinuePlayingBehindModalsEnabled:!1}),this.autoplay=function(){this.player?this.player.playPreview():this.autoplayOnInit=!0},this.autoplayStop=function(){this.player?this.player.pausePreview():this.autoplayOnInit=!1},this.loadMedia=function(){this.$node.addClass(this.attr.playerLoadedClass);var t,e=this.select("playerSelector");"undefined"!=typeof this.tweetId&&(t=this.requestDynamicVideoAd.bind(this));var i={scribeContext:this.getScribeContext(),promotedContext:this.getPromotedContext(),hideControls:e.hasClass("hide-controls"),adRequestCallback:t,borderRadius:this.getBorderRadius(e)},s=e.get(0),n=this.getPlayerConstructor(s);this.player=n(i).on("playbackComplete",this.trigger.bind(this,"uiPlayableMediaPlaybackComplete")).on("mute",this.trigger.bind(this,"uiPlayableMediaMute")).on("unmute",this.trigger.bind(this,"uiPlayableMediaUnmute")).on("play",this.trigger.bind(this,"uiPlayableMediaPlay")).on("pause",this.trigger.bind(this,"uiPlayableMediaPause")).on("ready",this.onPlayerReady.bind(this,e))},this.getBorderRadius=function(t){var e=parseInt(t.attr("data-border-top-left-radius")),i=parseInt(t.attr("data-border-top-right-radius")),s=parseInt(t.attr("data-border-bottom-left-radius")),n=parseInt(t.attr("data-border-bottom-right-radius"));return{topLeft:isNaN(e)?void 0:e,topRight:isNaN(i)?void 0:i,bottomLeft:isNaN(s)?void 0:s,bottomRight:isNaN(n)?void 0:n}},this.getPlayerConstructor=function(t){return"undefined"!=typeof this.liveVideoId?this.VideoPlayer.createPlayerForLiveVideo.bind(this,t,this.liveVideoId):"undefined"!=typeof this.dmId?this.VideoPlayer.createPlayerForDm.bind(this,t,this.dmId):this.VideoPlayer.createPlayerForTweet.bind(this,t,this.tweetId)},this.getPromotedContext=function(){if(this.impressionId)return{impressionId:this.impressionId,disclosureType:this.$node.closest("[data-disclosure-type]").attr("data-disclosure-type")}},this.getScribeContext=function(){var t;return"undefined"!=typeof this.tweetId&&(t="tweet"),e.extend({client:"web"},a.scribeContext,{component:this.$node.closest("[data-component-context]").attr("data-component-context")||t})},this.onPlayerReady=function(t){this.playOnInit||t.hasClass("play-on-init")?(this.player.play(),this.muteOnInit&&this.player.mute()):(this.autoplayOnInit||this.$node.closest("[data-autoplaying-media=true]").length>0)&&this.player.playPreview(),this.trigger("uiPlayableMediaReady"),this.liveVideoId&&this.player.updateLayoutBreakpoint({breakpoint:this.getBreakpoint()})},this.pauseMedia=function(){this.player?this.player.pause():(this.autoplayOnInit=!1,this.playOnInit=!1)},this.playMedia=function(){this.player?this.player.play():(this.autoplayOnInit=!1,this.playOnInit=!0)},this.muteMedia=function(){this.muteOnInit=!0,this.player&&this.player.mute()},this.unmuteMedia=function(){this.muteOnInit=!1,this.player&&this.player.unmute()},this.requestDynamicVideoAd=function(){return this.getDynamicVideoAd({id:this.tweetId,promoted_id:this.impressionId})},this.removePlayer=function(){this.$node.removeClass(this.attr.playerLoadedClass),this.player&&(this.player.teardown(),this.player=void 0)},this.before("teardown",function(){this.removePlayer()}),this.teardownIfPresent=function(){0===this.$node.closest("body").length&&this.teardown()},this.updatePosition=function(t,e){!this.player||e.tweetId!==this.tweetId&&e.tweetId!==this.tweetNonce||this.player.updatePosition(e.positionData)},this.updateLayoutBreakpoint=function(t,e){this.liveVideoId&&this.player&&this.player.updateLayoutBreakpoint(e)},this.onPauseAllMedia=function(){this.liveVideoId&&this.attr.liveVideoContinuePlayingBehindModalsEnabled||this.pauseMedia()},this.exitFullScreen=function(){this.liveVideoId&&this.player.exitFullScreen()},this.after("initialize",function(){var t=this.$node.closest("[data-tweet-id]");this.tweetId=t.attr("data-tweet-id"),this.tweetNonce=t.attr("data-tweet-nonce"),this.dmId=this.$node.closest("[data-message-id]").attr("data-message-id"),this.liveVideoId=this.$node.closest("[data-live-video-id]").attr("data-live-video-id"),this.impressionId=this.$node.closest("[data-impression-id]").attr("data-impression-id"),this.attr.autoplayOnHover&&(this.on("mouseenter",this.autoplay),this.on("mouseleave",this.autoplayStop)),this.on("uiLoadPlayableMedia",this.loadMedia),this.on("uiUnloadPlayableMedia",this.removePlayer),this.on("uiUnmuteMedia",this.unmuteMedia),this.on("uiMuteMedia",this.muteMedia),this.on("uiPlayMedia",this.playMedia),this.on("uiPauseMedia",this.pauseMedia),this.on("uiAutoplayMedia",this.autoplay),this.on("uiStopAutoplayingMedia",this.autoplayStop),this.on(document,"uiPauseAllMedia",this.onPauseAllMedia),this.on(document,"uiPlayableMediaPositionChange",this.updatePosition),this.on(document,"uiWatchPlayableMedia uiOverlayClosed",this.teardownIfPresent),this.on(document,"uiLiveVideoBreakpointUpdate",this.updateLayoutBreakpoint),this.on(document,"uiLiveVideoExitFullScreen",this.exitFullScreen)})}var n=i(10),o=i(37),a=i(32),r=i(346),c=i(347),h=i(351);t.exports=n(s,o,r,c)}).call(e,i(1))},function(t,e){"use strict";t.exports=function(){this.matchMedia=function(t){return window.matchMedia&&window.matchMedia(t)},this.getBreakpoint=function(){var t=this.matchMedia("(min-width: 1271px)").matches;if(t)return"wide";var e=this.matchMedia("(min-height: 901px)").matches;return e?"narrow_tall":"narrow_short"}}},function(t,e,i){function s(){n.mixin(this,[o,a]),this.getDynamicVideoAd=function(t){var e=this.adCacheKey({id:t.id,promoted_id:t.promoted_id}),i=this.getDynamicVideoAdFromCache(e);return this.trigger("uiRefreshVideoAdCache",{tweet:t,triggerAd:i}),i||{}}}var n=i(20),o=i(348),a=i(349);t.exports=s},function(t,e){function i(){this.adCacheKey=function(t){var e="t"+t.id;return t.promoted_id&&(e+="i"+t.promoted_id),e}}t.exports=i},function(t,e,i){function s(){this.getDynamicVideoAdFromCache=function(t){return n.get(t)},this.updateDynamicVideoAdCache=function(t){n.update(t)},this.clearDynamicVideoAdCache=function(){n.clear()}}var n=i(350);t.exports=s},function(t,e,i){(function(e){var i={},s={get:function(t){return i[t]},update:function(t){e.extend(i,t)},clear:function(){i={}}};t.exports=s}).call(e,i(1))},function(t,e,i){var s;!function(n,o){s=function(){return n.TwitterVideoPlayer=o()}.call(e,i,e,t),!(void 0!==s&&(t.exports=s))}(this,function(){function t(t){if(t&&t.data&&t.data.params&&t.data.params[0]){var e=t.data.params[0],i=t.data.id;if(e&&e.context&&"TwitterVideoPlayer"===e.context){var s=e.playerId;delete e.playerId,delete e.context;var n=r[s];n&&n.processMessage(t.data.method,e,i)}}}function e(t,e,i){var s=Object.keys(i).filter(function(t){return null!=i[t]}).map(function(t){var e=i[t];return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&");return s&&(s="?"+s),t+e+s}function i(i,n,o,c,h){var l=i.ownerDocument,d=l.defaultView;d.addEventListener("message",t),this.playerId=a++;var u={embed_source:"clientlib",player_id:this.playerId,rpc_init:1};if(this.scribeParams={},this.scribeParams.suppressScribing=c&&c.suppressScribing,!this.scribeParams.suppressScribing){if(!c.scribeContext)throw"video_player: Missing scribe context";if(!c.scribeContext.client)throw"video_player: Scribe context missing client property";this.scribeParams.client=c.scribeContext.client,this.scribeParams.page=c.scribeContext.page,this.scribeParams.section=c.scribeContext.section,this.scribeParams.component=c.scribeContext.component}this.scribeParams.debugScribe=c&&c.scribeContext&&c.scribeContext.debugScribing,this.scribeParams.scribeUrl=c&&c.scribeContext&&c.scribeContext.scribeUrl,this.promotedLogParams=c.promotedContext,this.adRequestCallback=c.adRequestCallback,c.languageCode&&(u.language_code=c.languageCode);var m=e(s,n,u);return this.videoIframe=document.createElement("iframe"),this.videoIframe.setAttribute("src",m),this.videoIframe.setAttribute("allowfullscreen",""),this.videoIframe.setAttribute("id",o),this.videoIframe.setAttribute("style","width: 100%; height: 100%; position: absolute; top: 0; left: 0;"),this.domElement=i,this.domElement.appendChild(this.videoIframe),r[this.playerId]=this,this.eventCallbacks={},this.emitEvent=function(t,e){var i=this.eventCallbacks[t];"undefined"!=typeof i&&i.forEach(function(t){t.apply(this.playerInterface,[e])}.bind(this))},this.jsonRpc=function(t){var e=this.videoIframe.contentWindow;t.jsonrpc="2.0",e&&e.postMessage&&e.postMessage(JSON.stringify(t),"*")},this.jsonRpcCall=function(t,e){this.jsonRpc({method:t,params:e})},this.jsonRpcResult=function(t,e){this.jsonRpc({result:t,id:e})},this.processMessage=function(t,e,i){switch(t){case"requestPlayerConfig":this.jsonRpcResult({scribeParams:this.scribeParams,promotedLogParams:this.promotedLogParams,squareCorners:c.squareCorners,borderRadius:c.borderRadius,hideControls:c.hideControls,embedded:c.addTwitterBranding},i);break;case"videoPlayerAdStart":this.emitEvent("adStart",e);break;case"videoPlayerAdEnd":this.emitEvent("adEnd",e);break;case"videoPlayerPlay":this.emitEvent("play",e);break;case"videoPlayerPause":this.emitEvent("pause",e);break;case"videoPlayerMute":this.emitEvent("mute",e);break;case"videoPlayerUnmute":this.emitEvent("unmute",e);break;case"videoPlayerPlaybackComplete":this.emitEvent("playbackComplete",e);break;case"videoPlayerReady":this.emitEvent("ready",e);break;case"videoView":this.emitEvent("view",e);break;case"debugLoggingEvent":this.emitEvent("logged",e);break;case"requestDynamicAd":"function"==typeof this.adRequestCallback?this.jsonRpcResult(this.adRequestCallback(),i):this.jsonRpcResult({},i)}},this.playerInterface={on:function(t,e){return"undefined"==typeof this.eventCallbacks[t]&&(this.eventCallbacks[t]=[]),this.eventCallbacks[t].push(e),this.playerInterface}.bind(this),off:function(t,e){if("undefined"==typeof e)delete this.eventCallbacks[t];else{var i=this.eventCallbacks[t];if("undefined"!=typeof i){var s=i.indexOf(e);s>-1&&i.splice(s,1)}}return this.playerInterface}.bind(this),play:function(){return this.jsonRpcCall("play"),this.playerInterface}.bind(this),pause:function(){return this.jsonRpcCall("pause"),this.playerInterface}.bind(this),mute:function(){return this.jsonRpcCall("mute"),this.playerInterface}.bind(this),unmute:function(){return this.jsonRpcCall("unmute"),this.playerInterface}.bind(this),playPreview:function(){return this.jsonRpcCall("autoPlayPreview"),this.playerInterface}.bind(this),pausePreview:function(){return this.jsonRpcCall("autoPlayPreviewStop"),this.playerInterface}.bind(this),updatePosition:function(t){return this.jsonRpcCall("updatePosition",[t]),this.playerInterface}.bind(this),updateLayoutBreakpoint:function(t){return this.jsonRpcCall("updateLayoutBreakpoint",[t]),this.playerInterface}.bind(this),enterFullScreen:function(){return this.jsonRpcCall("enterFullScreen"),this.playerInterface}.bind(this),exitFullScreen:function(){return this.jsonRpcCall("exitFullScreen"),this.playerInterface}.bind(this),teardown:function(){this.eventCallbacks={},i.removeChild(this.videoIframe),this.videoIframe=void 0,delete r[this.playerId]}.bind(this)},this.playerInterface}var s="https://twitter.com",n=/^https?:\/\/([a-zA-Z0-9]+\.)*twitter.com(:\d+)?$/,o={suppressScribing:!1,squareCorners:!1,hideControls:!1,addTwitterBranding:!1},a=0,r={};return{setBaseUrl:function(t){n.test(t)?s=t:window.console.error("newBaseUrl "+t+" not allowed")},createPlayerForTweet:function(t,e,s){var n="/i/videos/tweet/"+e,a="player_tweet_"+e;return new i(t,n,a,s||o)},createPlayerForDm:function(t,e,s){var n="/i/videos/dm/"+e,a="player_dm_"+e;return new i(t,n,a,s||o)},createPlayerForLiveVideo:function(t,e,s){var n="/i/videos/live_video/"+e,a="player_live_video_"+e;return new i(t,n,a,s||o)},findPlayerForElement:function(t){for(var e in r)if(r.hasOwnProperty(e)){var i=r[e];if(i&&i.domElement===t)return i.playerInterface}return null}}})},function(t,e,i){(function(e){function s(){this.viewportHelpers=a,this.staticCardsTypes=c,this.defaultAttrs({containerSelector:"body",cardContainerSelector:".tweet",scrollThrottle:100,viewportThreshold:800,fullscreenResetHeight:100,iframeContainerSelector:".js-macaw-cards-iframe-container",unloadedCardsSelector:'.js-macaw-cards-iframe-container[data-watched!="true"]',unloadedCardsFilter:".cards-forward .js-macaw-cards-iframe-container"}),this.shouldUnloadCard=function(t){var e=this.staticCardsTypes.indexOf(t.data("card-name"))!==-1,i=e&&this.shouldNotUnloadStaticCards;return!i},this.watchUnloadedCards=function(){var t=this.$container.find(this.attr.unloadedCardsFilter).filter(function(){return 0===this.children.length});t.attr("data-watched",!0),this.watchedCards=this.watchedCards.concat(t.toArray()),this.throttledProcessWatchedCards()},this.processWatchedCards=function(){if(!this.isInFullscreen()){for(var t,i=0;i<this.watchedCards.length;)t=this.watchedCards[i],a.isWithinBounds(this.$viewport,e(t),this.attr.viewportThreshold)?(this.loadCard(t),this.loadedCards.push(t),this.watchedCards.splice(i,1)):i+=1;for(i=0;i<this.loadedCards.length;)if(t=this.loadedCards[i],a.isWithinBounds(this.$viewport,e(t),this.attr.viewportThreshold))i+=1;else{var s=e(t),n=s.find("iframe").attr("height");n&&s.css("min-height",n+"px"),this.shouldUnloadCard(s)&&(this.unloadCard(t),this.watchedCards.push(t)),this.loadedCards.splice(i,1)}}},this._getCardContainer=function(t){return e(t).closest(this.attr.cardContainerSelector)},this.loadCard=function(t){this.createCard(this._getCardContainer(t)),this.trigger("uiDynamicCardLoaded")},this.unloadCard=function(t){this.destroyCard(this._getCardContainer(t)),this.trigger("uiDynamicCardUnloaded")},this.handleUnloadCards=function(t){t.stopPropagation(),this.destroyAllCards(),this.watchedCards=[],this.loadedCards=[],this.$container.find(this.attr.iframeContainerSelector).removeAttr("data-watched")},this.resetWatchedCards=function(){this.watchedCards=[],this.$container.find(this.attr.iframeContainerSelector).removeAttr("data-watched"),this.watchUnloadedCards()},this.isInFullscreen=function(){return document.webkitFullscreenElement||document.msFullscreenElement||document.fullscreenElement||document.mozFullScreenElement},this.fullScreenChange=function(t){this.isInFullscreen()?(this.bindingTimeout&&(clearTimeout(this.bindingTimeout),this.bindingTimeout=void 0),this.$fullscreenTweet=e(t.target).closest(this.attr.cardContainerSelector),this.off("scroll",this.throttledProcessWatchedCards),this.off(this.$viewport,"resize",this.throttledProcessWatchedCards)):(this.$fullscreenTweet&&1===this.$fullscreenTweet.length&&(window.scrollTo(0,this.$fullscreenTweet.offset().top-this.attr.fullscreenResetHeight),this.$fullscreenTweet=void 0),this.bindingTimeout=setTimeout(function(){this.on("scroll",this.throttledProcessWatchedCards),this.on(this.$viewport,"resize",this.throttledProcessWatchedCards)}.bind(this),1e3))},this.cleanup=function(){this.watchedCards.forEach(this.unloadCard.bind(this)),this.loadedCards.forEach(this.unloadCard.bind(this)),this.$container=null,this.off(document,"uiPageChanged"),this.off("scroll"),this.off(this.$viewport,"resize")},this.before("teardown",function(){this.cleanup()}),this.after("initialize",function(){this.$container=this.node===window?e(this.attr.containerSelector):this.select("containerSelector"),this.$container.length||(this.$container=this.$node),this.watchedCards=[],this.loadedCards=[],this.on(document,"uiPageChanged",this.resetWatchedCards),this.on(this.$container,"uiUnloadAllCards",this.handleUnloadCards),this.throttledProcessWatchedCards=r.throttle(this.processWatchedCards.bind(this),this.attr.scrollThrottle),this.on("scroll",this.throttledProcessWatchedCards),this.$viewport=this.node===document?e(window):this.$node,this.on(this.$viewport,"resize",this.throttledProcessWatchedCards),this.on(document,"uiWatchUnloadedCards",this.watchUnloadedCards),this.on(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",this.fullScreenChange),this.watchUnloadedCards(),this.shouldNotUnloadStaticCards=h.getDecider("should_not_unload_static_cards")})}var n=i(10),o=i(353),a=i(73),r=i(25),c=i(355),h=i(34);t.exports=n(o,s)}).call(e,i(1))},function(t,e,i){(function(e){var s=i(20),n=i(25),o=i(34),a=i(37),r=i(354),c=i(36),h=i(347),l=i(232),d=i(32);t.exports=function(){s.mixin(this,[a,c,h]),this.defaultAttrs({cardWrapperClass:".js-macaw-cards-iframe-container",tweetIdData:"tweet-id",tweetNonceIdData:"tweet-nonce",itemIdData:"item-id",dmIdData:"message-id",advertiserIdData:"advertiser-id",itemType:"tweet",fullCardIframeUrl:"data-full-card-iframe-url",srcAttr:"data-src",cardUrl:"data-card-url",publisherId:"data-publisher-id",creatorId:"data-creator-id",srcDataAttr:"src",cardUrlDataAttr:"card-url",publisherIdDataAttr:"publisher-id",creatorIdDataAttr:"creator-id",cardName:"data-card-name",card2TypeAttr:"card2-type",macawCardsUserStyles:"macaw-cards-user-styles"}),this.DEFAULT_SCRIBE_ELEMENT="platform_card",this.DEFAULT_SCRIBE_COMPONENT="tweet",this.DEFAULT_SCRIBE_ACTION="undefined",this.CARDS_REQUIRING_USER_DEFINED_STYLES=["2586390716:message_me"],this.createCard=function(t){var i,s,a,c=this._getCardWrapper(t),h=this._getUniqueIdForCard(t),l=this._getTweetId(t),u=this._getAdvertiserId(t),m=t.closest("[data-card-component]").attr("data-card-component"),p={element:this.DEFAULT_SCRIBE_ELEMENT,component:m||this.DEFAULT_SCRIBE_COMPONENT},g=n.merge(d.scribeContext,{component:p.component}),f={impressionId:t.data("impression-id"),disclosureType:t.data("disclosure-type")};if(c&&c.length&&c[0].childNodes.length<2&&(!this.channels[h]||c.context&&0===c.context.clientHeight)){s=c.data("src"),e.inArray(this._getCard2Type(t),this.CARDS_REQUIRING_USER_DEFINED_STYLES)>=0&&(s=this._addUserColorToUrl(t,s)),this._isDMCardWithoutText(t)&&(s=this._addNoTextFlagToUrl(s)),s=this._addHeightToUrl(c,s),s=this._addScribeContextToUrl(g,s),i=new r.Rpc({remote:s,container:c[0],props:{height:"0",style:{display:"block"}},onReady:function(){t.trigger("uiCardLoaded")}},{local:a=this.localMethods={localMethodNames:function(){return{callMethodByName:!0,cancelFollowUser:!0,favoriteStatus:!0,followAdvertiser:!0,followUser:!0,logPromotedInfo:!0,logPromotedContentEvent:!0,openBuyNowDialog:!0,openLeadGenConfirmDialog:!0,openAuthWebView:!0,openLink:!0,openLinkNoScribe:!0,openMessageMeDialog:!0,openProfile:!0,requestDynamicAd:!0,requestPlayerConfig:!0,resizeCard:!0,retweetStatus:!0,scribe:!0,shareStatus:!0,statusComposeTweet:!0,unblockUser:!0,unfollowAdvertiser:!0,unfollowUser:!0,videoView:!0,subscribeToEvent:!0,unsubscribeFromEvent:!0}},callMethodByName:function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return a[t].method.apply(this,e)}.bind(this),openBuyNowDialog:function(t){this.trigger("MacawCardOpenBuyNowDialog",{buyNowTweetId:t.tweetId,impressionId:t.impressionId,disclosureType:this._getDisclosureType(t.earned)})}.bind(this),openAuthWebView:function(t){this.trigger("uiOpenAuthWebViewDialog",{impressionId:t.impressionId,webviewUrl:t.webviewUrl,webviewTitle:t.webviewTitle,tweetId:t.tweetId})}.bind(this),openLeadGenConfirmDialog:function(e){e=n.merge(e,f,{tweetId:t.data(this.attr.tweetIdData),cardUrl:c.attr(this.attr.cardUrl),fullCardIframeUrl:c.attr(this.attr.fullCardIframeUrl),publisherId:c.attr(this.attr.publisherId),creatorId:c.attr(this.attr.creatorId)}),this.trigger(document,"uiOpenLeadGenConfirmDialog",e)}.bind(this),openLink:function(t){var e=f;t.hasOwnProperty("cardEvent")&&(e.cardEvent=t.cardEvent),this.trigger("uiCardUrlClick",e),this.scribeCardInteraction("open_link",this._getCardDataWithScribeContext(c,p))}.bind(this),openLinkNoScribe:function(t){var e=f;t.hasOwnProperty("cardEvent")&&(e.cardEvent=t.cardEvent),t.skipEventUiCardUrlClick||this.trigger("uiCardUrlClick",e)}.bind(this),openMessageMeDialog:function(t){this.trigger("uiComposeNewDMWithOptions",{tweetId:t.tweetId,recipientId:t.recipientId,defaultComposerText:t.defaultComposerText,welcomeMessageId:t.welcomeMessageId,messageMeCardData:{cardName:c.attr(this.attr.cardName),cardUri:c.attr(this.attr.cardUrl),userId:o.user.id}})}.bind(this),openProfile:function(t){t=n.merge({userId:t.userId,userScreenName:t.userScreenName,scribeContext:p},this.getCardDataFromContainer(c),f),this.trigger("uiShowProfileNewWindow",t),this.trigger("uiNavigate",{href:"/"+t.userScreenName})}.bind(this),requestDynamicAd:function(){var t=this.getCard2Item(this._getCardDataWithScribeContext(c,p));return this.getDynamicVideoAd(t)}.bind(this),requestPlayerConfig:function(){return{autoPlayPreview:t.find('[data-autoplaying-media="true"]').length>0,autoPlayPreviewPreroll:o.getDecider("autoplayPreviewPreroll"),useVmapVariants:o.getDecider("useVmapVariants")}},resizeCard:function(t){i.iframe.height=parseInt(t.height,10),c.removeClass("initial-card-height")},statusComposeTweet:function(t){t=n.merge(t,{defaultText:t.tweetText,canTweetDefaultText:!0,disclosureType:this._getDisclosureType(t.earned)}),e(document).trigger("uiOpenTweetDialog",t)}.bind(this),retweetStatus:function(e){this._triggerTweetAction(t,"uiOpenRetweetDialog",{id:e.tweetId||l,tweetId:e.tweetId||l})}.bind(this),favoriteStatus:function(e){this._triggerTweetAction(t,"uiDidFavoriteTweet",{id:e.tweetId||l})}.bind(this),shareStatus:function(e){this._triggerTweetAction(t,"uiNeedsShareViaEmailDialog",{id:e.tweetId||l})}.bind(this),followAdvertiser:function(e){u&&this._triggerTweetAction(t,"uiFollowAction",{userId:u})}.bind(this),unfollowAdvertiser:function(e){u&&this._triggerTweetAction(t,"uiFollowAction",{userId:u})}.bind(this),scribe:function(t){var e,i=this.DEFAULT_SCRIBE_ELEMENT,s=this.DEFAULT_SCRIBE_ACTION;t.hasOwnProperty("customScribe")&&(t.customScribe.hasOwnProperty("element")&&(i=t.customScribe.element),t.customScribe.hasOwnProperty("action")&&(s=t.customScribe.action),t.customScribe.hasOwnProperty("itemData")&&(e=t.customScribe.itemData),this.scribeCardInteraction(s,this._getCardDataWithScribeContext(c,p),i,e))}.bind(this),logPromotedInfo:function(t){this.trigger(document,"uiMacawCardClicked",{event:t.event,impressionId:t.impressionId,earned:t.earned,sync:t.sync})}.bind(this),logPromotedContentEvent:function(i){this._triggerTweetAction(t,"uiPlayableMediaEvent",e.extend(this.interactionData(t,i),i));
}.bind(this),followUser:function(e){e.userId&&this._triggerTweetAction(t,"uiFollowAction",{userId:e.userId})}.bind(this),unfollowUser:function(e){e.userId&&this._triggerTweetAction(t,"uiUnfollowAction",{userId:e.userId})}.bind(this),unblockUser:function(e){e.userId&&this._triggerTweetAction(t,"uiUnblockAction",{userId:e.userId})}.bind(this),cancelFollowUser:function(e){e.userId&&this._triggerTweetAction(t,"uiCancelFollowRequestAction",{userId:e.userId})}.bind(this),subscribeToEvent:function(t){t&&t.subscribeTo&&(h in this.activeSubscriptions?this.activeSubscriptions[h].push(t.subscribeTo):this.activeSubscriptions[h]=[t.subscribeTo],this._addSubscription(h,t.subscribeTo))}.bind(this),unsubscribeFromEvent:function(t){t&&t.unsubscribeFrom&&this._removeSubscription(h,t.unsubscribeFrom)}.bind(this)},remote:{localMethodNames:{},callVideoPlayerMethod:{},transmitEvent:{}}}),e(i.iframe).attr("allowfullscreen",""),this.channels[h]=i;var v=t.data(this.attr.dmIdData);if(v&&t.is(":visible")){var S=this.getCard2Item(this.getCardDataFromContainer(c));this.trigger("uiNewDMCardLoaded",{cardItem:S})}}return f},this.destroyCard=function(t){var e=this._getUniqueIdForCard(t);if(this.channels[e]){this.channels[e].destroy(),delete this.channels[e];var i=this.activeSubscriptions[e];delete this.activeSubscriptions[e];for(var s in i)this._subscriptionExistsFor(event)||this.off(document,s)}},this.destroyAllCards=function(){var t=this.channels;Object.keys(this.channels).forEach(function(e){t[e].destroy()}),this.channels={}},this.handleStreamItemRemoval=function(t){var i=t.target;i&&e(i).find(".tweet").each(function(t,i){this.destroyCard(e(i))}.bind(this))},this._getCardWrapper=function(t){return t.find(this.attr.cardWrapperClass)},this._getTweetId=function(t){return t.data(this.attr.tweetIdData)},this._getUniqueIdForCard=function(t){return t.data(this.attr.tweetNonceIdData)||t.data(this.attr.tweetIdData)||t.data(this.attr.dmIdData)},this._getAdvertiserId=function(t){return t.data(this.attr.advertiserIdData)},this._getUserColor=function(t){var i=e("<a/>").css("display","none").appendTo(t),s=i.css("color");return i.remove(),s},this._getCard2Type=function(t){return t.data(this.attr.card2TypeAttr)},this._addUserColorToUrl=function(t,e){var i=this._getUserColor(t);return i?l.addToUrl(e,{user_color:i}):e},this._addScribeContextToUrl=function(t,e){return t?l.addToUrl(e,{scribe_context:JSON.stringify(t)}):e},this._isDMCardWithoutText=function(t){return t.hasClass("DirectMessage")&&t.data("no-text")},this._addNoTextFlagToUrl=function(t){return l.addToUrl(t,{dm_no_text:!0})},this._addHeightToUrl=function(t,e){var i=t.height();return i?l.addToUrl(e,{card_height:i}):e},this._getCardDataWithScribeContext=function(t,e){return n.merge(this.getCardDataFromContainer(t),{scribeContext:e})},this._getDisclosureType=function(t){return t===!0?"earned":"_"},this._triggerTweetAction=function(t,e,i){t.trigger(e,i)},this._addSubscription=function(t,e){this.on(document,e,function(i,s){var n=this.channels[t];n&&this.activeSubscriptions[t]&&this.activeSubscriptions[t].indexOf(e)>-1&&n.transmitEvent(e,{type:i.type,timestamp:i.timeStamp,data:i.data},s)}.bind(this))},this._removeSubscription=function(t,e){var i=this.activeSubscriptions[t];if(this.channels[t]&&Array.isArray(i)){var s=i.indexOf(e);s>-1&&(i.splice(s,1),i.length>0?this.activeSubscriptions[t]=i:delete this.activeSubscriptions[t],this._subscriptionExistsFor(e)||this.off(document,e))}},this._getAllSubscriptions=function(){return Object.keys(this.activeSubscriptions).map(function(t){return this.activeSubscriptions[t]},this).filter(function(t){return!!t})},this._subscriptionExistsFor=function(t){return this._getAllSubscriptions().map(function(t){return t.subscribedTo}).some(function(e){return e.subscribedTo.indexOf(t)>-1})},this.autoplayMedia=function(t){var i=this._getUniqueIdForCard(e(t.target).closest(".tweet[data-tweet-id]")),s=this.channels[i];s&&s.callVideoPlayerMethod("autoPlayPreview")},this.loadVideoCards=function(t,e){e&&e.tweets&&e.tweets.forEach(function(t){var e=this.$node.find(".tweet[data-tweet-id="+t.tweetId+"]");e.find('[data-card-name=__entity_video][data-has-autoplayable-media="true"]:empty').length&&this.createCard(e)}.bind(this))},this.stopAutoplayingMedia=function(t,i){var s=this._getUniqueIdForCard(e(t.target).closest(".tweet[data-tweet-id]")),n=this.channels[s];n&&n.callVideoPlayerMethod("autoPlayPreviewStop")},this.pauseMedia=function(t){var i=this._getUniqueIdForCard(e(t.target).closest(".tweet[data-tweet-id]")),s=this.channels[i];s&&(s.callVideoPlayerMethod("pause"),s.callVideoPlayerMethod("autoPlayPreviewStop"))},this.pauseAllMedia=function(t,e){var i=this.channels;Object.keys(i).forEach(function(t){i[t].callVideoPlayerMethod("pause"),i[t].callVideoPlayerMethod("autoPlayPreviewStop")})},this.updatePosition=function(t,e){var i=e&&e.tweetId&&this.channels[e.tweetId];i&&i.callVideoPlayerMethod("updatePosition",e.positionData)},this.after("initialize",function(){this.channels={},this.activeSubscriptions={},this.before("teardown",this.destroyAllCards),this.on(document,"uiAutoplayMedia",this.autoplayMedia),this.on(document,"uiStopAutoplayingMedia",this.stopAutoplayingMedia),this.on(document,"uiPauseAllMedia",this.pauseAllMedia),this.on(document,"uiPauseMedia",this.pauseMedia),this.on(document,"uiPlayableMediaPositionChange",this.updatePosition),this.on(document,"uiHasInjectedNewTimeline uiHasInjectedOldTimelineItems uiHasInjectedRangeTimelineItems",this.loadVideoCards),this.on(document,"uiWillRemoveStreamItem",this.handleStreamItemRemoval)})}}).call(e,i(1))},function(t,e,i){/*!
	 * xdm.js – Nicolas Gallagher – MIT License
	 * easyXDM – Copyright(c) 2009-2011, Øyvind Sean Kinsey, oyvind@kinsey.no – MIT License
	 */
!function(e){"use strict";function i(t){return"[object Array]"===Object.prototype.toString.call(t)}function s(t){return"undefined"==typeof t}function n(t){if(!t)throw new Error("url is undefined or empty");if(/^file/.test(t))throw new Error("The file:// protocol is not supported");var e=t.toLowerCase().match(b);if(e){var i=e[2],s=e[3],n=e[4]||"";return("http:"===i&&":80"===n||"https:"===i&&":443"===n)&&(n=""),i+"//"+s+n}return t}function o(t){if(!t)throw new Error("url is undefined or empty");if(t=t.replace(y,"$1/"),!t.match(/^(http||https):\/\//)){var e="/"===t.substring(0,1)?"":location.pathname;"/"!==e.substring(e.length-1)&&(e=e.substring(0,e.lastIndexOf("/")+1)),t=location.protocol+"//"+location.host+e+t}for(;C.test(t);)t=t.replace(C,"");return t}function a(t,e,i){var s;for(var n in e)e.hasOwnProperty(n)&&(n in t?(s=e[n],"object"==typeof s?a(t[n],s,i):i||(t[n]=e[n])):t[n]=e[n]);return t}function r(t,e){"string"==typeof t&&(t=[t]);for(var i,s=t.length;s--;)if(i=t[s],i=new RegExp("^"===i.substr(0,1)?i:"^"+i.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),i.test(e))return!0;return!1}function c(t,e){if(!e)throw new Error("parameters is undefined or null");var i=t.indexOf("#"),s=[];for(var n in e)e.hasOwnProperty(n)&&s.push(n+"="+encodeURIComponent(e[n]));return t+(i===-1?"#":"&")+s.join("&")}function h(t){var e=v.cloneNode(!1);if(a(t.props,{frameBorder:0,allowTransparency:!0,scrolling:"no",width:"100%",src:c(t.remote,{xdm_e:n(location.href),xdm_c:t.channel,xdm_p:1}),name:f+t.channel+"_provider",style:{margin:0,padding:0,border:0}}),e.id=t.props.name,delete t.props.name,!t.container)throw new Error('xdm.Rpc() configuration object missing a DOM "container" property');return a(e,t.props),t.container.appendChild(e),t.onLoad&&T(e,"load",t.onLoad),t.html&&(e.contentWindow.document.open(),e.contentWindow.document.write(t.html),e.contentWindow.document.close()),t.iframe=e,e}function l(t){var e;if(t.isHost=t.isHost||s(I.xdm_p),t.props=t.props||{},t.isHost)t.remote=o(t.remote),t.channel=t.channel||"default"+S++;else if(t.channel=I.xdm_c.replace(/["'<>\\]/g,""),t.remote=I.xdm_e.replace(/["'<>\\]/g,""),t.acl&&!r(t.acl,t.remote))throw new Error("Access denied for "+t.remote);return e=[new p.stack.PostMessageTransport(t)],e.push(new p.stack.QueueBehavior((!0))),e}function d(t){var e,i,s=t.length,n={incoming:function(t,e){this.up.incoming(t,e)},outgoing:function(t,e){this.down.outgoing(t,e)},callback:function(t){this.up.callback(t)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(i=0;i<s;i++)e=t[i],a(e,n,!0),0!==i&&(e.down=t[i-1]),i!==s-1&&(e.up=t[i+1]);return e}function u(t){t.up.down=t.down,t.down.up=t.up,t.up=t.down=null}if(e.postMessage){var m="",p={},g=e.xdm,f="xdm_",v=document.createElement("IFRAME"),S=Math.floor(1e4*Math.random()),w=Function.prototype,b=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,C=/[\-\w]+\/\.\.\//,y=/([^:])\/\//g,T=function(){return e.addEventListener?function(t,e,i){t.addEventListener(e,i,!1)}:function(t,e,i){t.attachEvent("on"+e,i)}}(),D=function(){return e.removeEventListener?function(t,e,i){t.removeEventListener(e,i,!1)}:function(t,e,i){t.detachEvent("on"+e,i)}}(),I=function(t){t=t.substring(1,t.length).split("&");for(var e,i={},s=t.length;s--;)e=t[s].split("="),i[e[0]]=decodeURIComponent(e[1]);return i}(location.hash);p.version="1.0.1",p.stack={},p.query=I,p.checkAcl=r,p.noConflict=function(t){return e.xdm=g,m=t,m&&(f="xdm_"+m.replace(".","_")+"_"),p},p.Rpc=function(t,e){var i;if(e.local)for(var s in e.local)e.local.hasOwnProperty(s)&&(i=e.local[s],i instanceof Function&&(e.local[s]={method:i}));var o=d(l(t).concat([new p.stack.RpcBehavior(this,e),{callback:function(e){t.onReady&&t.onReady(e)}}]));this.origin=n(t.remote),this.destroy=function(){o.destroy()},o.init(),this.iframe=t.iframe},p.stack.PostMessageTransport=function(t){function i(e){var i=n(e.origin),s="string"==typeof e.data;i===c&&s&&e.data.substring(0,t.channel.length+1)===t.channel+" "&&o.up.incoming(e.data.substring(t.channel.length+1),i)}function s(n){n.data===t.channel+"-ready"&&(r="postMessage"in a.contentWindow?a.contentWindow:a.contentWindow.document,D(e,"message",s),T(e,"message",i),setTimeout(function(){o.up.callback(!0)},0))}var o,a,r,c;return o={outgoing:function(e,i,s){r.postMessage(t.channel+" "+e,i||c),s&&s()},destroy:function(){D(e,"message",s),D(e,"message",i),a&&(r=null,a.parentNode.removeChild(a),a=null)},init:function(){c=n(t.remote),t.isHost?(T(e,"message",s),a=h(t)):(T(e,"message",i),r="postMessage"in e.parent?e.parent:e.parent.document,r.postMessage(t.channel+"-ready",c),setTimeout(function(){o.up.callback(!0)},0))}}},p.stack.QueueBehavior=function(t){function e(){var a;return t===!0&&0===n.length?void u(i):void(o||0===n.length||s||(o=!0,a=n.shift(),i.down.outgoing(a.data,a.origin,function(t){o=!1,a.callback&&setTimeout(function(){a.callback(t)},0),e()})))}var i,s,n=[],o=!0;return i={init:function(){i.down.init()},callback:function(t){o=!1;var s=i.up;e(),s.callback(t)},incoming:function(t,e){i.up.incoming(t,e)},outgoing:function(t,i,s){n.push({data:t,origin:i,callback:s}),e()},destroy:function(){s=!0,i.down.destroy()}}},p.stack.RpcBehavior=function(t,e){function n(t){t.jsonrpc="2.0",r.down.outgoing(JSON.stringify(t))}function o(t,e){var i=Array.prototype.slice;return function(){var s,o=arguments.length,a={method:e};o>0&&arguments[o-1]instanceof Function?(o>1&&arguments[o-2]instanceof Function?(s={success:arguments[o-2],error:arguments[o-1]},a.params=i.call(arguments,0,o-2)):(s={success:arguments[o-1]},a.params=i.call(arguments,0,o-1)),h[""+ ++c]=s,a.id=c):a.params=i.call(arguments,0),t.namedParams&&1===a.params.length&&(a.params=a.params[0]),n(a)}}function a(t,e,o,a){if(!o)return void(e&&n({id:e,error:{code:-32601,message:"Procedure not found."}}));var r,c;e?(r=function(t){r=w,n({id:e,result:t})},c=function(t,i){c=w;var s={id:e,error:{code:-32099,message:t}};i&&(s.error.data=i),n(s)}):r=c=w,i(a)||(a=[a]);try{var h=o.method.apply(o.scope,a.concat([r,c]));s(h)||r(h)}catch(l){c(l.message)}}var r,c=0,h={};return r={incoming:function(t,i){var s,o=JSON.parse(t);o.method?e.handle?e.handle(o,n):a(o.method,o.id,e.local[o.method],o.params):(s=h[o.id],o.error&&s.error?s.error(o.error):s.success&&s.success(o.result),delete h[o.id])},init:function(){if(e.remote)for(var i in e.remote)e.remote.hasOwnProperty(i)&&(t[i]=o(e.remote[i],i));r.down.init()},destroy:function(){for(var i in e.remote)e.remote.hasOwnProperty(i)&&t.hasOwnProperty(i)&&delete t[i];r.down.destroy()}}},t.exports=p}}(window)},function(t,e){var i=["2586390716:authenticated_web_view","2586390716:buy_now","3260518932:moment","3691233323:periscope_broadcast","app","direct_store_link_app","poll2choice_image","poll3choice_image","poll4choice_image","poll2choice_text_only","poll3choice_text_only","poll4choice_text_only","promo_website","summary","summary_large_image"];t.exports=i},function(t,e,i){(function(e){function s(){this.attributes({quickReplySelector:".DMQuickReply",optionSelector:".DMQuickReply-optionItem",unSelectedOptionSelector:".DMQuickReply:not(.is-selected) .DMQuickReply-optionItem",optionTextSelector:".DMQuickReply-optionText",selectedClass:"is-selected"}),this.handleClick=function(t){var i=e(t.target),s=i.closest(this.attr.quickReplySelector),n=i.closest(this.attr.optionSelector),o=i.closest(this.attr.optionTextSelector),a=n.data();s.addClass(this.attr.selectedClass),o.addClass(this.attr.selectedClass),this.trigger("uiQROptionClicked",a)},this.handleShowQRPanel=function(t,e){var i=o["dm/dm_quick_reply"].render(e);this.$node.html(i)},this.handleEmptyQRPanel=function(){this.$node.empty()},this.after("initialize",function(){this.on(document,"uiShowQuickReplyOptionPanel",this.handleShowQRPanel),this.on(document,"uiQuickReplyRemoved",this.handleEmptyQRPanel),this.on("click",{unSelectedOptionSelector:this.handleClick})})}var n=i(10),o=i(107),a=n(s);t.exports=a}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.attributes({checkSelector:".DMReadReceipt-check",statusSelector:".DMReadReceipt-statusView",readRecieptSelector:".DMReadReceipt",seenClass:"is-seen",seenAnimatedClass:"is-seenAnimated",receiptExpandedClass:"is-expanded",userListContainerSelector:".DMReadReceiptUserList",userListExpandedSelector:".DMReadReceiptUserList-expanded",userListTruncatedSelector:".DMReadReceiptUserList-truncated",userListExpandSeenSelector:".DMReadReceiptUserList-expandSeen",seenByAllClass:"is-seenByAll",userListExpandedClass:"is-expanded",conversationContentSelector:".DMConversation-content",sentMessageSelector:".DirectMessage--sent:not(.is-rapidFire)",othersTemplate:"dm/read_receipt_x_others",seenTextTemplate:"dm/read_receipt_seen_text"}),this.resetState=function(t){this.conversationId=t.conversation_id,this.isOtoConversation=t.is_oto,this.participants=t.participants&&t.participants.filter(function(t){return t.id_str!==c.user.id})},this.localizeUserList=function(t,e){var i=e?t.slice(0,10):t,s=t.length-i.length;if(s>0){var n={user_count:s};n["user_count_"+o.PluralRules.rule_for(s)]=!0;var a=r[this.attr.othersTemplate].render(n);i.push(a)}var c=new o.ListFormatter;return c.format(i)},this.getSeenByData=function(t,e){var i=t.filter(function(t){var i=t.join_conversation_event_id;return!i||1!==n.compare(i,e)}),s=i.filter(function(t){return t.last_read_event_id&&1!==n.compare(e,t.last_read_event_id)});return{seenByAll:s.length===i.length,seenByUsers:s}},this.setMessageToSeenState=function(t){var e=this.isOtoConversation?"Visto":"Visto por todos";t.find(this.attr.statusSelector).text(e),t.find(this.attr.checkSelector).addClass(this.attr.seenClass),t.find(this.attr.userListContainerSelector).addClass(this.attr.seenByAllClass)},this.setMessageToCollapsedState=function(t){t.data("has-expanded-read-receipt",!1),t.find(this.attr.readRecieptSelector).removeClass(this.attr.receiptExpandedClass),t.find(this.attr.userListContainerSelector).addClass("u-hidden")},this.setMessageToExpandedState=function(t){this.select("sentMessageSelector").each(function(i,s){var n=e(s),o=n.data("message-id")===t.data("message-id"),a=this.isMessageExpanded(n);!o&&a&&this.setMessageToCollapsedState(n)}.bind(this)),t.data("has-expanded-read-receipt",!0),t.find(this.attr.readRecieptSelector).addClass(this.attr.receiptExpandedClass),t.find(this.attr.userListContainerSelector).removeClass("u-hidden")},this.populateDetails=function(t,e){var i=e.seenByUsers;if(e.seenByAll)this.setMessageToSeenState(t);else if(!this.isOtoConversation&&i.length>0){var s={user_count:i.length};s["user_count_"+o.PluralRules.rule_for(i.length)]=!0;var n=r[this.attr.seenTextTemplate].render(s);t.find(this.attr.statusSelector).text(n);var a=i.map(function(t){return t.name}),c=this.localizeUserList(a,!0),h=this.localizeUserList(a,!1);t.find(this.attr.userListTruncatedSelector).html(c,!0),t.find(this.attr.userListExpandedSelector).html(h,!1)}},this.handleConversationUpdate=function(t,i){if(this.resetState(i),this.participants){var s=this.$content.find(this.attr.sentMessageSelector);s.each(function(t,i){var s=e(i),n=s.data("message-id"),o=this.getSeenByData(this.participants,n);if(o.seenByAll){var a=s.find(this.attr.checkSelector),r=s.data("is-read-receipt-set"),c=r?this.attr.seenAnimatedClass:this.attr.seenClass;a.addClass(c)}this.isMessageExpanded(s)&&this.populateDetails(s,o),s.data("is-read-receipt-set",!0)}.bind(this))}},this.isMessageExpanded=function(t){return t.data("has-expanded-read-receipt")===!0},this.expandReadReceipt=function(t){if(this.participants){var e=t.data("message-id"),i=this.getSeenByData(this.participants,e);this.populateDetails(t,i),this.setMessageToExpandedState(t)}},this.handleReadReceiptClick=function(t,i){var s=e(t.target).closest(this.attr.sentMessageSelector);this.isMessageExpanded(s)?this.setMessageToCollapsedState(s):this.expandReadReceipt(s)},this.expandSeenList=function(t,i){var s=e(t.target).closest(this.attr.sentMessageSelector);s.find(this.attr.userListContainerSelector).addClass(this.attr.userListExpandedClass)},this.after("initialize",function(){this.$content=this.select("conversationContentSelector"),this.on("uiDMConversationUpdated",this.handleConversationUpdate),this.on("click",{readRecieptSelector:this.handleReadReceiptClick,userListExpandSeenSelector:this.expandSeenList})})}var n=i(242),o=i(343),a=i(10),r=i(107),c=i(34);i(22);t.exports=a(s)}).call(e,i(1))},function(t,e,i){function s(){this.attributes({dialogContentSelector:".DMViewParticipants-content",doneButtonSelector:".DMViewParticipants-done",spinnerSelector:".DMViewParticipants-spinner"}),this.prepareViewParticipants=function(){this.select("dialogContentSelector").hide(),this.select("spinnerSelector").show()},this.updateViewParticipants=function(t,e){t&&t.preventDefault(),this.select("dialogContentSelector").html(e.html).show(),this.select("spinnerSelector").hide(),this.trigger("uiDMDialogOpenedViewParticipants")},this.after("initialize",function(){this.on("uiViewParticipants",this.prepareViewParticipants),this.on("dataConversationParticipantsResult",this.updateViewParticipants),this.on("click",{doneButtonSelector:"uiDMViewParticipantsDone"})})}var n=i(10);t.exports=n(s)},function(t,e,i){(function(e){function s(){this.attributes({avatarSelector:".DMTypingIndicator-avatar",avatarsContainerSelector:".DMTypingIndicator-avatarsContainer",containerSelector:".DMConversation-typingIndicator",messageBubbleSelector:".TypingIndicatorMessageBubble",overflowAvatarSelector:".DMTypingIndicator-avatar.is-overflowAvatar",overflowAvatarClass:"is-overflowAvatar",overflowCountSelector:".DMTypingIndicator-overflowCount",typingIndicatorSelector:".DMTypingIndicator",showHideDuration:300,avatarTemplate:"dm/dm_typing_indicator_avatar",overflowTemplate:"dm/dm_typing_indicator_overflow_count",avatarDisplayDuration:4e3,maxNumAvatars:5}),this.reset=function(t,e){this.$container.addClass("u-hidden").css({height:""}),this.$avatarsContainerSelector.empty(),this.$messageBubble.addClass("is-hidden"),this.activeAvatarList().forEach(function(t){clearTimeout(t.timer)}),this.activeAvatars={}},this.show=function(){this.$container.stop().clearQueue().css({height:""}).removeClass("u-hidden"),this.$messageBubble.removeClass("is-hidden"),this.trigger("uiDMTypingIndicatorShown")},this.hideAnimation=function(){return this.$messageBubble.addClass("is-hidden"),this.$container.delay(250).animate({height:0},this.attr.showHideDuration).promise()},this.hide=function(t){var i=t?this.hideAnimation():e.Deferred().resolve().promise();i.then(function(){this.activeAvatarList().length?this.show():(this.$avatarsContainerSelector.empty(),this.$container.addClass("u-hidden"))}.bind(this))},this.updateOverflow=function(){var t=this.activeAvatarList().length,i=e(o[this.attr.overflowTemplate].render({count:t-this.attr.maxNumAvatars+1},o));this.$avatarsContainerSelector.find(this.attr.overflowCountSelector).remove();var s=t-this.attr.maxNumAvatars>0;s&&this.$avatarsContainerSelector.append(i);var n=this.select("avatarSelector").not(".is-hidden").not(this.attr.overflowAvatarSelector);n.css("visibility","");var a=this.attr.maxNumAvatars-n.length;if(a>0){var r=this.select("overflowAvatarSelector").slice(0,a);r.removeClass(this.attr.overflowAvatarClass),s&&r.last().css("visibility","hidden")}},this.addAvatar=function(t){var i=this.profileImageData[t].image_url,s=this.profileImageData[t].name;if(i){var n=e(o[this.attr.avatarTemplate].render({alt:s,image_count:1,images:[{src:i}],overflow:this.activeAvatarList().length>=this.attr.maxNumAvatars},o)),a=!this.activeAvatarList().length;a&&this.$avatarsContainerSelector.empty(),this.$avatarsContainerSelector.append(n),this.activeAvatars[t]={timer:this.setRemoveTimeout(t),node:n},this.updateOverflow(),this.$container.hasClass("u-hidden")&&this.show()}},this.setRemoveTimeout=function(t){return setTimeout(this.removeAvatar.bind(this,t,!0),this.attr.avatarDisplayDuration)},this.refreshTimer=function(t){var e=this.activeAvatars[t];e&&(clearTimeout(e.timer),e.timer=this.setRemoveTimeout(t))},this.isEventForCurrentConvo=function(t,e){return this.conversationId&&this.conversationId===e.conversation_id},this.removeAvatar=function(t,e){var i=this.activeAvatars[t];if(i){clearTimeout(i.timer);var s=1===this.activeAvatarList().length;!s&&i.node.addClass("is-hidden"),delete this.activeAvatars[t],this.updateOverflow(),s&&this.hide(e)}},this.activeAvatarList=function(){return Object.keys(this.activeAvatars)},this.handleUserUpdate=function(t,e){if(!e.should_request_inbox&&!e.is_empty){var i=(e.conversations||[]).filter(function(t){return t.conversation_id===this.conversationId}.bind(this))[0];i&&!i.is_empty&&(this.avatarsToClear.forEach(function(t){this.removeAvatar(t,!1)}.bind(this)),this.avatarsToClear=[])}},this.handleConversationUpdate=function(t,e){e.conversation_id!==this.conversationId&&(this.reset(),this.conversationId=e.conversation_id);var i=e.participants||[];this.profileImageData=i.reduce(function(t,e){return t[e.id]={image_url:e.profile_image_url,name:e.name},t},{})},this.handleUpdateEvent=function(t,e){e.user_id&&this.avatarsToClear.push(e.user_id)},this.handleTypingEvent=function(t,e){var i=e.user_id;if(a.user.id!==i){var s=this.activeAvatars[i];s?this.refreshTimer(i):this.addAvatar(i)}},this.after("addAvatar",function(){this.trigger("uiDMTypingIndicatorAvatarAdded",{num_avatars:this.activeAvatarList().length})}),this.after("refreshTimer",function(){this.trigger("uiDMTypingIndicatorAvatarRefreshed",{num_avatars:this.activeAvatarList().length})}),this.after("initialize",function(){this.activeAvatars={},this.profileImageData={},this.avatarsToClear=[],this.$container=this.select("containerSelector"),this.$avatarsContainerSelector=this.select("avatarsContainerSelector"),this.$messageBubble=this.select("messageBubbleSelector"),this.on(document,"dataDMUserUpdates",this.handleUserUpdate),this.on(document,"uiDMConversationUpdated",this.handleConversationUpdate),this.on(document,"dataDMTyping",r(this.handleTypingEvent,this.isEventForCurrentConvo)),this.on(document,"dataDMUpdate",r(this.handleUpdateEvent,this.isEventForCurrentConvo))})}var n=i(10),o=i(107),a=i(34),r=i(243);t.exports=n(s)}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({noShowError:!0}),this.conversation=function(t,e){e=e||{},this.get({url:"/messages/with/conversation",data:{id:e.conversation_id,max_entry_id:e.max_entry_id},eventData:e,success:r(t.target,"dataDMConversationResult"),error:c(r(t.target,"dataDMInvalidConversation",e),r(t.target,"dataDMError"))})},this.after("initialize",function(){this.on("uiNeedsDMConversation",this.conversation)})}var n=i(10),o=i(237),a=i(225),r=o.triggerFn,c=o.chain;t.exports=n(s,a)},function(t,e,i){function s(){this.defaultAttrs({noShowError:!0}),this.addWelcomeMessage=function(t,e){if(e=e||{},!e.has_tweet_attachment&&e.is_oto!==!1){var i={};"undefined"!=typeof e.welcome_message_id&&(i.welcome_message_id=e.welcome_message_id),this.post({url:"/messages/add_welcome_message_to_conversation/"+e.conversation_id,data:i,eventData:e,success:r(t.target,"dataDMConversationResult")})}},this.after("initialize",function(){this.on("uiRenderConversationView",this.addWelcomeMessage)})}var n=i(10),o=i(237),a=i(225),r=o.triggerFn;t.exports=n(s,a)},function(t,e,i){function s(){this.defaultAttrs({noShowError:!0}),this.deleteConversation=function(t,e){e=e||{};var i=h(c(t.target,"dataConversationDeleted",{conversation_id:e.conversation_id}),c(t.target,"dataDMUserUpdates")),s=h(c(t.target,"dataConversationDeleteFailed",{conversation_id:e.conversation_id}),c(t.target,"dataDMError"));this.destroy({url:"/messages/with/conversation",data:{id:e.conversation_id,cursor:this.dmCursor},eventData:e,success:i,error:s})},this.after("initialize",function(){this.on("uiDeleteConversation",this.deleteConversation)})}var n=i(10),o=i(225),a=i(363),r=i(237),c=r.triggerFn,h=r.chain,l=n(s,o,a);t.exports=l},function(t,e){function i(){this.storeDmCursor=function(t,e){e&&e.cursor&&(this.dmCursor=e.cursor,this.trigger("dataDMCursorUpdated",{cursor:this.dmCursor}))},this.storeDmCursorFromUpdates=function(t,e){e&&e.inbox_updates&&e.inbox_updates.cursor&&(this.dmCursor=e.inbox_updates.cursor,this.trigger("dataDMCursorUpdated",{cursor:this.dmCursor}))},this.after("initialize",function(){this.on(document,"dataDMCursor",this.storeDmCursor),this.on(document,"dataDMUserUpdates",this.storeDmCursorFromUpdates)})}t.exports=i},function(t,e,i){function s(){this.defaultAttrs({noShowError:!0}),this.deleteMessage=function(t,e){e=e||{},this.post({url:"/i/direct_messages/destroy",eventData:e,data:{id:e.id,conversation_id:e.conversation_id,cursor:this.dmCursor},success:c(t.target,["dataDMDeleteSuccess","dataDMUserUpdates"]),error:h(c(t.target,"dataDMDeleteFailed",e),c(t.target,"dataDMError"))})},this.after("initialize",function(){this.on("uiDMDialogDeleteMessage",this.deleteMessage)})}var n=i(10),o=i(237),a=i(225),r=i(363),c=o.triggerFn,h=o.chain;t.exports=n(s,a,r)},function(t,e,i){function s(){this.attributes({darkTraffic:!1}),this.processDMTypingEvent=function(t){!this.attr.darkTraffic&&this.trigger("dataDMTyping",t)},this.processDMUpdate=function(t){!this.attr.darkTraffic&&this.trigger("dataDMUpdate",t)},this.processLPMessage=function(t,e){e.payload.dm_typing?this.processDMTypingEvent(e.payload.dm_typing):e.payload.dm_update&&this.processDMUpdate(e.payload.dm_update)},this.updateSubscriptions=function(t,e){if(e&&t){var i="subscribe"===t?"dataLPSubscribe":"dataLPUnsubscribe";this.trigger(i,{consumer_id:this.consumerId,topic:this.getTopicsForConversation(e)})}},this.handleConversationUpdate=function(t,e){e.conversation_id!==this.conversationId&&this.updateSubscriptions("unsubscribe",this.conversationId),this.updateSubscriptions("subscribe",e.conversation_id),this.conversationId=e.conversation_id},this.handleConversationViewChange=function(t){var e="uiDMConversationActivityHidden"===t.type?"unsubscribe":"subscribe";this.updateSubscriptions(e,this.conversationId)},this.getTopicsForConversation=function(t){return["/dm_typing/"+t,"/dm_update/"+t]},this.after("initialize",function(){this.consumerId=parseInt(Math.random()*Number.MAX_SAFE_INTEGER,10),this.on("dataLPMessage",this.processLPMessage),this.on("uiDMConversationUpdated",this.handleConversationUpdate),this.on("uiDMConversationActivityHidden uiDMConversationActivityVisible",this.handleConversationViewChange)})}var n=i(10);t.exports=n(s)},function(t,e,i){function s(){this.defaultAttrs({noShowError:!0}),this.reportConversation=function(t,e){e=e||{};var i=h(c(t.target,"dataDMUserUpdates"),c(t.target,"dataConversationReported",{conversation_id:e.conversation_id})),s=h(c(t.target,"dataDMError"),c(t.target,"dataConversationReportFailed",{conversation_id:e.conversation_id}));this.post({url:"/i/direct_messages/report_conversation",data:{conversation_id:e.conversation_id,report_as:e.report_as,cursor:this.dmCursor},success:i,error:s})},this.after("initialize",function(){this.on("uiReportConversation",this.reportConversation)})}var n=i(10),o=i(225),a=i(363),r=i(237),c=r.triggerFn,h=r.chain,l=n(s,o,a);t.exports=l},function(t,e,i){function s(){this.defaultAttrs({noShowError:!0}),this.reportMessage=function(t,e){e=e||{},this.post({url:"/i/direct_messages/report",data:{id:e.id,conversation_id:e.conversation_id,report_as:e.report_as},eventData:e,success:r(t.target,["dataDMReportSuccess","dataDMConversationResult"]),error:c(r(t.target,"dataDMReportFailed",e),r(t.target,"dataDMError"))})},this.after("initialize",function(){this.on("uiDMDialogReportDM",this.reportMessage)})}var n=i(10),o=i(237),a=i(225),r=o.triggerFn,c=o.chain;t.exports=n(s,a)},function(t,e,i){(function(e){function s(){this.defaultAttrs({noShowError:!0}),this.sendImage=function(t,i){var s=i.media_data||{},n=function(t){return this.trigger("dataMediaSruComplete",s),o.merge(i,{media_id:t})}.bind(this),a=d(t.target,"dataDMError",function(t){return this.trigger("dataMediaSruCancel",s),o.merge(i,{message:t.message})}.bind(this));return s.uploadId?this.mediaSruFinalize(s).then(n,a):e.Deferred().resolve(i)},this.sendMessage=function(t,e){var i=function(i,s){s&&s.retry&&"dataDMDialogSendMessageRetry"!==t.type?setTimeout(function(){this.trigger(i,"dataDMDialogSendMessageRetry",e)}.bind(this),s.delay):this.trigger(i,"dataDMSendSuccess",s)};return this.post({url:"/i/direct_messages/new",data:e,eventData:e,success:i.bind(this,t.target),error:l(d(t.target,"dataDMSendFailed",e),d(t.target,"dataDMError"))})},this.getConversationQueue=function(t){if(t)return this.conversationQueues[t]=this.conversationQueues[t]||h(),this.conversationQueues[t]},this.updateInFlight=function(){var t=Object.keys(this.conversationQueues).reduce(function(t,e){return t[e]=this.conversationQueues[e].length(),t}.bind(this),{});this.trigger("dataDMMessagesInFlight",t)},this.enqueueMessage=function(t,e){this.getConversationQueue(t).enqueue(e).always(this.updateInFlight.bind(this)),this.updateInFlight()},this.handleSend=function(t,e){var i=function(){return this.sendImage(t,e).then(this.sendMessage.bind(this,t))}.bind(this),s=e.conversation_id;s?this.enqueueMessage(s,i):i()},this.after("initialize",function(){this.on("uiDMSendMessage dataDMDialogSendMessageRetry",this.handleSend),this.conversationQueues={},this.on("uiDMConversationNeedsInFlightState",this.updateInFlight)})}var n=i(10),o=i(25),a=i(237),r=i(225),c=i(369),h=i(375),l=a.chain,d=a.triggerFn;t.exports=n(s,r,c)}).call(e,i(1))},,,,,,,function(t,e,i){(function(e){t.exports=function(){function t(){if("running"!==s&&i.length>0){var e=i.shift();s="running";var n=function(e){return s="idle",t(),e},o=e(),a=o.onCompletePromise;o.queuedPromise().then(n,n).then(a.resolve,a.reject)}}var i=[],s="idle";return{enqueue:function(s){var n=e.Deferred(),o=function(){return{queuedPromise:s,onCompletePromise:n}};return i.push(o),t(),n},numPending:function(){return i.length},numInProgress:function(){return"running"===s?1:0},length:function(){return this.numPending()+this.numInProgress()}}}}).call(e,i(1))},function(t,e,i){function s(){this.after("initialize",function(){this.scribeOnEvent("uiRevealSuspiciousDM",{component:"rtf_message",action:"open"}),this.scribeOnEvent("uiReportDMAsSpam",{component:"rtf_message",action:"report_as_spam"}),this.scribeOnEvent("uiReportDMAsSafe",{component:"rtf_message",action:"report_as_ok"})})}var n=i(10),o=i(40),a=n(s,o);t.exports=a},function(t,e,i){function s(){this.defaultAttrs({noShowError:!0}),this.toggleNotifications=function(t,e){e=e||{};var i=c(r(t.target,"dataDMConversationResult"),r(t.target,e.enable_notifications?"dataNotificationsEnabled":"dataNotificationsDisabled")),s=r(t.target,e.enable_notifications?"dataNotificationsEnableFailed":"dataNotificationsDisableFailed");this.post({url:"/i/direct_messages/notifications",data:{id:e.conversation_id,enable_notifications:e.enable_notifications,mute_duration:e.mute_duration},eventData:e,success:i,error:s})},this.after("initialize",function(){this.on("uiToggleNotifications",this.toggleNotifications)})}var n=i(10),o=i(225),a=i(237),r=a.triggerFn,c=a.chain,h=n(s,o);t.exports=h},function(t,e,i){function s(){this.after("initialize",function(){this.scribeOnEvent("uiDMDialogSharedTweetClick",{element:"shared_tweet_dm",action:"click"})})}var n=i(10),o=i(40),a=n(s,o);t.exports=a},function(t,e,i){function s(){this.defaultAttrs({noShowError:!0}),this.update=function(t,e){e=e||{};var i=t.target,s=o.get(e.fileId);s&&this.mediaSruFinalize(s).then(function(t){this.post({url:"/i/direct_messages/update_avatar",data:{conversation_id:e.conversation_id,media_id:t},success:h(i,"dataDMUpdateConversationAvatarSuccess"),error:h(i,"dataDMUpdateConversationAvatarFailed")})}.bind(this))},this.remove=function(t,e){e=e||{},this.post({url:"/i/direct_messages/update_avatar",data:{conversation_id:e.conversation_id},success:h(t.target,"dataDMRemoveConversationAvatarSuccess"),error:h(t.target,"dataDMRemoveConversationAvatarFailed")})},this.after("initialize",function(){this.on("uiDMUpdateConversationAvatar",this.update),this.on("uiDMRemoveConversationAvatar",this.remove)})}var n=i(10),o=i(209),a=i(237),r=i(225),c=i(369),h=a.triggerFn;t.exports=n(s,r,c)},function(t,e,i){function s(){this.defaultAttrs({noShowError:!0}),this.updateName=function(t,e){e=e||{},this.post({url:"/i/direct_messages/update_name",data:{id:e.conversation_id,name:e.name},success:r(t.target,["dataDMConversationResult","dataUpdateConversationNameSuccess"]),error:r(t.target,"dataUpdateConversationNameFailure")})},this.after("initialize",function(){this.on("uiUpdateConversationName",this.updateName)})}var n=i(10),o=i(225),a=i(237),r=a.triggerFn;t.exports=n(s,o)},function(t,e,i){(function(e){function s(){this.attributes({inboxSelector:".DMInbox-content",inboxItemSelector:".DMInboxItem",conversationListSelector:".DMInbox-conversations",eventData:{scribeContext:{component:"dm_conversation_list_dialog"}},markAllReadSelector:".mark-all-read",noMessagesSelector:".dm-no-messages",spinnerSelector:".DMInbox-spinner",loadNextPageRange:150,notifications:!1,usePushNotifications:!1}),this.removeStaleInboxItems=function(t,e){var i=(e||[]).map(function(t){return this.generateInboxItemWithIdSelector(t)},this).join(", ");t.find(i).parent("li").remove()},this.sortInboxClone=function(t){var i=t.children().get();i.sort(function(t,i){var s=e(t).children().first().attr("data-sort-event-id"),o=e(i).children().first().attr("data-sort-event-id");return-1*n.compare(s,o)});var s=(i||[]).reduce(function(t,e){return t+e.outerHTML},"");t.html(s)},this.getDeletedConversationIDs=function(t){var e=(t||[]).filter(function(t){return"conversation_delete"===t.type}).map(function(t){return t.conversation_id});return e},this.applyUserUpdates=function(t,e){if(e.should_request_inbox)this.trigger("uiNeedsDMConversationList");else if(!e.is_empty){var i=e.inbox_updates,s=e.update_events,n=this.select("conversationListSelector").clone(),o=i&&i.updated_conversation_ids,a=this.getDeletedConversationIDs(s),r=(o||[]).concat(a);this.removeStaleInboxItems(n,r),n.prepend(i&&i.html),this.sortInboxClone(n),this.select("conversationListSelector").replaceWith(n),this.$node.data({markAllReadId:e.mark_all_read_id,maxEntryId:e.max_entry_id})}},this.applyInboxResult=function(t,e){var i=this.$node.data(),s=e.sourceEventData;if(s&&s.max_entry_id){if(this.isNextPage(i.minEntryId,e.max_entry_id)){var n=this.select("conversationListSelector").clone();this.removeStaleInboxItems(n,e.threads),n.append(e.html),this.select("conversationListSelector").replaceWith(n),this.$node.data({minEntryId:e.min_entry_id,hasMore:e.has_more})}}else this.select("conversationListSelector").html(e.html||""),this.trigger("dataDMCursor",{cursor:e.cursor}),this.$node.removeData(),this.$node.data({markAllReadId:e.mark_all_read_id,minEntryId:e.min_entry_id,maxEntryId:e.max_entry_id,hasMore:e.has_more});this.trigger("uiResetDMPoll")},this.isNextPage=function(t,e){return!(!t||!e)&&n.compare(t,e)>=0},this.updateSpinner=function(){this.select("spinnerSelector").toggleClass("u-hidden",!this.$node.data("hasMore"))},this.handleInboxScroll=function(t,i){var s=e(t.currentTarget);s[0].scrollHeight-s.scrollTop()-this.attr.loadNextPageRange<=s.outerHeight()&&this.requestNextPageThrottled()},this.requestNextPage=function(){var t=this.$node.data().hasMore;("undefined"==typeof t||t)&&this.trigger("uiNeedsDMConversationList",{max_entry_id:this.$node.data("minEntryId")})},this.requestNextPageThrottled=a.throttle(this.requestNextPage,1e3),this.markAllMessages=function(){this.trigger("dataMarkDMsAsRead",{last_message_id:this.$node.data("markAllReadId")||-1}),this.trigger("uiDMDialogMarkMessage"),this.select("inboxItemSelector").removeClass("is-unread"),this.trigger("uiReadStateChanged",{msgCount:0})},this.generateInboxItemWithIdSelector=function(t){return this.attr.inboxItemSelector+'[data-thread-id="'+t+'"]'},this.markConversationRead=function(t,e){e.recipient_id&&this.$node.find(this.generateInboxItemWithIdSelector(e.recipient_id)+".is-unread").removeClass("is-unread")},this.markConversationUnread=function(t,e){e.sourceEventData&&e.sourceEventData.recipient_id&&this.$node.find(this.generateInboxItemWithIdSelector(e.sourceEventData.recipient_id)).addClass("is-unread");
},this.inboxNeedsRefresh=function(t,e){this.$node.addClass("needs-refresh")},this.removeConversation=function(t,e){this.$node.find(this.generateInboxItemWithIdSelector(e.conversation_id)).parent("li").remove(),this.trigger("uiRenderConversationListView")},this.initiateKnownConversation=function(t,i){if(t){var s=e(t.target);if(this.isProfileLink(s))return;if(s.hasClass("DMInboxItem-media"))return}t&&t.preventDefault();var n=e(i.el),o=n.attr("data-thread-id"),a=new RegExp("^([1-9][0-9]*)-([1-9][0-9]*)$","g");this.trigger("uiRenderConversationView",{conversation_id:o,is_oto:a.test(o),name:n.find(".fullname").html(),most_recent_event_id:n.attr("data-last-message-id")})},this.isProfileLink=function(t){return!!t.closest("a.js-user-profile-link").length},this.setEmptyState=function(t,e){switch(t.type){case"dataDMConversationEmptyState":this.$node.toggleClass("is-empty",!0),this.$node.data("hasMore",!1);break;case"dataDMConversationListResult":this.$node.toggleClass("is-empty",!1);break;case"dataDMUserUpdates":e&&e.conversations&&e.conversations.length&&this.$node.toggleClass("is-empty",!1)}},this.after("setEmptyState",this.updateSpinner),this.after("applyInboxResult",this.updateSpinner),this.after("initialize",function(){this.attr.notifications&&this.attachChild(c,this.$node.find(".DMNotificationsPermissionRequest"),{useNativePush:this.attr.usePushNotifications}),this.on(document,"dataDMConversationListResult",this.applyInboxResult),this.on(document,"dataDMUserUpdates",this.applyUserUpdates),this.on(document,"uiDMInboxWantsRefreshed",this.inboxNeedsRefresh),this.on(this.select("inboxSelector"),"scroll",this.handleInboxScroll),this.on(document,"uiDeleteConversation uiReportConversation",this.removeConversation),this.on(document,"dataConversationDeleteFailed dataConversationReportFailed","uiNeedsDMConversationList"),this.on(document,"dataDMConversationEmptyState dataDMConversationListResult dataDMUserUpdates",this.setEmptyState),this.on(document,"dataMarkDMsAsRead",this.markConversationRead),this.on(document,"dataDMReadError",this.markConversationUnread),this.on(document,"uiCloseDMConversation","uiRenderConversationListView"),this.on("click",{inboxItemSelector:this.initiateKnownConversation,markAllReadSelector:this.markAllMessages})})}var n=i(242),o=i(10),a=i(25),r=i(215),c=i(382),h=o(s,r);t.exports=h}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({acceptSelector:".js-prompt-accept",dismissSelector:".js-prompt-later",daysToWaitOnDismiss:30,useNativePush:!1}),this.shouldDisplayRequest=function(){var t="Notification"in window;if(!t)return!1;var e="default"===Notification.permission,i=this.storage.getItem("last_dismissed_timestamp")||0,s=this.now()-i>24*this.attr.daysToWaitOnDismiss*60*60*1e3;return e&&s},this.now=function(){return Date.now()},this.handleAccept=function(){this.trigger("uiABImpression",{experiment:"web_native_push_notifications_4335"}),this.attr.useNativePush&&this.pushSupported?this.trigger("uiPushSubscriptionChangeRequested",{subscribe:!0}):this.trigger("uiRequestNativeNotificationPermission"),this.trigger("uiDismissDMNotice"),this.scribeAction("success")},this.handleDismiss=function(){this.storage.setItem("last_dismissed_timestamp",this.now()),this.trigger("uiDismissDMNotice"),this.scribeAction("dismiss")},this.scribeAction=function(t){this.scribe({component:"dm_conversation_list_dialog",element:"native_notifications_permission_request",action:t})},this.showNotice=function(){this.trigger("uiShowDMNotice")},this.updatePushSupport=function(t,e){e.supported&&(this.pushSupported=!0),e.subscribed&&this.trigger("uiDismissDMNotice")},this.after("initialize",function(){this.pushSupported=!1,this.storage=new r("dm_notifications"),this.shouldDisplayRequest()&&(this.on("click",{acceptSelector:this.handleAccept,dismissSelector:this.handleDismiss}),this.on(document,"dataPushSubscriptionState",this.updatePushSupport),this.trigger("uiWantsPushSubscriptionState"),this.on(document,"uiSwiftLoaded",a.once(this.showNotice).bind(this)))})}var n=i(10),o=i(40),a=i(25),r=i(96),c=n(s,o);t.exports=c},function(t,e,i){function s(){this.defaultAttrs({noShowError:!0}),this.inbox=function(t,e){e=e||{},this.get({url:"/messages",data:{min_entry_id:e.min_entry_id,max_entry_id:e.max_entry_id},eventData:e,success:r(t.target,function(t){return t.is_empty_state?"dataDMConversationEmptyState":"dataDMConversationListResult"}),error:r(t.target,"dataDMError")})},this.after("initialize",function(){this.on("uiNeedsDMConversationList",this.inbox)})}var n=i(10),o=i(237),a=i(225),r=o.triggerFn;t.exports=n(s,a)},function(t,e,i){function s(){this.defaultAttrs({noShowError:!0}),this.viewParticipants=function(t,e){e=e||{},this.get({url:"/i/direct_messages/participants",data:{conversation_id:e.conversation_id},eventData:e,success:r(t.target,"dataConversationParticipantsResult"),error:r(t.target,"dataDMError")})},this.after("initialize",function(){this.on("uiNeedsConversationParticipants",this.viewParticipants)})}var n=i(10),o=i(225),a=i(237),r=a.triggerFn;t.exports=n(s,o)},function(t,e,i){(function(e){function s(){this.attributes({notice:".DMNotice",dismiss:".DMNotice-dismiss, .DMNotice-cancel",needsExplicitDismiss:".DMNotice--explicitDismiss"}),this.findNotice=function(t){return this.select("notice").filter(t)},this.show=function(t,i){this.dismissAll(!0);var s=i&&i.notice?this.findNotice(i.notice):e(t.target).closest(this.attr.notice);s.slideDown()},this.dismiss=function(t,i){var s=i&&i.notice?this.findNotice(i.notice):e(t.target).closest(this.attr.notice);s.slideUp()},this.dismissAll=function(t){var e=this.select("notice").not(this.attr.needsExplicitDismiss);t?e.slideUp():e.hide()},this.after("initialize",function(){this.on("uiShowDMNotice",this.show),this.on("uiDismissDMNotice",this.dismiss),this.on(document,"uiDismissAllDMNotices",this.dismissAll.bind(this,!1)),this.on("click",{dismiss:"uiDismissDMNotice"})})}var n=i(10);t.exports=n(s)}).call(e,i(1))},function(t,e,i){function s(){this.attributes({conversationContentSelector:".DMConversation-content",notificationDisplayDuration:7e3,mostRecentNotifiedMessageKey:"most_recent_notified_message_id",rollingTagPrefix:"twitterDM",maxSimultaneousNotifications:2,notificationType:"direct_message"}),this.handleUserUpdates=function(t,e){e&&e.notifications&&e.notifications.length&&!this.hasPushSubscription&&this.processNotifications(e.notifications)},this.handleDMPush=function(t,e){this.processNotifications([e])},this.processNotifications=function(t){var e=this.$conversationContainer.attr("data-thread-id"),i=this.isPageFocused()&&this.$conversationContainer.is(":visible"),s=this.storage.getItem(this.attr.mostRecentNotifiedMessageKey)||0,n=t.length?t[t.length-1].id:0;this.storage.setItem(this.attr.mostRecentNotifiedMessageKey,o.max(n,s));var a=t.filter(function(t){var n=o.compare(s,t.id)>=0,a=i&&t.conversation_id.toString()===e;return!n&&!a});a.forEach(function(t){this.trigger("uiDisplayNativeNotification",{title:t.title,body:t.body,icon:t.icon,tag:this.getRollingTag(),type:this.attr.notificationType,click:{eventName:"uiDMNotificationClicked",eventData:{conversation_id:t.conversation_id}},displayDuration:this.attr.notificationDisplayDuration})},this)},this.dmNotificationClicked=function(t,e){window.focus(),this.trigger("uiNeedsDMDialog",{conversation_id:e.conversation_id})},this.isPageFocused=function(){return document.hasFocus()},this.getRollingTag=function(){return this.lastTagNumber=this.lastTagNumber||0,this.lastTagNumber=this.lastTagNumber>=this.attr.maxSimultaneousNotifications?1:this.lastTagNumber+1,this.attr.rollingTagPrefix+this.lastTagNumber},this.updatePushSupport=function(t,e){this.hasPushSubscription=!!e.subscribed},this.after("initialize",function(){this.$conversationContainer=this.select("conversationContentSelector"),this.hasPushSubscription=!1,this.on(document,"dataPushSubscriptionState",this.updatePushSupport),this.trigger("uiWantsPushSubscriptionState"),this.on(document,"dataDMUserUpdates",this.handleUserUpdates),this.on(document,"uiDMNotificationClicked",this.dmNotificationClicked),this.on(document,"dataDMPushReceived",this.handleDMPush),this.on(document,"dataDMPushReceived","uiDMRequestUserUpdates"),this.storage=new a("dm_notifications")})}var n=i(10),o=i(242),a=i(96),r=n(s);t.exports=r},function(t,e,i){(function(e){function s(){this.attributes({scrollContainerSelector:".DMConversation-scrollContainer",videoSelector:".DirectMessage-media video, .dm-media-gallery-overlay video",autoplayVideoSelector:"video[data-autoplay=true]",mediaContainerSelector:".Media",autoPlayThreshold:150}),this.rAF=window.requestAnimationFrame.bind(window),this.getBoundingClientRect=function(t){return t.getBoundingClientRect()},this.handleScroll=function(){this.rAF(function(){var t=this.getBoundingClientRect(this.$scrollContainer[0]),e=this.$autoplayVideos.filter(function(e,i){var s=this.getBoundingClientRect(i);return o.isPartiallyContainedInViewport({topThreshold:-1*this.attr.autoPlayThreshold,bottomThreshold:this.attr.autoPlayThreshold,fractionInViewport:.01,containerRect:t,elementRect:s})}.bind(this));this.$currentlyPlaying.not(e).each(function(){this.pause()}),e.not(this.$currentlyPlaying).each(function(){this.play()}),this.$currentlyPlaying=e}.bind(this))},this.updateMediaList=function(){this.$videos=this.select("videoSelector"),this.$videos.off("pause play playing ended").on("pause play playing ended",this.updatePlayingState.bind(this)),this.$autoplayVideos=this.$videos.filter(this.attr.autoplayVideoSelector)},this.togglePlayback=function(t){var i=e(t.target).closest(this.attr.mediaContainerSelector).find("video")[0];i&&(i.paused?i.play():i.pause())},this.updatePlayingState=function(t){e(t.target).closest(this.attr.mediaContainerSelector).toggleClass("is-playing",!t.target.paused)},this.handleViewChange=function(t,e){"uiDMDialogClosed"!==t.type&&"conversation"===e.activity||this.$videos.each(function(){this.pause()})},this.after("initialize",function(){this.$videos=e(),this.$autoplayVideos=e(),this.$scrollContainer=this.select("scrollContainerSelector"),this.$currentlyPlaying=e(),this.on("uiDMConversationUpdated uiSwiftLoaded",this.updateMediaList),this.select("scrollContainerSelector").scroll(a.throttle(this.handleScroll.bind(this),500)),this.on("click",{videoSelector:this.togglePlayback}),this.on("uiDMDialogClosed uiDMActivityOpened",this.handleViewChange)})}var n=i(10),o=i(73),a=i(25);t.exports=n(s)}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.attributes({popover:".DMPopover",popoverButton:".DMPopover-button",enabledPopoverButton:".DMPopover-button:not(:disabled)",popoverContent:".DMPopover-content",openClass:"is-open",openSelector:".is-open",focusOnOpen:".js-focus-on-open"}),this.getClosestOpenPopover=function(t){return this.getClosestPopover(t).filter(this.attr.openSelector)},this.getClosestPopover=function(t){return e(t).closest(this.attr.popover)},this.toggle=function(t){var e=this.getClosestPopover(t.target);e.hasClass(this.attr.openClass)?this.close(e):(this.closeAll(),e.addClass(this.attr.openClass).find(this.attr.focusOnOpen).focus())},this.closeAll=function(t){this.select("popover").removeClass(this.attr.openClass)},this.close=function(t){t.removeClass(this.attr.openClass).find(this.attr.enabledPopoverButton).focus()},this.disable=function(t){this.getClosestPopover(t.target).find(this.attr.popoverButton).attr("disabled","disabled")},this.enable=function(t){this.getClosestPopover(t.target).find(this.attr.popoverButton).removeAttr("disabled")},this.handleEscape=function(t){var e=this.getClosestOpenPopover(t.target);e.length&&(t.stopImmediatePropagation(),this.close(e))},this.handleBlur=function(t){var e=this.getClosestOpenPopover(t.target);e.length||this.closeAll()},this.after("initialize",function(){this.on(o.GLOBAL_FORCE_CLOSE_EVENTS,this.closeAll),this.on(o.GLOBAL_REQUEST_CLOSE_EVENTS,this.closeAll),this.on("uiShortcutEsc",this.handleEscape),this.on("click",this.handleBlur),this.on("click",{enabledPopoverButton:this.toggle}),this.on("uiDisableDMPopover",this.disable),this.on("uiEnableDMPopover",this.enable)})}var n=i(10),o=i(312);t.exports=n(s)}).call(e,i(1))},function(t,e,i){function s(){this.composeNewDMWithTweet=function(t,e){this.trigger("uiOpenNewDM",{has_tweet_attachment:!0}),this.trigger("uiComposeWithTweet",e)},this.composeNewDMWithOptions=function(t,e){e.tweetId&&this.trigger("uiComposeWithTweet",{id:e.tweetId}),this.trigger("uiNeedsDMDialog",{id:e.recipientId,default_composer_text:e.defaultComposerText,welcome_message_id:e.welcomeMessageId,has_tweet_attachment:void 0!==e.tweetId,retain_tweet_attachment:void 0!==e.tweetId}),e.messageMeCardData&&this.trigger("uiAddMessageMeCardData",e.messageMeCardData)},this.after("initialize",function(){this.on("uiComposeNewDMWithTweet",this.composeNewDMWithTweet),this.on(window,"uiComposeNewDMWithOptions",this.composeNewDMWithOptions)})}var n=i(10),o=n(s);t.exports=o},function(t,e,i){(function(e){function s(){this.defaultAttrs({itemType:"user",dialogSelector:"#dm_dialog",noReposition:!0,disableKeyboardShortcuts:!0,openActivity:".DMActivity--open",openActivityClass:"DMActivity--open",addParticipants:".DMAddParticipants",compose:".DMCompose",conversation:".DMConversation",emptyState:".DMEmptyState",inbox:".DMInbox",viewParticipants:".DMViewParticipants",linksForInbox:".DMActivity-back",linksForCompose:".dm-new-button",toFieldSelector:".dm-to-input",errorBar:".DMErrorBar",errorText:".DMErrorBar-text",mediaPreviewSelector:".DMInboxItem-media, .dm-attached-media"}),this.openDialog=function(t,e){e&&e.fromInitData&&this.on("uiDialogClosed",function(){this.isDialogNavigation||this.isOverlayNavigation||this.trigger("uiNavigate",{href:"/"}),this.isOverlayNavigation=!1}),this.trigger("uiNeedsDMConversationList"),e&&e.id?this.trigger("uiRenderConversationView",{conversation_id:o.generateConversationId(this.attr.userId,e.id),name:e.name,is_oto:!0,default_composer_text:e.default_composer_text,welcome_message_id:e.welcome_message_id,has_tweet_attachment:e.has_tweet_attachment,retain_tweet_attachment:e.retain_tweet_attachment}):e&&e.conversation_id?this.trigger("uiRenderConversationView",e):e&&e.default_composer_text?this.trigger("uiOpenNewDM",{default_composer_text:e.default_composer_text}):this.renderInbox(),this.open()},this.closeDialog=function(){this.isDialogNavigation=!1,this.close()},this.renderInbox=function(t,e){t&&t.preventDefault(),this.renderView("inbox");var i=this.select("inbox");return this.trigger("uiReadStateChanged",{msgCount:0}),i.hasClass("needs-refresh")?(i.removeClass("needs-refresh"),void this.trigger("uiNeedsDMConversationList")):void this.trigger("uiDMDialogOpenedConversationList")},this.handleProfileLinkClick=function(){this.isDialogNavigation||(this.isDialogNavigation=this.$dialog.is(":visible"),this.closeImmediately())},this.renderConversationView=function(t,e){this.renderView("conversation"),this.trigger("uiDMDialogOpenedConversation",{recipient:e.conversation_id||e.screen_names})},this.renderCompose=function(t,e){t&&t.preventDefault(),this.renderView("compose"),this.trigger("uiDMDialogOpenedNewConversation"),this.isOpen()||(this.trigger("uiNeedsDMConversationList"),this.open())},this.renderAddParticipants=function(t,e){this.renderView("addParticipants")},this.renderViewParticipants=function(t,e){t&&t.preventDefault(),this.trigger(t.target,"uiNeedsConversationParticipants",{conversation_id:e.conversation_id}),this.renderView("viewParticipants")},this.renderView=function(t){this.trigger("uiDismissAllDMNotices"),this.select("openActivity").removeClass(this.attr.openActivityClass),this.select(t).addClass(this.attr.openActivityClass),this.trigger("uiDMActivityOpened",{activity:t}),this.trigger(this.$dialog,"uiDialogContentChanged"),this.setScribeComponent(t)},this.setScribeComponent=function(t){this.attr.eventData||(this.attr.eventData={});var e;switch(t){case"compose":e="dm_new_conversation_dialog";break;case"conversation":e="dm_existing_conversation_dialog";break;case"inbox":e="dm_conversation_list_dialog";break;case"addParticipants":e="dm_add_participants_dialog";break;case"viewParticipants":e="dm_view_participants_dialog"}e&&(this.attr.eventData.scribeContext={component:e})},this.showError=function(t,e){this.select("errorText").html(e.message||e.error),this.select("errorBar").show(),this.trigger(this.select("toFieldSelector"),"uiTypeaheadIgnoreNextFocus"),this.trigger(this.$dialog,"uiDialogContentChanged")},this.previewMedia=function(t,i){t.preventDefault();var s=e(t.target);this.trigger("uiDMDialogMediaPreview",{imgUrl:s.attr("data-full-img"),dmId:s.closest(".dm").attr("data-message-id")||s.closest(".DMInboxItem").attr("data-last-message-id")})},this.hideDMDialog=function(){this.$dialogContainer.hide(),this.openState=!1},this.showDMDialog=function(t,e){this.$dialogContainer.show(),this.openState=!0},this.restoreDialog=function(){this.isDialogNavigation&&(this.isDialogNavigation=!1,this.open())},this.dismissErrors=function(){this.trigger("uiHideMessage"),this.select("errorBar").trigger("uiDismissDMNotice")},this.setOverlayNavigation=function(){this.isOverlayNavigation=!0},this.after("initialize",function(){this.$dialogContainer=this.select("dialogSelector"),this.on(document,"uiShowProfilePopup",this.handleProfileLinkClick),this.on(document,"uiCloseProfilePopup",this.restoreDialog),this.on(document,"uiNeedsDMDialog",this.openDialog),this.on(document,"uiCloseDMDialog",this.closeDialog),this.on(document,"uiOpenNewDM",this.renderCompose),this.on(document,"uiAddParticipants",this.renderAddParticipants),this.on(document,"uiViewParticipants",this.renderViewParticipants),this.on(document,"uiNavigate","uiCloseDMDialog"),this.on(document,"uiOverlayNavigate",this.setOverlayNavigation),this.on("uiRenderConversationListView",this.renderInbox),this.on("uiRenderConversationView uiRenderNewConversationView",this.renderConversationView),this.on("uiDMViewParticipantsDone uiDMAddParticipantsDone",this.renderView.bind(this,"conversation")),this.on(document,"dataDMSendSuccess dataDMDeleteSuccess","dataDMSuccess"),this.on(document,"dataDMError",this.showError),this.on(document,"uiDMDialogMediaPreview",this.hideDMDialog),this.on(document,"uiDMDialogMediaPreviewClosed",this.showDMDialog),this.on("uiDialogClosed uiDMHideError",this.dismissErrors),this.on("uiDialogClosed","uiDMDialogClosed"),this.on("click",{linksForInbox:this.renderInbox,linksForCompose:"uiOpenNewDM",mediaPreviewSelector:this.previewMedia})})}var n=i(10),o=i(241),a=i(60),r=i(391),c=i(392),h=i(393),l=i(394),d=n(s,a,c,r,h,l);t.exports=d}).call(e,i(1))},function(t,e,i){(function(e){function s(){n.mixin(this,[r,a]),this.defaultAttrs({pageContainer:"#doc",nestedContainerSelector:".js-stream-item .in-reply-to",showWithScreenNameSelector:".twitter-atreply",showWithIdSelector:".show-popup-with-id, .js-user-profile-link",searchtagSelector:".twitter-hashtag, .twitter-cashtag",cashtagSelector:".twitter-cashtag",geoPivotSelector:".js-geo-pivot-link",itemLinkSelector:".twitter-timeline-link,.js-adaptive-photo",mediaForwardSelector:".js-adaptive-photo",cardExternalLinkSelector:".js-card2-external-link",viewMoreItemSelector:".view-more-container",inSnapbackExperiment:!1,snapbackSkipProfilePopup:!1,dismissedTweetSelector:".js-dismissed-tweet",dismissedTweetClass:"js-dismissed-tweet",dismissibleContainerSelector:".dismissible-container",threadedConversationTweetSelector:".ThreadedConversation-tweet"}),this.showProfilePopupWithScreenName=function(t,i){var s=e(t.target).closest(this.attr.showWithScreenNameSelector).text();"@"===s[0]&&(s=s.substring(1));var n={screenName:s},a=this.getCardDataFromContainer(e(t.target));i=o.merge(this.interactionData(t,n),a),this.showProfile(t,i)},this.showProfilePopupWithId=function(t,i){var s=this.getCardDataFromContainer(e(t.target));i=o.merge(this.interactionDataWithCard(t),s),this.showProfile(t,i)},this.showProfile=function(t,i){"mouseover"===t.type?(t.preventDefault(),t.stopImmediatePropagation(),this.trigger(t.target,"uiShowProfileHover",i)):(i.user_id=e(t.target).closest(".twitter-atreply").attr("data-mentioned-user-id")||i.userId,this.trigger(t.target,"uiShowProfileNewWindow",i))},this.hideHover=function(t,i){var s=this.getCardDataFromContainer(e(t.target));i=o.merge(this.interactionData(t),s),this.trigger("uiHideProfileHover",i)},this.searchtagClick=function(t,i){var s=e(t.target),n=s.closest(this.attr.searchtagSelector),o=n.is(this.attr.cashtagSelector)?"uiCashtagClick":"uiHashtagClick",a={query:n.text()};this.trigger(o,this.interactionData(t,a))},this.isCardUrl=function(t){var e=/^(https?:\/\/)?cards(-staging|-beta)?.twitter.com/;return e.test(t)},this.geoPivotClick=function(t,i){var s={placeId:e(i.el).data("place-id")};this.trigger("uiGeoPivotClick",this.interactionData(t,s))},this.itemLinkClick=function(t,i){var s,n=e(t.target),a=n.closest(this.attr.itemLinkSelector),r=a.closest(".tweet").data("permalink-path"),c=!!n.parents(".permalink").length,h=a.is(this.attr.mediaForwardSelector)?r:"",l=o.merge({url:a.attr("data-expanded-url")||a.attr("href")||h,tcoUrl:a.attr("href")||h,text:a.text()},this.getCardDataFromContainer(n));if(("promotion"===l.cardName||"promotions"===l.cardType)&&this.isCardUrl(l.url)&&!c){t.preventDefault(),s=a.parents(".stream-item").find(".tweet");var d=s.data("permalink-path"),u=s.data("conversation-id");d&&e(document).trigger("uiNavigate",o.merge(i,{href:d,conversation_id:u}))}this.trigger("uiItemLinkClick",this.interactionData(t,l))},this.cardLinkClick=function(t,i,s){var n=this.getCardDataFromContainer(e(i.target));this.trigger(t,this.interactionDataWithCard(i,n))},this.getUserIdFromElement=function(t){return t.length?t.data("user-id"):null},this.itemSelected=function(t,i){var s=this.getCardDataFromContainer(e(t.target));i.organicExpansion&&this.trigger("uiItemSelected",o.merge(this.interactionData(t),s))},this.isNested=function(){return this.$node.closest(this.attr.nestedContainerSelector).length},this.modifierKey=function(t){if(t.shiftKey||t.ctrlKey||t.metaKey||t.which>1)return!0},this.removeTweetsFromUser=function(t,i){var s=this.$node.find("[data-user-id="+i.userId+"].js-stream-tweet"),n=this;e.each(s,function(t,i){var s=e(i),o=s.attr("data-tweet-id"),a=s.closest(this.attr.threadedConversationTweetSelector);a.length||(a=s.parent()),n.removeEngagementsOnTweet(o),a.remove()}.bind(this)),this.trigger("uiRemovedSomeTweets")},this.navigateToViewMoreURL=function(t){var i,s=e(t.target);s.find(this.attr.viewMoreItemSelector).length&&(i=s.find(".view-more-link"),this.trigger(i,"uiNavigate",{href:i.attr("href")}))},this.removeEngagementsOnTweet=function(t){var e=this.$node.find("[data-item-id="+t+"]");e.remove()},this.dismissTweet=function(t,i){var s=e(t.target),n=s.closest(this.attr.tweetContainerSelector),o=n.closest(this.attr.dismissibleContainerSelector);n.addClass(this.attr.dismissedTweetClass).fadeOut(200,function(){n.remove(),o&&o.remove()}),this.trigger("uiTweetDismissed",i)},this.removeAllDismissedTweets=function(){this.select("dismissedTweetSelector").stop().remove()},this.after("initialize",function(){this.isNested()||(this.on("click",{showWithScreenNameSelector:this.showProfilePopupWithScreenName,showWithIdSelector:this.showProfilePopupWithId,searchtagSelector:this.searchtagClick,geoPivotSelector:this.geoPivotClick,itemLinkSelector:this.itemLinkClick,cardExternalLinkSelector:this.cardLinkClick.bind(this,"uiCardExternalLinkClick")}),this.on("uiItemLinkClick",{itemLinkSelector:this.itemLinkClick}),this.on("mouseover",{showWithScreenNameSelector:this.showProfilePopupWithScreenName,showWithIdSelector:this.showProfilePopupWithId}),this.on("mouseout",{showWithScreenNameSelector:this.hideHover,showWithIdSelector:this.hideHover}),this.on("uiHasClickedTweet",this.itemSelected),this.on("uiRemoveTweetsFromUser",this.removeTweetsFromUser),this.on("uiShortcutEnter",this.navigateToViewMoreURL),this.on("uiDismissTweet",this.dismissTweet),this.on(document,"uiBeforePageChanged",this.removeAllDismissedTweets))})}var n=i(20),o=i(25),a=i(37),r=i(36);t.exports=s}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({timestampSelector:".tweet-timestamp",relativeTimestampSelector:".js-relative-timestamp",relativeTimestampClass:"js-relative-timestamp"}),this.currentTimeSecs=function(){return new Date/1e3},this.updateAccessibleShortTimestamp=function(t,i){var s=this.currentTimeSecs(),n=Math.floor(s-i);if(!(n<3)){var a=o.format(i-s),c=t.closest(this.attr.timestampSelector),h=c.find(".u-hiddenVisually");h.length||(c.find(this.attr.relativeTimestampSelector).removeAttr("data-aria-label-part").attr("aria-hidden","true"),h=e(r),c.append(h)),h.text(a)}},this.updateTimestamps=function(){this.select("relativeTimestampSelector").each(function(t,i){var s=e(i),n=s.data("time"),o=this.formatTimestamp(n);o.relative||s.removeClass(this.attr.relativeTimestampClass),s.text(o.text),this.updateAccessibleShortTimestamp(s,n)}.bind(this))},this.formatTimestamp=function(t){var e,i=this.currentTimeSecs(),s=Math.floor(i-t);return s<3?e=a:(e=o.format(s,{direction:"none",type:this.timespanType}),this.localizedDigits&&(e=e.replace(/\d/g,function(t){return this.localizedDigits.charAt(t.charCodeAt(0)-"0".charCodeAt(0))}.bind(this)))),{text:e,relative:!0}},this.after("initialize",function(){var t=e("html").attr("lang");this.timespanType="en"===t||"en-gb"===t?"abbreviated":"short",this.localizedDigits={ar:"٠١٢٣٤٥٦٧٨٩",fa:"۰۱۲۳۴۵۶۷۸۹"}[t],this.on(document,"uiWantsToRefreshTimestamps uiPageChanged",this.updateTimestamps)})}var n=(i(22),i(343)),o=new n.TimespanFormatter,a="ahora",r='<span class="u-hiddenVisually" data-aria-label-part="last"></span>';t.exports=s}).call(e,i(1))},function(t,e,i){var s=i(25);t.exports=function(){this.defaultAttrs({tweetFormSelector:".tweet-form"}),this.initTweetbox=function(t){var e=this.select("tweetFormSelector"),i=this.attr.preexpandTweetbox||!1;this.trigger(e,"uiInitTweetbox",s.merge({draftTweetId:this.attr.draftTweetId,condensable:!i,preexpandTweetbox:i,suppressSuccessMessage:this.attr.suppressSuccessMessage},{eventData:this.attr.eventData},t))}}},function(t,e,i){(function(e){function s(){n.mixin(this,[a,l]),this.defaultAttrs({followButtonSelector:".follow-button, .follow-link, .WebToast-followButton, .ProfileTweet-follow-button",topicLinkSelector:".user-topic-link",userInfoSelector:".user-actions",dropdownSelector:".user-actions .dropdown",dropdownItemSelector:".user-actions .dropdown.open .dropdown-menu li",blockOrReportButtonSelector:".block-or-report-text",tweetItemSelector:".tweet",reportButtonSelector:".blocked-report-text",unmuteButtonSelector:".unmute-button",muteButtonSelector:".mute-button",followStates:["not-following","following","blocked","pending"],userActionClassesToEvents:{"mention-text":["uiMentionAction","mentionUser"],"dm-text":["uiDmAction","dmUser"],"list-text":["uiListAction"],"block-text":["uiNeedsBlockDialog","attachUserData"],"report-text":["uiNeedsReportDialog","attachUserData"],"unblock-text":["uiUnblockAction"],"hide-suggestion-text":["uiHideSuggestionAction"],"retweet-on-text":["uiRetweetOnAction"],"retweet-off-text":["uiRetweetOffAction"],"device-notifications-on-text":["uiDeviceNotificationsOnAction","deviceNotificationsOn"],"device-notifications-off-text":["uiDeviceNotificationsOffAction"],"embed-profile":["uiEmbedProfileAction","redirectToEmbedProfile"]}}),this.getClassNameFromList=function(t,e){var i=e.filter(function(e){return t.hasClass(e)});return i[0]},this.getUserActionEventNameAndMethod=function(t){var e=this.getClassNameFromList(t.closest("li"),Object.keys(this.attr.userActionClassesToEvents));return this.attr.userActionClassesToEvents[e]},this.getFollowState=function(t){return this.getClassNameFromList(t,this.attr.followStates)},this.getInfoElementFromEvent=function(t){var i=e(t.target);return i.closest(this.attr.userInfoSelector)},this.findInfoElementForUser=function(t){var e=this.attr.userInfoSelector+"[data-user-id="+c.parseBigInt(t)+"]";return this.$node.find(e)},this.getEventName=function(t){var e={"not-following":"uiFollowAction",following:"uiUnfollowAction",blocked:"uiUnblockAction",pending:"uiCancelFollowRequestAction"};return e[t]},this.addCancelHoverStyleClass=function(t){t.addClass("cancel-hover-style"),t.one("mouseleave",function(){t.removeClass("cancel-hover-style")});var e=t.closest(this.attr.userInfoSelector);e.addClass("show-more-actions-button"),t.one("mouseleave",function(){e.removeClass("show-more-actions-button")})},this.handleFollowButtonClick=function(t){t.stopPropagation(),this.trigger(e(t.target),"uiCloseDropdowns");var i=this.getInfoElementFromEvent(t),s=e(t.target).closest(this.attr.followButtonSelector),n=this.getTweetForEvent(t,"closest");this.addCancelHoverStyleClass(s);var o=this.getFollowState(i),a=!s.closest(".stream").length;"not-following"===o&&i.data("protected")&&this.trigger("uiShowMessage",{message:_("Una petición de seguimiento ha sido enviada a @{{screen_name}} y está pendiente su aceptación.",{screen_name:i.data("screen-name")})});var r=this.getEventName(o),c={originalFollowState:o,shouldRefreshTimeline:a,mediaType:this.getMediaType(n),screenName:i.data("screen-name")};this.trigger(r,this.interactionDataWithCard(t,c))},this.handleTopicLinkClick=function(t){var e=this.interactionData(t);this.trigger("uiUserTopicClickAction",e)},this.blockFollowWithSignupDialog=function(t){t.stopPropagation(),this.trigger(e(t.target),"uiCloseDropdowns"),this.trigger("uiOpenSignupDialog",{signUpOnly:!0,screenName:this.getInfoElementFromEvent(t).data("screen-name")}),this.trigger("uiLoggedOutFollowAttempt",this.interactionData(t))},this.handleBlockOrReportClick=function(t){var e=this.getInfoElementFromEvent(t),i=e.data("screen-name"),s=e.data("user-id").toString(),n=this.getFollowState(e),a=o.merge(this.interactionData(t),{screenName:i,userId:s,target:"user",viewerFollowsAuthor:"following"===n,viewerBlocksAuthor:"blocked"===n});this.trigger("uiNeedsBlockOrReportDialog",a)},this.handleUserAction=function(t){var i=e(t.target),s=this.getUserActionEventNameAndMethod(i);if(s){t.stopPropagation();var n=this.getInfoElementFromEvent(t),o=s[0],a=s[1],r=this.getFollowState(n),c={originalFollowState:r};a&&(c=this[a](n,o,c)),c&&this.trigger(o,this.interactionData(t,c)),this.trigger(i,"uiCloseDropdowns")}},this.deviceNotificationsOn=function(t,e,i){return this.attr.deviceEnabled?i:(this.attr.smsDeviceVerified||this.attr.hasPushDevice?this.trigger("uiOpenConfirmDialog",{titleText:"Activar notificaciones en tu móvil para Tweets",bodyText:_("Antes de que puedas recibir notificaciones de los Tweets de @{{screenName}} en tu móvil, necesitas habilitar la opción notificación de Tweet.",{screenName:t.data("screen-name")}),cancelText:"Cerrar",submitText:"Activar notificaciones de Tweets",action:this.attr.hasPushDevice?"ShowPushTweetsNotifications":"ShowMobileNotifications",top:this.attr.top}):this.trigger("uiOpenConfirmDialog",{titleText:"Configurar las notificaciones en tu móvil",bodyText:_("Antes de que puedas recibir notificaciones de los Tweets de @{{screenName}} en el móvil, debes configurar tu teléfono.",{screenName:t.data("screen-name")}),cancelText:"Cancelar",submitText:"Configurar teléfono",action:"ShowMobileNotifications",top:this.attr.top}),!1)},this.redirectToMobileNotifications=function(){window.location="/settings/devices"},this.redirectToPushNotificationsHelp=function(){window.location="//support.twitter.com/articles/20169887"},this.redirectToEmbedProfile=function(t,e,i){return this.trigger("uiNavigate",{href:"/settings/widgets/new/user?screen_name="+t.data("screen-name")}),!0},this.mentionUser=function(t,e,i){this.trigger("uiOpenTweetDialog",{screenName:t.data("screen-name"),title:_("Tweet para {{name}}",{name:t.data("name")})})},this.attachUserData=function(t,e,i){var s=o.merge(this.interactionData(i),{screenName:h.getScreenName(t),userId:h.getId(t),target:"user"});return s},this.dmUser=function(t,e,i){return this.trigger("uiNeedsDMDialog",{id:h.getId(t),screen_name:h.getScreenName(t),name:h.getName(t),oto_only:!0}),i},this.hideSuggestion=function(t,e,i){
return o.merge(i,{feedbackToken:t.data("feedback-token")})},this.followStateChange=function(t,e){this.updateFollowState(e.userId,e.newState),e.fromShortcut&&("not-following"===e.newState?this.trigger("uiShowMessage",{message:_("Has desbloqueado a {{username}}",{username:e.username})}):"blocked"===e.newState&&this.trigger("uiUpdateAfterBlock",{userId:e.userId}))},this.updateFollowState=function(t,e){var i=this.findInfoElementForUser(t),s=this.getFollowState(i);s&&i.removeClass(s),i.addClass(e),"blocked"===e?this.trigger("uiUpdateAfterBlock",{userId:t}):"not-following"===e&&this.trigger("uiShowProfileTweets")},this.follow=function(t,e){var i=this.findInfoElementForUser(e.userId),s=i.data("protected")?"pending":"following";this.updateFollowState(e.userId,s),i.addClass("including")},this.unfollow=function(t,e){var i=this.findInfoElementForUser(e.userId);this.updateFollowState(e.userId,"not-following"),i.removeClass("including notifying")},this.cancel=function(t,e){this.updateFollowState(e.userId,"not-following")},this.block=function(t,e){var i=this.findInfoElementForUser(e.userId);this.trigger("jsClearReinjectionCookiesForUser",{userId:e.userId}),this.updateFollowState(e.userId,"blocked"),i.removeClass("including notifying")},this.unblock=function(t,e){this.updateFollowState(e.userId,"not-following")},this.retweetsOn=function(t,e){var i=this.findInfoElementForUser(e.userId);i.addClass("including")},this.retweetsOff=function(t,e){var i=this.findInfoElementForUser(e.userId);i.removeClass("including")},this.notificationsOn=function(t,e){var i=this.findInfoElementForUser(e.userId),s=i.find(this.attr.deviceFollowCheckboxSelector);i.addClass("notifying"),s.prop("checked",!0)},this.notificationsOff=function(t,e){var i=this.findInfoElementForUser(e.userId),s=i.find(this.attr.deviceFollowCheckboxSelector);i.removeClass("notifying"),s.prop("checked",!1)},this.blockUserConfirmed=function(t,e){t.stopImmediatePropagation(),this.trigger("uiBlockAction",e.sourceEventData)},this.preventFocus=function(t,e){t.preventDefault()},this.handleMuteButtonClick=function(t){return function(e,i){i=this.interactionData(e),i.scribeContext={element:"muted_button"},this.trigger(e.target,t,i)}},this.updateMuteButtonState=function(t,e){var i=this.$node.find(this.attr.userInfoSelector+"[data-user-id="+e.userId+"]"),s=i.find(this.attr.unmuteButtonSelector),n=i.find(this.attr.muteButtonSelector),o=s.is(":focus"),a=n.is(":focus");i[e.modOp](e.modClass),n.removeClass("first-load"),o?n.focus():a&&s.focus()},this.isHomePage=function(){return"/"===window.location.pathname},this.after("initialize",function(){return r.attachTo(this.$node),this.attr.loggedIn?(this.on(document,"uiFollowStateChange dataFollowStateChange dataBulkFollowStateChange",this.followStateChange),this.on(document,"uiFollowAction",this.follow),this.on("click",{followButtonSelector:this.handleFollowButtonClick}),void(this.attr.loggedIn&&(this.on("click",{topicLinkSelector:this.handleTopicLinkClick,dropdownItemSelector:this.handleUserAction,unmuteButtonSelector:this.handleMuteButtonClick("uiDidUnmuteUser"),muteButtonSelector:this.handleMuteButtonClick("uiDidMuteUser"),blockOrReportButtonSelector:this.handleBlockOrReportClick,reportButtonSelector:this.handleBlockOrReportClick}),this.on("mousedown",{unmuteButtonSelector:this.preventFocus,muteButtonSelector:this.preventFocus}),this.on(document,"uiUnfollowAction",this.unfollow),this.on(document,"uiCancelFollowRequestAction",this.cancel),this.on(document,"uiUnblockAction",this.unblock),this.on(document,"uiRetweetOnAction dataRetweetOnAction",this.retweetsOn),this.on(document,"uiRetweetOffAction dataRetweetOffAction",this.retweetsOff),this.on(document,"uiDeviceNotificationsOnAction dataDeviceNotificationsOnAction",this.notificationsOn),this.on(document,"uiDeviceNotificationsOffAction dataDeviceNotificationsOffAction",this.notificationsOff),this.on(document,"uiShowMobileNotificationsConfirm",this.redirectToMobileNotifications),this.on(document,"uiShowPushTweetsNotificationsConfirm",this.redirectToPushNotificationsHelp),this.on(document,"uiUpdateMuteButtonState",this.updateMuteButtonState),this.on(document,"uiBlockAction",this.block),this.on(document,"uiDidBlockUser",this.blockUserConfirmed),this.on(document,"uiDidTriggerBlockingAction",this.block)))):void this.on("click",{followButtonSelector:this.blockFollowWithSignupDialog})})}var n=i(20),_=i(22),o=i(25),a=i(36),r=i(395),c=i(242),h=i(397),l=i(398);t.exports=s}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({dropdownThresholdSelector:".dropdown-threshold"}),this.scrollIntoView=function(){var t,e,i=this.$node.closest(this.attr.dropdownThresholdSelector);i.length&&(t=this.$node.find(this.attr.dropDownSelector),e=t.offset().top+t.outerHeight()-(i.offset().top+i.height()),e>0&&i.animate({scrollTop:i.scrollTop()+e}))},this.after("initialize",function(){this.on("uiDropdownOpened",this.scrollIntoView),this.on(document,"uiHasInjectedNewTimeline uiHasInjectedOldTimelineItems uiHasInjectedRangeTimelineItems",this.applyARIAAttrs)})}var n=i(10),o=i(396),a=n(o,s);t.exports=a},,,function(t,e,i){(function(e){function s(){this.preventDefault=function(t,e,i){t.preventDefault()},this.composeHandler=function(){var t=arguments,e={};return function(i,s){for(var n=0,o=t.length;n<o&&t[n].call(this,i,s,e)!==!1;n++);}},this.getTweetForEvent=function(t,i){var s,n=e(t.target);return n.is(this.attr.tweetItemSelector)&&(s=n),s||(s=n[i](this.attr.tweetItemSelector)),s},this.getClosestTweet=function(t,e,i){var s=this.getTweetForEvent(t,"closest"),n=!!s.length;return n&&(i.$tweet=s),n},this.getDataForTweet=function(t){return{id:t.attr("data-tweet-id"),screenName:t.attr("data-screen-name"),isTweetProof:"true"===t.attr("data-is-tweet-proof"),viewerFollowsAuthor:"true"===t.attr("data-you-follow"),viewerBlocksAuthor:"true"===t.attr("data-you-block"),featureContext:t.attr("data-feature-context"),mediaType:this.getMediaType(t),photoCount:t.find(".animated-gif, .js-adaptive-photo, .AdaptiveStreamGridImage").length,momentId:t.attr("data-moment-id")}},this.getMediaType=function(t){var e="";return 0!==t.find(".js-adaptive-photo").length?e="image":"player"===t.attr("data-card2-type")?e="video":(t.attr("data-has-cards")||t.hasClass("has-content"))&&(e="media"),e},this.mkTweetDataCollector=function(){var t=arguments;return function(e){for(var i={},s=0,o=t.length;s<o;s++)i=n.merge(i,t[s].call(this,e));return i=n.merge(i,this.getDataForTweet(e))}.bind(this)},this.mkTweetDataCollectorForAction=function(){var t=this.mkTweetDataCollector.apply(this,arguments);return function(e,i,s){return s.tweetData=t(s.$tweet),!0}},this.triggerTweetAction=function(t){return function(e,i,s){var n="function"==typeof t?t.call(this,e,i,s):t;this.trigger(s.$tweet,n,s.tweetData)}}}var n=i(25);t.exports=s}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({dmLinkSelector:".js-dm-dialog, .dm-button, .global-dm-nav"}),this.openDialog=function(t,i){t.preventDefault();var s=e(i.el);i={id:o.getId(s),screen_name:o.getScreenName(s),name:o.getName(s),oto_only:!0},this.trigger("uiNeedsDMDialog",i)},this.after("initialize",function(){this.on(document,"click",{dmLinkSelector:this.openDialog})})}var n=i(10),o=i(397);t.exports=n(s)}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({dmImagePreviewSelector:".dm-media-preview",dmPreviewSelector:".dm-media"}),this.loadImage=function(t,i){var s=e('<img class="dm-media-image"/>'),n=this.select("dmImagePreviewSelector");n.empty(),s.on("load",function(t){n.empty().append(s),s.attr({"data-height":s[0].height,"data-width":s[0].width}),r.resizeMedia(s,this.select("dmPreviewSelector")),this.position();var e=parseFloat(s.css("margin-top"));e&&s.css("margin-bottom",e),this.trigger("uiDMMediaLoaded",{url:s.attr("src"),id:i})}.bind(this)),s.on("error",function(t){this.trigger("uiDMMediaFailed",{url:s.attr("src"),id:i})}.bind(this)),s.attr("src",t)},this.openDialog=function(t,e){this.calculateScrollbarWidth(),r.resetMinSize(this.select("dmPreviewSelector")),this.loadImage(e.imgUrl,e.dmId),this.open()},this.renderConversation=function(t,e){this.trigger("uiDMDialogMediaPreviewClosed")},this.after("initialize",function(){this.on(document,"uiDMDialogMediaPreview",this.openDialog),this.on("uiDialogCloseRequested",this.renderConversation)})}var n=i(10),o=i(60),a=i(61),r=i(401);t.exports=n(s,o,a)}).call(e,i(1))},function(t,e,i){(function(e){var i=function(){var t=300,i=520,s=50;return{galleryWidth:function(t,i){var n=e(window).width()-2*s,o=Math.min(n,t.width());return Math.max(i.width(),o)},resetMinSize:function(e){this.galW=i,this.galH=t,e.width(this.galW),e.css("min-height",this.galH)},resizeMedia:function(t,i,n,o,a){var r=i.find(o).add(i.find(".modal-header")).map(function(){return e(this).outerHeight()}).get().reduce(function(t,e){return t+e}),c=e(window).height()-2*s,h=e(window).width()-2*s,l=c-r,d=h,u=t[0].getBoundingClientRect(),m=u.bottom-u.top,p=u.right-u.left,g=p/m;n&&(p+=130,m+=100),m>l&&(p=Math.ceil(p*(l/m)),m=l,t.width(p).height(m)),p>d&&(p=d,m=Math.ceil(p/g),t.width(p).height(m));var f=i.find(".GalleryNav").hasClass("enabled");(!f||p>this.galW)&&(this.galW=p,i.width(this.galW)),m+r>this.galH?(this.galH=m+r,i.css("min-height",this.galH),t.css("margin-top",0)):a?i.css("min-height",0):(t.css("margin-top",(this.galH-r-m)/2),t.css("margin-bottom",(this.galH-r-m)/2))}}}();t.exports=i}).call(e,i(1))},function(t,e,i){function s(){this.scribeSendDM=function(t,e){var i=e.conversation_id?"dm_existing_conversation_dialog":"dm_new_conversation_dialog",s=this.buildScribeData(e);if(this.scribe({component:i,action:"send_dm"},e,s),e.tweet_id&&this.scribe({component:i,action:"send_tweet_dm"},{conversation_id:e.conversation_id||e.recipient_ids,status_id:e.tweet_id},s),e.media_data&&e.media_data.fileType===o.GIF){var n=!!e.media_data.foundMediaInfo;this.scribe({component:i,element:n?"remote":"local",action:"send_gif_dm"})}},this.buildScribeData=function(t){var e={};if(t.message_me_scribe_data){if(t.message_me_scribe_data.userId){var i={item_type:r.user,id:t.message_me_scribe_data.userId};e.items=[i]}t.message_me_scribe_data.cardName&&(e.context=t.message_me_scribe_data.cardName),t.message_me_scribe_data.cardUri&&(e.message=t.message_me_scribe_data.cardUri)}return e},this.scribeCardInDmImpression=function(t,e){var i=e&&{items:[e.cardItem]};this.scribe({component:"dm_existing_conversation_dialog",element:"platform_card",action:"show"},i)},this.scribeTypingIndicator=function(t,e){var i="uiDMTypingIndicatorAvatarAdded"===t.type?"impression":"refresh";this.scribe({component:"dm_existing_conversation_dialog",element:"typing_indicator",action:i},e)},this.muteDurationScribeAction={0:"mute_dm_thread_forever",1:"mute_dm_thread_1h",2:"mute_dm_thread_8h",3:"mute_dm_thread_1w"},this.scribeNotificationsMute=function(t,e){var i=this.muteDurationScribeAction[e.mute_duration];e.enable_notifications===!1&&i&&this.scribe({component:"dm_existing_conversation_dialog",action:i})},this.after("initialize",function(){this.scribeOnEvent("uiComposeNewDMWithTweet","share_via_dm"),this.scribeOnEvent("uiDMDialogOpenedNewConversation","open"),this.scribeOnEvent("uiDMDialogOpenedConversation","open"),this.scribeOnEvent("uiDMDialogOpenedConversationList","open"),this.scribeOnEvent("uiDMDialogDeleteMessage",{component:"dm_existing_conversation_dialog",action:"delete_dm"}),this.scribeOnEvent("uiDMDialogMarkSpam",{component:"dm_existing_conversation_dialog",action:"report_as_spam"}),this.scribeOnEvent("uiDMDialogMarkMessage",{element:"mark_all_as_read",action:"click"}),this.scribeOnEvent("uiDMMediaLoaded","media_preview"),this.scribeOnEvent("uiDMMediaFailed","media_preview"),this.scribeOnEvent("dataDMTypingPublished",{component:"dm_existing_conversation_dialog",action:"publish_typing"}),this.on("uiDMSendMessage",this.scribeSendDM),this.on("uiNewDMCardLoaded",this.scribeCardInDmImpression),this.on("uiDMTypingIndicatorAvatarAdded uiDMTypingIndicatorAvatarRefreshed",this.scribeTypingIndicator),this.on("uiToggleNotifications",this.scribeNotificationsMute)})}var n=i(10),o=i(264),a=i(40),r=i(42),c=n(s,a);t.exports=c},function(t,e,i){(function(e){function s(){this.defaultAttrs({noShowError:!0}),this.markDMsAsRead=function(t,i){i=i||{},i.retry=i.retry||void 0===i.retry;var s=e.noop,n=e.noop;i.from_notification?s=r(t.target,function(t){return"msgCount"in t?"uiReadStateChanged":null}):(s=function(e){"success"!==e.text?n.call(this,e):this.trigger(t.target,"dataDMReadSuccess",e)},n=function(e){i.retry?(i.retry=!1,this.trigger(t.target,"dataMarkDMsAsRead",i)):this.trigger(t.target,"dataDMReadError",e)}),this.post({url:"/i/messages/mark_read",data:{last_message_id:i.last_message_id,recipient_id:i.recipient_id,recipient_name:i.recipient_name,get_count:i.from_notification},eventData:i,success:s.bind(this),error:n.bind(this)})},this.after("initialize",function(){this.on("dataMarkDMsAsRead",this.markDMsAsRead)})}var n=i(10),o=i(225),a=i(237),r=a.triggerFn;t.exports=n(s,o)}).call(e,i(1))},function(t,e,i){function s(){this.attributes({open:!1,text:"",welcomeMessageId:void 0,conversation:{id:null},compose:{id:null,screenName:null,name:null,avatar:null}}),this.openDMDialog=function(t,e){this.attr.open&&((this.attr.conversation||{}).id?this.openConversation():this.openCompose())},this.openConversation=function(){var t=this.attr.conversation||{};this.trigger("uiNeedsDMDialog",{conversation_id:t.id,default_composer_text:this.attr.text,fromInitData:!0})},this.openCompose=function(){var t=this.attr.compose||{};this.trigger("uiNeedsDMDialog",{id:t.id,screen_name:t.screenName,name:t.name,profile_image_url_https:t.avatar,default_composer_text:this.attr.text,welcome_message_id:this.attr.welcomeMessageId,fromInitData:!0})},this.after("initialize",function(){this.on("uiSwiftLoaded uiPopStateNavigate",this.openDMDialog)})}var n=i(10);t.exports=n(s)},function(t,e,i){function s(){var t=0;this.triggerUnreadCount=function(e,i){i=i||{},t=i.msgCount,t>0?this.trigger(e.target,"dataUserHasUnreadDMsWithCount",{msgCount:t}):this.trigger(e.target,"dataUserHasNoUnreadDMsWithCount")},this.dispatchUnreadNotification=function(t,e){var i=e&&e.d||{};"ok"===i.status&&null!=i.response&&this.triggerUnreadCount(t,{msgCount:i.response})},this.checkForEnvelope=function(e,i){i&&"profile"===i.section&&this.triggerUnreadCount(e,{msgCount:t})},this.after("initialize",function(){this.on("uiReadStateChanged",this.triggerUnreadCount),this.on("dataNotificationsReceived",this.dispatchUnreadNotification),this.on("uiPageChanged",this.checkForEnvelope)})}var n=i(10);t.exports=n(s)},function(t,e,i){function s(){this.dismiss=function(t,e){this.post({url:["/i/feedback/dismiss/",e.feedbackId,".json"].join(""),success:"dataB2CFeedbackDismissed",error:"dataB2CFeedbackDismissedFailed"}),this.trigger("uiDMHideError")},this.after("initialize",function(){this.on(document,"uiB2CFeedbackDismiss",this.dismiss)})}var n=i(10),o=i(225),a=n(s,o);t.exports=a},function(t,e,i){function s(){this.getFeedbackItem=function(t){return{id:t,item_type:r.feedbackRequest}},this.scribeFeedbackDismiss=function(t,e){e&&this.scribe({component:this.getFeedbackComponent[e.cardName],element:e.currentView,action:"dismiss"},{items:[this.getFeedbackItem(e.feedbackId)]})},this.after("initialize",function(){this.getFeedbackComponent={},this.getFeedbackComponent[c.feedbackNpsCardName]=c.feedbackNpsScribeComponentName,this.getFeedbackComponent[c.feedbackCsatCardName]=c.feedbackCsatScribeComponentName,this.on(document,"uiB2CFeedbackDismiss",this.scribeFeedbackDismiss)})}var n=i(10),o=i(40),a=i(37),r=i(42),c=i(408);t.exports=n(s,o,a)},function(t,e){var i="2586390716:feedback_nps",s="2586390716:feedback_csat",n="nps_feedback_survey",o="csat_feedback_survey",a={feedbackNpsCardName:i,feedbackCsatCardName:s,feedbackNpsScribeComponentName:n,feedbackCsatScribeComponentName:o};t.exports=a},function(t,e,i){function s(){this.defaultAttrs({noShowError:!0,dmDialogSelector:"#dm_dialog",throttleInterval:3e3,foregroundPollInterval:3e3,burstPollInterval:3e3,burstPollDuration:3e5,maxPollInterval:6e4}),this.dispatch=function(t){t&&(c.updateNotificationState(t.note),this.trigger("dataNotificationsReceived",t.note))},this.makeToastRequest=function(t,e,i){this.get({url:"/i/toast_poll",data:i,eventData:e,success:this.dispatch.bind(this),headers:{"X-Twitter-Polling":!0},returnNotificationData:!0})},this.requestUserUpdates=function(){this.get({url:"/i/direct_messages/user_updates",data:{cursor:this.dmCursor,active_conversation:this.activeConversationVisible?this.activeConversation:void 0},success:"dataDMUserUpdates"})},this.requestConversationList=function(t,e){var i={};c.addDMData(i),this.makeToastRequest(t,e,i)},this.attachBackgroundPoller=h.once(function(){this.attachChild(n,document,{burstPollInterval:this.attr.burstPollInterval,burstDuration:this.attr.burstPollDuration,maxPollInterval:this.attr.maxPollInterval})}),this.updateActiveConversation=function(t,e){this.activeConversation=e.conversation_id},this.updateActiveConversationVisibility=function(t,e){this.activeConversationVisible="uiDMConversationActivityVisible"===t.type},this.after("initialize",function(){this.attachChild(a,document,{dmDialogSelector:this.attr.dmDialogSelector,pollingInterval:this.attr.foregroundPollInterval}),o.get("notifications")&&"Notification"in window&&"granted"===Notification.permission&&this.attachBackgroundPoller(),this.on("uiNativeNotificationPermissionGranted",this.attachBackgroundPoller),this.on("uiDMPoll",this.requestConversationList),this.on("uiDMRequestUserUpdates",h.throttle(this.requestUserUpdates,this.attr.throttleInterval)),this.on("dataDMUpdate",this.requestUserUpdates),this.on("uiDMConversationUpdated",this.updateActiveConversation),this.on("uiDMConversationActivityHidden uiDMConversationActivityVisible",this.updateActiveConversationVisibility)})}var n=i(410),o=i(323),a=i(411),r=i(10),c=i(230),h=i(25),l=i(234),d=i(225),u=i(363),m=i(215),p=r(s,d,l,u,m);t.exports=p},function(t,e,i){function s(){this.attributes({burstDuration:5,burstPollInterval:3e3,dmToastType:"direct_message",maxPollInterval:6e4,noTeardown:!0}),this.possiblyStartBurstPolling=function(t,e){e.should_request_inbox||e.is_empty||(clearTimeout(this.stopTimeout),this.timer.resume(),this.stopTimeout=setTimeout(this.timer.pause.bind(this.timer),this.attr.burstDuration))},this.after("initialize",function(){this.timer=n.setIntervalEvent("uiDMRequestUserUpdates",this.attr.burstPollInterval,{},this.attr.noTeardown),this.timer.pause(),n.setIntervalEvent("uiDMRequestUserUpdates",this.attr.maxPollInterval,{},this.attr.noTeardown),this.on("uiSwiftLoaded","uiDMRequestUserUpdates"),this.on("dataDMUserUpdates",this.possiblyStartBurstPolling)})}var n=i(9),o=i(10),a=o(s);t.exports=a},function(t,e,i){function s(){this.attributes({dmDialogSelector:"#dm_dialog",pollingInterval:3e3,noTeardown:!0}),this.pollIfForeground=function(){this.isDocumentVisible()&&this.isDialogVisible()&&this.trigger("uiDMRequestUserUpdates")},this.isDialogVisible=function(){return this.$dmDialog.is(":visible")},this.isDocumentVisible=function(){return"visible"===document.visibilityState},this.after("initialize",function(){this.$dmDialog=this.select("dmDialogSelector"),this.timer=n.setIntervalEvent("uiDMForegroundPoll",this.attr.pollingInterval,{},!0),this.on("uiDMForegroundPoll",this.pollIfForeground)})}var n=i(9),o=i(10),a=o(s);t.exports=a},function(t,e,i){(function(e){function s(){this.defaultAttrs({draggingClass:"currently-dragging",supportsDraggingClass:"supports-drag-and-drop"}),this.dragEnter=function(){this.$node.addClass(this.attr.draggingClass)},this.dragLeave=function(){this.$node.removeClass(this.attr.draggingClass)},this.addSupportsDraggingClass=function(){this.$node.addClass(this.attr.supportsDraggingClass)},this.hasSupport=function(){return"draggable"in document.createElement("span")&&!e.browser.msie},this.after("initialize",function(){this.hasSupport()&&(this.addSupportsDraggingClass(),this.on("uiDragEnter",this.dragEnter),this.on("uiDragLeave uiDrop",this.dragLeave))})}var n=i(10),o=i(413);t.exports=n(s,o)}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({fileTypeRegExp:!1}),this.childHover=function(t){e.contains(this.$node.get(0),t.target)&&(t.stopImmediatePropagation(),this.inChild="dragenter"===t.type)},this.hover=function(t){if(t.preventDefault(),this.inChild)return!1;var e=this.prepareData(t);this.trigger("dragenter"===t.type?"uiDragEnter":"uiDragLeave",e)},this.finish=function(t){t.stopImmediatePropagation(),this.inChild=!1,this.trigger("uiDragLeave")},this.preventDefault=function(t){return t.preventDefault(),!1},this.detectDragEnd=function(t){this.detectingEnd||(this.detectingEnd=!0,e(document.body).one("mousemove",this.dragEnd.bind(this)))},this.dragEnd=function(){this.detectingEnd=!1,this.trigger("uiDragEnd")},this.outOfBounds=function(t){var e=t.originalEvent.pageX,i=t.originalEvent.pageY,s=document.body.clientWidth,n=document.body.clientHeight;(e<=0||i<=0||i>=n||e>=s)&&this.dragEnd()},this.prepareData=function(t){var e=(t.originalEvent||t).dataTransfer,i={};i.types=Array.prototype.slice.call(e.types,0);var s=e.items||e.files;if(s){i.items=[];for(var n=0;n<s.length;++n){var o=s[n];i.items.push({type:o.type})}}else i.items=null;return{dataTransfer:i}},this.after("initialize",function(){this.inChild=!1,this.on(document.body,"dragenter dragover",this.detectDragEnd),this.on(document.body,"dragleave",this.outOfBounds),this.on("dragenter dragleave",n.onlyHandleEventsWithFiles(this.hover,this.attr.fileTypeRegExp)),this.on("dragover drop",n.onlyHandleEventsWithFiles(this.preventDefault,this.attr.fileTypeRegExp)),this.on("dragenter dragleave",n.onlyHandleEventsWithFiles(this.childHover,this.attr.fileTypeRegExp)),this.on(document,"uiDragEnd drop",this.finish)})}var n=i(270);t.exports=s}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({itemSelector:".tweet[data-dynamic-preroll=true]",maxAdRequest:10,tweetIdAttr:"data-tweet-id",impressionIdAttr:"data-impression-id",includeLongVideos:!1}),this.initialAdFetch=function(t,e){var i=this.getTweetInfo(this.select("itemSelector"));this.fetchAdsAndCache(i)},this.timelineAdFetch=function(t,i){var s=this.getTweetInfo(e(i.items_html).find(this.attr.itemSelector));this.fetchAdsAndCache(s)},this.getTweetInfo=function(t){return t.map(function(t,i){var s=e(i);return{id:s.attr(this.attr.tweetIdAttr),promoted_id:s.attr(this.attr.impressionIdAttr)}}.bind(this)).get()},this.isMarketplaceTweet=function(t){return!t.promoted_id},this.fetchAdsAndCache=function(t){this.tweetRefreshCache=this.tweetRefreshCache.concat(t.filter(this.isMarketplaceTweet)),t.forEach(function(t){this.isMarketplaceTweet(t)||(this.amplifyTweets[this.adCacheKey(t)]=t)}.bind(this)),this.fetchAds(t)},this.fetchAds=function(t,e){if(t&&0!==t.length){var i;for(i=0;i<t.length;i+=this.attr.maxAdRequest){var s,n=t.slice(i,i+this.attr.maxAdRequest),o=n.map(function(t){return this.requestsInFlight[this.adCacheKey(t)]=!0,{tweet_id:t.id,impression_id:t.promoted_id}}.bind(this));e&&e.adId&&e.dynamicPrerollType&&(s={preroll_id:e.adId,dynamic_preroll_type:e.dynamicPrerollType}),this.post({url:"/i/videoads/v2/prerolls.json",data:{tweets:JSON.stringify({tweets:o,trigger_preroll:s,include_long_videos:this.attr.includeLongVideos})},success:this.handleSuccess.bind(this,n),error:this.handleError.bind(this,n)})}}},this.handleSuccess=function(t,e){var i={},s=e.autoplay_blacklist;this.removeInFlightRequests(t),e.video_analytics_scribe.forEach(function(t){var n=e.prerolls.find(function(e){return e.tweet_id===t.tweet_id&&e.impression_id===t.impression_id&&e.live_event_id===t.live_event_id})||{},o={adId:n.preroll_id,dynamicPrerollType:n.dynamic_preroll_type,autoplayBlacklist:s,videoAnalyticsScribePassthrough:t.video_analytics_scribe_passthrough};n.promoted_content&&(o.promotedContent={impressionId:n.promoted_content.impression_id,disclosureType:n.promoted_content.disclosure_type}),n.media_info&&(o.mediaInfo=n.media_info);var a=this.adCacheKey({id:t.tweet_id,promoted_id:t.impression_id});this.amplifyTweets[a]&&(this.amplifyTweets[a].adId=n.preroll_id,this.amplifyTweets[a].dynamicPrerollType=n.dynamic_preroll_type),i[a]=o}.bind(this)),this.updateDynamicVideoAdCache(i)},this.handleError=function(t,i){this.removeInFlightRequests(t);var s=t.map(function(t){return e.extend({error_message:i.message},t)});this.scribe({element:"dynamic_video_ads",action:"dynamic_preroll_request_error"},{items:s})},this.removeInFlightRequests=function(t){t.forEach(function(t){delete this.requestsInFlight[this.adCacheKey(t)]}.bind(this))},this.refreshCache=function(t,e){if(this.clearDynamicVideoAdCache(),e.tweet&&e.tweet.id){var i=this.adCacheKey({id:e.tweet.id,promoted_id:e.tweet.promoted_id});this.requestsInFlight[i]&&this.scribe({element:"dynamic_video_ads",action:"dynamic_preroll_request_late"},{items:[e.tweet]})}Object.keys(this.amplifyTweets).length>0&&setTimeout(function(){this.updateDynamicVideoAdCache(this.amplifyTweets)}.bind(this),0),this.fetchAds(this.tweetRefreshCache,e.triggerAd)},this.after("initialize",function(){this.tweetRefreshCache=[],this.amplifyTweets={},this.requestsInFlight={},this.on(document,"uiRefreshVideoAdCache",this.refreshCache),this.on(document,"dataGotMoreTimelineItems",this.timelineAdFetch),this.initialAdFetch()})}var n=i(10),o=i(225),a=i(40),r=i(348),c=i(349),h=n(s,o,a,r,c);t.exports=h}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({emailSettingsLinkSelector:".email-settings-link",phoneSettingsLinkSelector:".phone-settings-link",resendConfirmationEmailLinkSelector:".resend-confirmation-email-link",resetBounceLinkSelector:".reset-bounce-link"}),this.emailSettingsLink=function(){this.trigger("uiClickEmailSettingsLink")},this.phoneSettingsLink=function(){this.trigger("uiClickPhoneSettingsLink")},this.resendConfirmationEmail=function(t,i){this.trigger("uiResendConfirmationEmail",{unsuspend:e(t.target).hasClass("unsuspend-confirmation")})},this.resetBounceLink=function(){this.trigger("uiResetBounceLink")},this.after("initialize",function(){this.on("click",{emailSettingsLinkSelector:this.emailSettingsLink,phoneSettingsLinkSelector:this.phoneSettingsLink,resendConfirmationEmailLinkSelector:this.resendConfirmationEmail,resetBounceLinkSelector:this.resetBounceLink})})}var n=i(10);t.exports=n(s)}).call(e,i(1))},function(t,e,i){function s(){this.resendConfirmationEmail=function(t,e){var i=function(t){this.trigger("uiShowMessage",{message:t.messageForFlash})},s=function(){this.trigger("uiShowMessage",{message:"¡Ups! Hubo un error al mandar tu correo de confirmación."})};this.post({url:"/account/resend_confirmation_email",eventData:null,data:e&&e.unsuspend?{unsuspend:!0}:{},success:i.bind(this),error:s.bind(this)})},this.resetBounceScore=function(){var t=function(){this.trigger("uiShowMessage",{message:"Tus notificaciones por correo electrónico deben reanudarse en breve."})},e=function(){this.trigger("uiShowMessage",{message:"¡Ups! Hubo un error al enviar notificaciones por correo electrónico."})};this.post({url:"/bouncers/reset",eventData:null,data:null,success:t.bind(this),error:e.bind(this)})},this.after("initialize",function(){this.on("uiResendConfirmationEmail",this.resendConfirmationEmail),this.on("uiResetBounceLink",this.resetBounceScore)})}var n=i(10),o=i(225);i(22);t.exports=n(s,o)},function(t,e,i){function s(){this.scribeEmailSettingsClick=function(t,e){this.scribe({page:"self_unsuspend",section:"banner",component:"email_verification",element:"settings",action:"click"})},this.scribePhoneSettingsClick=function(t,e){this.scribe({page:"self_unsuspend",section:"banner",component:"phone_verification",action:"click"})},this.scribeResendConfirmationEmailClick=function(t,e){this.scribe({page:"self_unsuspend",section:"banner",component:"email_verification",element:"resend_confirmation_email",action:"click"})},this.after("initialize",function(){this.on("uiClickEmailSettingsLink",this.scribeEmailSettingsClick),this.on("uiClickPhoneSettingsLink",this.scribePhoneSettingsClick),this.on("uiResendConfirmationEmail",this.scribeResendConfirmationEmailClick)})}var n=i(10),o=i(40);t.exports=n(s,o)},function(t,e,i){function s(){this.scribeOpen=function(t,e){this.scribeEmbedAction("open",e)},this.scribeOembedError=function(t,e){this.scribeEmbedAction("request_failed",e)},this.scribeEmbedCopy=function(t,e){this.scribeEmbedAction("copy",e)},this.scribeEmbedError=function(t,e){this.scribeEmbedAction("embed_request_failed")},this.scribeEmbedAction=function(t,e){this.scribeInteraction(t,r.merge(e,{scribeContext:{component:"embed_tweet_dialog"}}))},this.after("initialize",function(){this.on("uiEmbedRequestFailed",this.scribeEmbedError),this.on("uiNeedsEmbedTweetDialog uiNeedsEmbedVideoDialog",this.scribeOpen),this.on("uiOembedError",this.scribeOembedError),this.on("uiUserCopiedEmbedCode",this.scribeEmbedCopy)})}var n=i(10),o=i(40),a=i(39),r=i(25);t.exports=n(s,o,a)},function(t,e,i){(function(e){function s(){this.defaultAttrs({dialogSelector:"#embed-tweet-dialog",dialogContentSelector:"#embed-tweet-dialog .modal-content",previewContainerSelector:".embed-preview",embedFrameSelector:".embed-preview iframe",visibleEmbedFrameSelector:".embed-preview iframe:visible",embedCodeDestinationSelector:".embed-destination",triggerSelector:".js-embed-tweet",overlaySelector:".embed-overlay",spinnerOverlaySelector:".embed-overlay-spinner",errorOverlaySelector:".embed-overlay-error",tryAgainSelector:".embed-overlay-error .retry-embed",includeParentTweetContainerSelector:".embed-include-parent-tweet",includeParentTweetSelector:".include-parent-tweet",includeCardContainerSelector:".embed-include-card",includeCardSelector:".include-card",embedTweetTitleSelector:".embed-tweet-title",embedVideoTitleSelector:".embed-video-title",embedTweetInstructionsSelector:".embed-tweet-instructions",embedVideoInstructionsSelector:".embed-video-instructions",embedWidth:"469px",top:"90px"}),this.cacheKeyForOptions=function(t){return JSON.stringify(t.data)+t.tweetId},this.cacheKeyChanged=function(t){var e=this.cacheKeyForOptions(t);return e!==this.cacheKeyForOptions(this.getOptions())},this.didReceiveEmbedCode=function(t,e){this.cacheKeyChanged(e.options)||(this.select("overlaySelector").hide(),this.$embedCodeDestination.val(e.data.html),this.trigger(this.$dialog,"uiDialogContentChanged"),this.selectEmbedCode())},this.retryEmbedCode=function(t,e){this.cacheKeyChanged(e)||(this.select("overlaySelector").hide(),this.select("spinnerOverlaySelector").show(),this.trigger("uiOembedError",this.tweetData))},this.failedToReceiveEmbedCode=function(t,e){this.cacheKeyChanged(e)||(this.select("overlaySelector").hide(),this.select("embedCodeDestinationSelector").hide(),this.select("errorOverlaySelector").show(),this.clearOembed(),this.trigger(this.$dialog,"uiDialogContentChanged"))},this.updateEmbedCode=function(){this.select("embedCodeDestinationSelector").show(),this.select("overlaySelector").hide(),this.trigger("uiNeedsOembed",this.getOptions()),this.trigger(this.$dialog,"uiDialogContentChanged")},this.requestTweetEmbed=function(){if(this.widgetsAreLoaded()){var t=this.getOptions(),e=this.cacheKeyForOptions(t);if(this.cachedTweetEmbeds[e])return void this.displayCachedTweetEmbed(e);this.clearTweetEmbed(),"tweet"===this.widgetType?this.widgets.widgets.createTweet(this.tweetId(),this.select("previewContainerSelector")[0],this.receivedTweetEmbed.bind(this,e),{width:this.attr.embedWidth,conversation:t.data.hide_thread?"none":"all",cards:t.data.hide_media?"hidden":"shown",lang:t.data.lang}):"video"===this.widgetType&&this.widgets.widgets.createVideo(this.tweetId(),this.select("previewContainerSelector")[0],this.receivedTweetEmbed.bind(this,e),{width:this.attr.embedWidth,status:"shown"})}},this.clearTweetEmbed=function(){var t=this.select("visibleEmbedFrameSelector");this.stopPlayer(),t.hide()},this.clearOembed=function(){this.$embedCodeDestination.val("")},this.tearDown=function(){this.stopPlayer(),this.clearTweetEmbed(),this.clearOembed();
},this.stopPlayer=function(){var t=this.select("embedFrameSelector");t.each(function(t,i){var s,n=e(i.contentWindow.document),o=n.find("div.media iframe")[0];o&&o.src&&o.src!==document.location.href&&(s=o.src,o.setAttribute("src",""),o.setAttribute("src",s))})},this.displayCachedTweetEmbed=function(t){this.clearTweetEmbed(),e(this.cachedTweetEmbeds[t]).show()},this.receivedTweetEmbed=function(t,e){e?this.cachedTweetEmbeds[t]=e:this.trigger("uiEmbedRequestFailed")},this.embedCodeCopied=function(){this.trigger("uiUserCopiedEmbedCode")},this.includeParentTweet=function(){return this.$includeParentTweet.prop("checked")},this.showCard=function(){return this.$includeCard.prop("checked")},this.getOptions=function(){var t={lang:this.lang};return"tweet"===this.widgetType?(t.hide_thread=!this.includeParentTweet(),t.hide_media=!this.showCard()):"video"===this.widgetType&&(t.widget_type="video"),{data:t,retry:!0,tweetId:this.tweetId(),screenName:this.screenName()}},this.selectEmbedCode=function(){this.$embedCode.select()},this.setUpDialog=function(t,e){this.position(),this.eventData=t,this.tweetData=e,this.toggleIncludeParent(),this.toggleShowCard(),this.toggleTitle(),this.toggleInstructions(),this.resetIncludeParent(),this.resetShowCard(),this.updateEmbedCode(),this.requestTweetEmbed(),this.open(),this.fixPosition(),this.widgetsAreLoaded()||this.getWidgets()},this.setUpDialogForTweet=function(){this.widgetType="tweet",this.setUpDialog.apply(this,arguments)},this.setUpDialogForVideo=function(){this.widgetType="video",this.setUpDialog.apply(this,arguments)},this.fixPosition=function(){this.$dialog.css({position:"relative",top:this.attr.top})},this.resetIncludeParent=function(){var t=this.cacheKeyForOptions(this.getOptions());this.cachedTweetEmbeds[t]||this.$includeParentTweet.prop("checked",!0)},this.resetShowCard=function(){var t=this.cacheKeyForOptions(this.getOptions());this.cachedTweetEmbeds[t]||this.$includeCard.prop("checked",!0)},this.toggleIncludeParent=function(){this.$includeParentCheckboxContainer.toggle("tweet"===this.widgetType&&!!this.tweetHasParent())},this.toggleShowCard=function(){this.$includeCardCheckboxContainer.toggle("tweet"===this.widgetType&&!!this.hasCard())},this.toggleTitle=function(){this.$embedTweetTitle.toggle("tweet"===this.widgetType),this.$embedVideoTitle.toggle("video"===this.widgetType)},this.toggleInstructions=function(){this.$embedTweetInstructions.toggle("tweet"===this.widgetType),this.$embedVideoInstructions.toggle("video"===this.widgetType)},this.tweetId=function(){return this.tweetData.tweetId},this.tweetHasParent=function(){return this.tweetData.hasParentTweet},this.hasCard=function(){return this.getCardDataFromContainer(e(this.eventData.target)).hasCard},this.screenName=function(){return this.tweetData.screenName},this.widgetsReady=function(){this.$dialogContainer&&this.isOpen()&&this.requestTweetEmbed()},this.onOptionChange=function(){this.trigger("uiNeedsOembed",this.getOptions()),this.requestTweetEmbed()},this.restoreFocusToTweet=function(t){e(t.target).is(this.$dialog)&&this.activeEl&&this.trigger(e(this.activeEl).closest(".tweet"),"uiShouldAddFocusStyle")},this.after("initialize",function(){this.$includeParentTweet=this.select("includeParentTweetSelector"),this.$embedCodeDestination=this.select("embedCodeDestinationSelector"),this.$includeParentCheckboxContainer=this.select("includeParentTweetContainerSelector"),this.$includeCard=this.select("includeCardSelector"),this.$includeCardCheckboxContainer=this.select("includeCardContainerSelector"),this.$embedCode=this.select("embedCodeDestinationSelector"),this.$embedTweetTitle=this.select("embedTweetTitleSelector"),this.$embedVideoTitle=this.select("embedVideoTitleSelector"),this.$embedTweetInstructions=this.select("embedTweetInstructionsSelector"),this.$embedVideoInstructions=this.select("embedVideoInstructionsSelector"),this.on(document,"uiNeedsEmbedTweetDialog",this.setUpDialogForTweet),this.on(document,"uiNeedsEmbedVideoDialog",this.setUpDialogForVideo),this.on("uiDialogCloseRequested",this.tearDown),this.on(document,"uiBeforePageChanged",this.tearDown),this.on(document,"uiDialogRestorePreviousFocus",this.restoreFocusToTweet),this.on(document,"dataOembedSuccess",this.didReceiveEmbedCode),this.on(document,"dataOembedError",this.failedToReceiveEmbedCode),this.on(document,"dataOembedRetry",this.retryEmbedCode),this.on(this.$embedCodeDestination,"copy cut",this.embedCodeCopied),this.on(this.$embedCode,"click",this.selectEmbedCode),this.on("click",{tryAgainSelector:this.updateEmbedCode}),this.on("change",{includeParentTweetSelector:this.onOptionChange,includeCardSelector:this.onOptionChange}),this.widgetType="tweet",this.lang=document.documentElement.getAttribute("lang"),this.cachedTweetEmbeds={}})}var n=i(10),o=i(60),a=i(37),r=i(420),c=n(s,o,a,r);t.exports=c}).call(e,i(1))},function(t,e){function i(){this.widgetsAreLoaded=function(){return!(!this.widgets||!this.widgets.init)},this.getWidgets=function(){window.twttr||this.asyncWidgetsLoader(),this.widgets=window.twttr,window.twttr.ready(this._widgetsReady.bind(this))},this._widgetsReady=function(_){this.widgetsReady&&this.widgetsReady()},this.asyncWidgetsLoader=function(){window.twttr=function(t,e,i){var s=t.getElementsByTagName(e)[0];if(!t.getElementById(i)){var n=t.createElement(e);n.id=i,n.src="//platform.twitter.com/widgets.js",s.parentNode.insertBefore(n,s);var o={_e:[],ready:function(t){o._e.push(t)}};return window.twttr||o}}(document,"script","twitter-wjs")}}t.exports=i},function(t,e,i){function s(){this.defaultAttrs({feedbackCookie:"debug_data",data:{}}),this.getFeedbackData=function(t,e){this.trigger("dataFeedback",this.attr.data)},this.toggleFeedbackCookie=function(t,e){var i=!!e.enabled||null;o(this.attr.feedbackCookie,i),this.refreshPage(),this.checkDebugEnabled()},this.refreshPage=function(){document.location.reload(!0)},this.checkDebugEnabled=function(){this.trigger("dataDebugFeedbackChanged",{enabled:!!o(this.attr.feedbackCookie)})},this.addFeedbackData=function(t,e){var i=this.attr.data;for(var s in e)i[s]?i[s]=[].concat.apply(i[s],e[s]):i[s]=e[s]},this.logNavigation=function(t,e){this.addFeedbackData(t,{pushState:[{data:{href:e.href,module:e.module,title:e.title}}]}),e.init_data&&e.init_data.debugData&&this.addFeedbackData(t,e.init_data.debugData.data||{})},this.after("initialize",function(){this.data=this.attr.data||{},this.on("uiNeedsFeedbackData",this.getFeedbackData),this.on("uiToggleDebugFeedback",this.toggleFeedbackCookie),this.on("dataSetDebugData",this.addFeedbackData),this.on("uiPageChanged",this.logNavigation),this.checkDebugEnabled()})}var n=i(10),o=i(52),a=i(225);t.exports=n(s,a)},function(t,e,i){(function(e){function s(){this.defaultAttrs({pastedContentSelector:".feedback-json-output",debugKeySelectorSelector:"select[name=debug-key]",debugDataText:"",dialogToggleSelector:".feedback-dialog .feedback-data-toggle"}),this.toggleDebugEnabled=function(t,i){this.trigger("uiToggleDebugFeedback",{enabled:e(i.el).is(".off")})},this.prepareDialog=function(t,e){this.trigger("uiNeedsFeedbackData")},this.openDialog=function(t,e){this.debugData=e,this.refreshAvailableDataKeys(),this.open()},this.refreshAvailableDataKeys=function(){var t=this.select("debugKeySelectorSelector");t.empty(),Object.keys(this.debugData).forEach(function(i){var s=e("<option>"+i+"</option>");t.append(s)}),this.refreshDebugJSON()},this.refreshDebugJSON=function(t){var e=this.select("debugKeySelectorSelector").val();if(e&&this.debugData[e]){var i=this.debugData[e].map(function(t){return t.data});this.select("pastedContentSelector").html(JSON.stringify(i,void 0,2))}},this.after("initialize",function(){this.on(document,"dataFeedback",this.openDialog),this.on(document,"uiPrepareFeedbackDialog",this.prepareDialog),this.on("change",{debugKeySelectorSelector:this.refreshDebugJSON}),this.on("click",{dialogToggleSelector:this.toggleDebugEnabled})})}var n=i(10),o=i(60);t.exports=n(s,o)}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.tweetHtml={},this.tweetPromotedBadgesHtml={},this.defaultAttrs({profileUser:!1,defaultGalleryTitle:"Galería Multimedia",mediaSelector:".js-adaptive-photo,.tweet-media-img-placeholder,.AdaptiveStreamGridImage,.ProfileAvatar-container,.ProfileCardMini-avatar,.MomentMediaItem-entity--image,.ProfileStreamGridImage",galleryParentSelector:".Gallery",galleryMediaSelector:".Gallery-media",galleryTweetSelector:".GalleryTweet",closeSelector:".js-close, .Gallery-closeTarget",gridSelector:".grid-action",gallerySelector:".Gallery-content",galleryTitleSelector:".modal-title",imageSelector:".media-image",navSelector:".GalleryNav",prevSelector:".GalleryNav--prev",nextSelector:".GalleryNav--next",itemType:"tweet",modalHeaderSelector:".modal-header",tweetlessGalleryClass:"is-tweetless",hasStickersClass:"is-stickers"}),this.isOpen=function(){return this.$node.is(":visible")},this.open=function(t,i){this.calculateScrollbarWidth(),this.fromGrid=i&&!!i.fromGrid,this.title=i&&i.title?i.title:this.attr.defaultGalleryTitle,this.select("galleryTitleSelector").text(this.title),i&&i.showGrid&&i.profileUser?(this.select("gallerySelector").removeClass("no-grid"),this.select("gridSelector").attr("href","/"+i.profileUser.screen_name+"/media"),this.select("gridSelector").find(".visuallyhidden").text(i.profileUser.name),this.select("gridSelector").addClass("js-nav")):(this.select("gallerySelector").addClass("no-grid"),this.select("gridSelector").removeClass("js-nav"));var s=e(t.target).closest(this.attr.mediaSelector);!this.isOpen()&&s.length&&(i&&i.timelineSelector?this.$timeline=s.closest(i.timelineSelector):this.$timeline=s.parent(),this.clearTweet(),a.resetMinSize(this.select("gallerySelector")),this.render(s),e("body").addClass("gallery-enabled"),this.select("gallerySelector").addClass("show-controls"),this.trigger("uiGalleryOpened",i))},this.handleClose=function(t){this.isOpen()&&(this.fromGrid?this.returnToGrid(!0):(t.stopPropagation(),this.closeGallery()))},this.returnToGrid=function(t){this.trigger(this.$current,"uiOpenGrid",{title:this.title,fromGallery:t}),this.closeGallery()},this.closeGallery=function(){e("body").hasClass("gallery-enabled")&&(e("body").removeClass("gallery-enabled"),this.select("galleryMediaSelector").empty(),this.resetStickers(),this.hideNav(),this.enableNav(!1,!1),this.off(window,"resize",this.debouncedResize),delete this.$timeline,delete this.$current,this.trigger("uiGalleryClosed"),this.trigger("uiDialogClosed"))},this.render=function(t){this.resetStickers(),this.$current=t,this.renderNav(),this.trigger(t,"uiGalleryMediaLoad"),this.renderMedia(t)},this.renderNav=function(){if(this.$current){var t,e,i,s;t=this.$timeline.find(this.attr.mediaSelector),s=t.index(this.$current),e=t.slice(0,s),i=t.slice(s+1);var n=i.length>0,o=e.length>0;this.enableNav(n,o),n||o?this.showNav():this.hideNav()}},this.preloadNeighbors=function(t){this.preloadRecursive(t,"next",2),this.preloadRecursive(t,"prev",2)},this.clearTweet=function(){this.select("galleryTweetSelector").empty()},this.flushTweet=function(t){var i=this.getTweetId(e(t.target));i&&delete this.tweetHtml[i]},this.getTweet=function(t){if(t)if(this.tweetHtml[t])this.renderTweet(t,this.tweetHtml[t].tweetHtml,this.tweetHtml[t].tweetStickers);else{this.$current&&this.getTweetId(this.$current)===t&&this.select("galleryMediaSelector").find(".media-image,iframe").hide();var e={id:t,modal:"gallery",hasStickers:r.getDeciderValue("stickersExperience")};this.trigger("uiGetTweet",e)}},this.gotTweet=function(t,e){e.id&&e.tweet_html&&(this.tweetHtml[e.id]={tweetHtml:e.tweet_html,tweetStickers:e.tweet_stickers},e.sourceEventData.promotedBadgeHtml&&(this.tweetPromotedBadgesHtml[e.id]=e.sourceEventData.promotedBadgeHtml),this.renderTweet(e.id,e.tweet_html,e.tweet_stickers))},this.renderTweet=function(t,i,s){if(this.$current&&this.getTweetId(this.$current)===t.toString()){var n=this.select("galleryTweetSelector"),o=this.select("gallerySelector"),r=this.select("galleryMediaSelector").find(".media-image,iframe");n.html(i);var c=this.tweetPromotedBadgesHtml[t];if(c&&n.find(".stream-item-footer").prepend(e(c)),r.length&&(r.show(),a.resizeMedia(r,o,!1,this.attr.galleryTweetSelector)),s){var h=this.$timeline.find(this.attr.mediaSelector),l=h.filter('[data-tweet-id="'+t+'"]');l.length||(l=h.not("[data-tweet-id]"));var d=l.index(this.$current);d>=0&&s[d]&&(this.select("gallerySelector").addClass(this.attr.hasStickersClass),this.replaceMediaWithImageAndStickers(s[d]))}this.trigger("uiNeedUpdateInjectedTweetStats")}},this.getTweetId=function(t){return t.attr("data-status-id")?t.attr("data-status-id"):t.closest("[data-tweet-id]").attr("data-tweet-id")},this.getAllInDir=function(t,i){var s,n="prev"===i?-1:1,o=this.$timeline.find(this.attr.mediaSelector),a=o.index(t)+n;return a>-1&&(s=o.slice(a)),s||e()},this.getInDir=function(t,e){return this.getAllInDir(t,e).first()},this.preloadRecursive=function(t,e,i){if(i&&1!==this.$timeline.find(this.attr.mediaSelector).length){if("next"===e&&this.getAllInDir(t,e).length<i&&!this.$timeline.hasClass("dashboard"))return void this.trigger("uiNearTheBottom");var s=this.getInDir(t,e);if(s&&s.length){s.attr("data-preloading",!0);var n=function(t){s.attr("data-preloaded",!0),this.getTweet(this.getTweetId(s)),this.preloadRecursive(s,e,--i)}.bind(this),a=function(){s.remove(),this.preloadRecursive(s,e,i)}.bind(this);o.load(this.getLargeMediaUrl(s),n,a)}}},this.renderMedia=function(t){t.attr("data-source-url")?this.loadVideo(t):this.loadImage(t),this.preloadNeighbors(t)},this.mediaLoaded=function(t){var e=this.getTweetId(t),i=this.select("gallerySelector");e?(this.getTweet(e),i.closest(this.attr.galleryParentSelector).removeClass(this.attr.tweetlessGalleryClass)):(this.clearTweet(),i.closest(this.attr.galleryParentSelector).addClass(this.attr.tweetlessGalleryClass)),this.trigger("uiGalleryMediaLoaded",{url:this.getLargeMediaUrl(t),id:t.attr("data-status-id")})},this.mediaFailed=function(t){this.trigger("uiGalleryMediaFailed",{url:this.getLargeMediaUrl(t),id:t.attr("data-status-id")}),t.remove(),this.next()},this.loadImage=function(t){this.select("gallerySelector").removeClass(["video","is-hitTesting",this.attr.hasStickersClass].join(" "));var i=t.find("img").attr("alt"),s=e("<img>",{alt:i,addClass:"media-image"});s.on("load",function(e){var i=this.select("gallerySelector");t.attr("loaded",!0),this.select("galleryMediaSelector").html(s),s.attr({"data-height":s[0].height,"data-width":s[0].width}),a.resizeMedia(s,i,!1,this.attr.galleryTweetSelector,!0),this.$current=t,this.mediaLoaded(t)}.bind(this)),s.on("error",function(){this.mediaFailed(t)}.bind(this)),s.attr("src",this.getLargeMediaUrl(t))},this.fixSnappyUrl=function(t){var e=t.attr("data-source-url"),i=/https:\/\/www.snappytv.com\/tc\/(\d+)\?autoplay=true&h=(\d+)&w=(\d+)/;if(i.test(e)){var s=2*t.attr("data-height"),n=2*t.attr("data-width");e=e.replace(i,"https://www.snappytv.com/tc/$1?autoplay=true&h="+s+"&w="+n),t.attr("data-source-url",e)}},this.loadVideo=function(t){var i=e("<iframe>");this.fixSnappyUrl(t),i.height(2*t.attr("data-height")).width(2*t.attr("data-width")).attr("data-height",2*t.attr("data-height")).attr("data-width",2*t.attr("data-width")).attr("src",t.attr("data-source-url")),t.attr("loaded",!0),this.select("galleryMediaSelector").empty().append(i),this.$current=t,this.getTweet(t.attr("data-status-id")),this.select("gallerySelector").addClass("video").removeClass(this.attr.hasStickersClass)},this.prev=function(){this.gotoMedia("prev"),this.trigger("uiGalleryNavigatePrev")},this.next=function(){this.gotoMedia("next"),this.trigger("uiGalleryNavigateNext")},this.gotoMedia=function(t){if(this.$current){var e=this.getInDir(this.$current,t);e.length&&this.render(e)}},this.showNav=function(){this.select("navSelector").show()},this.hideNav=function(){this.select("navSelector").hide()},this.enableNav=function(t,e){t?this.select("nextSelector").addClass("enabled"):this.select("nextSelector").removeClass("enabled"),e?this.select("prevSelector").addClass("enabled"):this.select("prevSelector").removeClass("enabled")},this.getLargeMediaUrl=function(t){var e=t.attr("data-image-url");return t.attr("data-resolved-url-large")||e&&e+":large"},this.throttle=function(t,e,i){var s=!1;return function(){s||(t.apply(i,arguments),s=!0,setTimeout(function(){s=!1},e))}},this.hideControls=function(){this.select("gallerySelector").removeClass("show-controls")},this.after("initialize",function(){this.on("uiReplyToTweet","uiOpenReplyDialog"),this.on("mousemove",this.hideControls),this.on(document,"dataDidDeleteTweet",this.closeGallery),this.on(document,"dataGotMoreMediaTimelineItems",this.renderNav),this.on(document,"uiOpenGallery",this.open),this.on(document,"uiOverlayNavigate uiCloseGallery",this.closeGallery),this.on(document,"uiShortcutEsc",this.handleClose),this.on(window,"popstate",this.closeGallery),this.on(document,"uiShortcutLeft",this.throttle(this.prev,200,this)),this.on(document,"uiShortcutRight",this.throttle(this.next,200,this)),this.on(document,"dataGotTweet",this.gotTweet),this.on(document,"dataFailedToGetTweet",this.clearTweet),this.on("click",{prevSelector:this.prev,nextSelector:this.next,closeSelector:this.handleClose,gridSelector:this.closeGallery}),this.on(document,"uiDidRetweet uiDidUnretweet uiDidFavoriteTweet uiDidUnfavoriteTweet",this.flushTweet)})}var n=(i(22),i(10)),o=i(424),a=i(401),r=i(34),c=i(391),h=i(425),l=i(61),d=i(426),u=i(428),m=n(s,c,l,d,h,u);t.exports=m}).call(e,i(1))},function(t,e,i){(function(e){var s=i(261),n=i(265),o={load:function(t,i,s){function n(t){a=!0,o.unbind("load"),s()}var o=e("<img/>"),a=!1;o.on("load",function(t){a||"error"===t.type||i(o)}),o.on("error",n),o.on("abort",n),o.attr("src",t)},loadMultiple:function(t){var i=s.unique(t);return n.collect(e.map(i,function(t){var i=e.Deferred(),s=e("<img>").on("load",function(t){i.resolve({width:s[0].width,height:s[0].height})}).on("error",function(){i.reject()}).attr("src",t);return i})).then(function(t){var e={};return t.forEach(function(t,s){e[i[s]]=t}),e})}};t.exports=o}).call(e,i(1))},function(t,e,i){(function(e){function s(){n.mixin(this,[o]),this.defaultAttrs({tweetSelector:".tweet",tweetTranslationSelector:".tweet-translation",tweetTranslationTextSelector:".tweet-translation-text",translateTweetSelector:".js-translate-tweet",needsTranslationClass:"needs-translation",permalinkContainerSelector:".permalink-tweet-container",permalinkClass:".permalink-tweet",languageSelector:".tweet-language",galleryTranslateButtonSelector:".Gallery .GalleryTweet .tweet .translate-button",translateButtonSelector:".translate-button",translationFeedbackButtonSelector:".js-translation-feedback-button",translationsLoadingSelector:".tweet-translation-loading"}),this.translateTweet=function(t){var e=this.tweetFromEvent(t);if(e.find(this.attr.tweetTranslationSelector).hasClass(this.attr.needsTranslationClass)){var i=this.interactionData(e);i.dest=e.find(this.attr.tweetTranslationSelector).data("destLang"),e.find(this.attr.translationsLoadingSelector).show(),this.trigger(e,"uiNeedsTweetTranslation",i)}},this.showTranslationFeedbackDialog=function(t){var e=this.tweetFromEvent(t),i=e.find(this.attr.tweetTranslationSelector);this.trigger(e,"uiNeedsTranslationFeedbackDialog",{tweetId:e.data("tweetId"),translation:i.data("translationText"),sourceLang:i.data("sourceLang"),destLang:i.data("destLang")})},this.tweetFromEvent=function(t){return e(t.target).closest(this.attr.tweetSelector)},this.showTweetTranslation=function(t,i){if(this.select("translationsLoadingSelector").hide(),i.item_html){var s=this.findTweetById(e(t.target),i.id_str);s.find(this.attr.translateButtonSelector).hide();var n=s.find(this.attr.tweetTranslationSelector);if(!i.translated_lang)return void s.find(this.attr.translateTweetSelector).hide();n.find(this.attr.languageSelector).html(i.translated_lang),n.data({translationText:i.text,sourceLang:i.source_lang}).removeClass(this.attr.needsTranslationClass).find(this.attr.tweetTranslationTextSelector).html(i.item_html),s.find(this.attr.translateTweetSelector).toArray().forEach(function(t){var i=e(t);i.is(this.attr.galleryTranslateButtonSelector)&&i.hide()},this)}},this.findTweetById=function(t,e){var i=this.tweetSelectorById(e);return t.is(i)?t:t.find(i)},this.tweetSelectorById=function(t){return this.attr.tweetSelector+"[data-tweet-id="+t.replace(/\D/g,"")+"]"},this.showError=function(t,e){this.select("translationsLoadingSelector").hide(),this.trigger("uiShowMessage",{message:"No se pudo traducir este Tweet. Por favor, inténtalo de nuevo más tarde."})},this.after("initialize",function(){this.on("dataTweetTranslationSuccess",this.showTweetTranslation),this.on("dataTweetTranslationError",this.showError),this.on("click",{translationFeedbackButtonSelector:this.showTranslationFeedbackDialog,translateTweetSelector:this.translateTweet})})}var n=i(20),o=i(36);i(22);t.exports=s}).call(e,i(1))},function(t,e,i){(function(e){var s=i(427),n=i(258),o=i(424),a=i(265),r=i(107),c=i(34),h=i(25),l=500;t.exports=function(){this.defaultAttrs({stickerSelector:".StickersMediaImage-stickerImage",stickerLinkSelector:".StickersMediaImage-stickerLink",stickerMediaImageSelector:".StickersMediaImage",hitTestingEnabledClass:"is-hitTesting"}),this.animateSticker=function(t){var i=e(t.target),s="stickerAnimation-"+i.data("animationRefIndex"),n=i.data("currentAnimationPattern");n="a"===n?"b":"a",i.data("currentAnimationPattern",n),s=s+"-"+n,i.css("-webkit-animation-name",s),i.css("animation-name",s)},this.transformSticker=function(t,e){return"matrix("+t.matrix.join(",")+")scale("+e+")"},this.generateStickerDataArray=function(t){var e=this.select("imageSelector").width();this.stickerData=t.map(function(t,i){var s=e*t.aspectRatio;return h.merge({width:e,height:s,halfWidth:e/2,halfHeight:s/2,animationRefIndex:i,matrix:[t.transformA,t.transformB,t.transformC,t.transformD,t.transformTx*e,t.transformTy*s]},t)},this)},this.generateTemplateVariables=function(t,e,i,s){var n=Math.ceil((e.width()-i.width())/2);return{image:t.src,width:t.width,height:t.height,bgWidth:i.width(),bgHeight:i.height(),blackBarWidth:n,stickers:this.stickerData.map(function(t){return h.merge(t,{link:s?"/i/stickers/"+t.id:"",transform:this.transformSticker(t,1)})},this)}},this.renderMainImageAndStickerPlaceholders=function(t,e){this.generateStickerDataArray(e);var i=c.getDeciderValue("stickersInteractivity"),s=this.generateTemplateVariables(t,this.select("galleryMediaSelector"),this.select("imageSelector"),i),n=r["gallery/stickers/stickers_media_image"].render(s,r);this.$current.attr("loaded",!0),this.stickersFirstVisibleTime=Date.now(),this.select("galleryMediaSelector").html(n),this.$stickersContainer=this.select("stickerMediaImageSelector"),c.getDeciderValue("stickersInteractivityDuringLoading")||this.enableHitTesting()},this.detectedBrowser=function(){return s(e.browser).name},this.isNotFirefoxOrIE=function(){var t=this.detectedBrowser();return!("mozilla"===t||"msie"===t)},this.isValidBrowserForSVG=function(){return!(document.implementation&&!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1"))&&this.isNotFirefoxOrIE()},this.hypot=function(t,e){return Math.sqrt(t*t+e*e)},this.getBiggestRasterSticker=function(t){var e=t.images.raster;return e[e.length-1].url},this.findBestsizedRasterSticker=function(t){for(var e=!1,i=t.width*this.hypot(t.matrix[0],t.matrix[2]),s=t.height*this.hypot(t.matrix[1],t.matrix[3]),n=t.images.raster,o=0;o<n.length-1;o++)if(n[o].w>i&&n[o].h>s){e=n[o].url;break}return e?e:this.getBiggestRasterSticker(t)},this.determineStickerUrl=function(t){return this.isValidBrowserForSVG()&&t.images.vector?t.images.vector.url:this.findBestsizedRasterSticker(t)},this.loadStickersAsBlobUrls=function(t,e,i){this.renderMainImageAndStickerPlaceholders(t,e);var s=this.stickerData.map(function(t){return t.url=this.determineStickerUrl(t),t.url}.bind(this)),o=this.$stickersContainer.width(),r=this.$stickersContainer.height();i===this.currentStickerKey&&n.createMapOfBlobUrls(s).then(function(t){i===this.currentStickerKey&&(this.urlToBlobUrlMap=t,a.collect(this.stickerData.map(function(t){return this.generateHitTestPixels(t,o,r,i)},this)).then(function(){this.beginHitTesting()}.bind(this)))}.bind(this))},this.loadMainImageAndStickers=function(t,e,i){o.load(t,function(t){var s=t[0];this.loadStickersAsBlobUrls(s,e,i)}.bind(this))},this.replaceMediaWithImageAndStickers=function(t){var e=this.getLargeMediaUrl(this.$current),i=e+JSON.stringify(t);this.currentStickerKey!==i&&(this.currentStickerKey=i,this.loadMainImageAndStickers(e,t,i))},this.resetStickers=function(){this.lastHitIndex=-1,this.$stickersContainer=null,this.isHitTesting=!1,this.stickerData=[],this.currentStickerKey=null,this.urlToBlobUrlMap&&n.revokeMapOfBlobUrls(this.urlToBlobUrlMap),this.urlToBlobUrlMap=null},this.generateHitTestPixels=function(t,i,s,n){var o=e.Deferred(),a=document.createElement("canvas");a.width=i,a.height=s;var r=new Image;r.onload=function(){var e=a.getContext("2d");e.transform.apply(e,t.matrix),e.drawImage(r,-t.halfWidth,-t.halfHeight,t.width,t.height),t.hitTestPixels=e.getImageData(0,0,i,s),o.resolve(t)},r.onerror=function(){o.reject};var c=this.getBlobUrlForSticker(t);return n!==this.currentStickerKey?o.reject():c?(r.src=this.urlToBlobUrlMap[t.url],o.promise()):o.reject()},this.enableHitTesting=function(){this.select("gallerySelector").addClass(this.attr.hitTestingEnabledClass),this.isHitTesting=!0},this.getBlobUrlForSticker=function(t){return this.urlToBlobUrlMap&&this.urlToBlobUrlMap[t.url]},this.replaceTempImagesWithRealImages=function(){var t=this.select("stickerSelector");t.each(function(t,i){var s=this.stickerData[t],n=this.getBlobUrlForSticker(s);n&&e(i).css("background-image","url("+n+")")}.bind(this))},this.beginHitTesting=function(){this.enableHitTesting(),this.replaceTempImagesWithRealImages();var t=this.select("stickerSelector"),e=Math.max(0,l-(Date.now()-this.stickersFirstVisibleTime));setTimeout(function(){t.trigger("uiAnimateSticker")},e)},this.getStickerHitIndex=function(t){if(!this.$stickersContainer)return-1;var e=this.$stickersContainer[0].getBoundingClientRect(),i=e.bottom-e.top,s=e.right-e.left;if(!s||!i)return-1;var n=this.$stickersContainer.offset(),o=(t.pageX-n.left)/s,a=(t.pageY-n.top)/i;return o<0||o>=1||a<0||a>=1?-1:this.stickerData.reduce(function(t,e,i){var s=e.hitTestPixels;return s&&s.data[4*(Math.floor(o*s.width)+Math.floor(a*s.height)*s.width)+3]?i:t},-1)},this.animateIfHitTestChanged=function(t){if(this.isHitTesting){var e=this.getStickerHitIndex(t);e!==this.lastHitIndex&&(this.lastHitIndex=e,this.select("stickerLinkSelector").css("cursor",e>=0?"pointer":"default"),e>=0&&this.select("stickerSelector").eq(e).trigger("uiAnimateSticker"))}},this.navigateIfHitTestSucceeds=function(t){if(this.isHitTesting){var e=this.getStickerHitIndex(t);e>=0&&this.select("stickerSelector").eq(e).trigger("click")}},this.preventWhenHitTesting=function(t){this.isHitTesting&&t.originalEvent&&(t.stopPropagation(),t.preventDefault())},this.after("initialize",function(){this.resetStickers(),this.on("uiAnimateSticker",{stickerSelector:this.animateSticker}),this.on("mousemove",{stickerMediaImageSelector:this.animateIfHitTestChanged}),this.on("click",{stickerLinkSelector:this.preventWhenHitTesting}),this.on("mouseup",{stickerLinkSelector:this.navigateIfHitTestSucceeds})}),this.before("teardown",this.resetStickers)}}).call(e,i(1))},,function(t,e,i){(function(e){function i(){this.defaultAttrs({requestReplyActivitySelector:"",requestRetweetedActivitySelector:".request-retweeted-popup",requestFavoritedActivitySelector:".request-favorited-popup",requestActivitySelectors:".request-retweeted-popup, .request-favorited-popup",requestTaggingActivitySelector:".request-tagging-popup",targetTweetSelector:".tweet",targetTaggedUsersListSelector:".popup-tagged-users-list",targetTitleSelector:"[data-activity-popup-title]",tweetPivotLinkSelector:".tweet-pivot-link",hiddenClass:"hidden"}),this.requestReplyActivity=function(t){this.trigger("uiRequestReplyActivity")},this.requestRetweetedActivity=function(t){this.requestActivityPopup(t),this.trigger("uiRequestRetweetedActivity")},this.requestFavoritedActivity=function(t){this.requestActivityPopup(t),this.trigger("uiRequestFavoritedActivity")},this.requestTaggingActivity=function(t){this.requestActivityPopup(t),this.trigger("uiRequestTaggingActivity")},this.requestActivityPopup=function(t,i){var s,n=e(t.target),o=n.closest(this.attr.targetTitleSelector).attr("data-activity-popup-title"),a=n.closest(this.attr.targetTweetSelector).attr("data-tweet-id"),r=i?i.usersHtml:null;t.preventDefault(),t.stopPropagation(),s=n.closest(this.attr.requestRetweetedActivitySelector).length?"retweeted_popup":n.closest(this.attr.requestTaggingActivitySelector).length?"media_tagged_popup":"favorited_popup",this.trigger("uiRequestActivityPopup",{titleHtml:o,contentId:a,usersHtml:r,component:s})},this.handleLoggedOutRetweetedActivityClick=function(t,e){this.trigger("uiLoggedOutActionAttempt",{action:"retweeted_activity_attempt"})},this.handleLoggedOutFavoritedActivityClick=function(t,e){this.trigger("uiLoggedOutActionAttempt",{action:"favorited_activity_attempt"})},this.uiOpenSignupDialog=function(t,e,i){this.trigger("uiOpenSignupDialog")},this.uiTweetPivotClick=function(t){var i=e(t.target),s={item_details:{item_type:"0",id:i.attr("data-item-id")},component_details:{id:i.attr("data-entity-id"),name:i.attr("data-name"),description:i.attr("data-id")}};this.trigger("uiTweetPivotClick",s)},this.after("initialize",function(){return this.attr.loggedIn?void this.on("click",{requestReplyActivitySelector:this.requestReplyActivity,requestRetweetedActivitySelector:this.requestRetweetedActivity,requestFavoritedActivitySelector:this.requestFavoritedActivity,requestTaggingActivitySelector:this.requestTaggingActivity,tweetPivotLinkSelector:this.uiTweetPivotClick}):void this.on("click",{requestActivitySelectors:this.uiOpenSignupDialog,requestRetweetedActivitySelector:this.handleLoggedOutRetweetedActivityClick,requestFavoritedActivitySelector:this.handleLoggedOutFavoritedActivityClick,requestTaggingActivitySelector:this.requestTaggingActivity})})}t.exports=i}).call(e,i(1))},function(t,e,i){function s(){this.scribeGalleryOpened=function(t,e){this.scribe({element:"gallery",action:"open"},e)},this.scribeGalleryClosed=function(t,e){this.scribe({element:"gallery",action:"close"},e)},this.scribeGalleryMediaLoaded=function(t,e){var i={url:e.url,item_ids:[e.id]};this.scribe({element:"photo",action:"impression"},e,i)},this.scribeGalleryMediaFailed=function(t,e){var i={url:e.url,item_ids:[e.id]};this.scribe({element:"photo",action:"error"},e,i)},this.scribeGalleryNavigateNext=function(t,e){this.scribe({element:"next",action:"click"},e)},this.scribeGalleryNavigatePrev=function(t,e){this.scribe({element:"prev",action:"click"},e)},this.scribeGridPaged=function(t,e){this.scribe({element:"grid",action:"page"},e)},this.scribeGridOpened=function(t,e){this.scribe({element:"grid",action:"impression"},e)},this.after("initialize",function(){this.on(document,"uiGalleryOpened",this.scribeGalleryOpened),this.on(document,"uiGalleryClosed",this.scribeGalleryClosed),this.on(document,"uiGalleryMediaLoaded",this.scribeGalleryMediaLoaded),this.on(document,"uiGalleryMediaFailed",this.scribeGalleryMediaFailed),this.on(document,"uiGalleryNavigateNext",this.scribeGalleryNavigateNext),this.on(document,"uiGalleryNavigatePrev",this.scribeGalleryNavigatePrev),this.on(document,"uiGridPaged",this.scribeGridPaged),this.on(document,"uiGridOpened",this.scribeGridOpened)})}var n=i(10),o=i(40);t.exports=n(s,o)},function(t,e,i){(function(e){function s(){this.defaultAttrs({birdSelector:"h1.bird-topbar-etched",spinnerContainer:"body",globalHeadingSelector:".global-nav h1",spinnerClass:"pushing-state",spinnerSelector:".pushstate-spinner"}),this.showSpinner=function(t,e){this.select("birdSelector").removeAttr("style"),this.select("spinnerContainer").addClass(this.attr.spinnerClass);
},this.hideSpinner=function(t,e){this.select("spinnerContainer").removeClass(this.attr.spinnerClass)},this.addSpinner=function(){this.select("spinnerSelector").length||e('<div class="pushstate-spinner"></div>').insertAfter(this.select("globalHeadingSelector"))},this.after("initialize",function(){this.on("uiSwiftLoaded",this.addSpinner),this.on("uiShowGlobalLoadingIndicator",this.showSpinner),this.on("uiHideGlobalLoadingIndicator",this.hideSpinner)})}var n=i(10),o=n(s);t.exports=o}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({dropdownId:"swift_autocomplete_dropdown_goto_user",inputSelector:"input.username-input",usernameFormSelector:"form.goto-user-form"}),this.focus=function(){this.select("inputSelector").focus()},this.gotoUser=function(t,e){if(!e||!e.dropdownId||e.dropdownId===this.attr.dropdownId){if(t.preventDefault(),e&&e.item)return this.select("inputSelector").val(e.item.screen_name),void this.trigger("uiNavigate",{href:e.href});var i=this.select("inputSelector").val().trim();"@"===i.substr(0,1)&&(i=i.substr(1)),this.trigger("uiNavigate",{href:"/"+i})}},this.reset=function(){this.select("inputSelector").val(""),this.select("inputSelector").blur(),this.trigger(this.select("inputSelector"),"uiHideAutocomplete")},this.after("initialize",function(){this.on(document,"uiShortcutShowGotoUser",this.open),this.on("uiDialogOpened",this.focus),this.on("uiDialogClosed",this.reset),this.on(this.select("usernameFormSelector"),"submit",this.gotoUser),this.on("uiTypeaheadItemSelected uiTypeaheadSubmitQuery",this.gotoUser),a.attachTo(this.$node,{inputSelector:this.attr.inputSelector}),o.attachTo(this.$node,{inputSelector:this.attr.inputSelector,autocompleteAccounts:!1,datasourceRenders:[["accounts",["accounts"]]],deciders:this.attr.typeaheadData,eventData:{scribeContext:{component:"goto_user_dialog"}}})})}var n=i(10),o=i(279),a=i(294),r=i(60),c=n(s,r);t.exports=c},function(t,e,i){(function(e){function s(){this.defaultAttrs({showShortcutsBtnSelector:"#show-shortcuts-btn",dismissShortcutsBtnSelector:"#dismiss-shortcuts-btn",suppressSRMsgCookie:"suppress_sr_shortcuts_msg",loggedIn:!1,closeOnOtherDialogOpened:!0,keyboardShortcuts:[]}),this.renderSRMessage=function(){if(!e("#kb-shortcuts-msg").length){var t=r.screen_reader_kb_shortcuts_message.render({},r);e(t).insertBefore(document.body.firstChild)}},this.addMessage=function(){a(this.attr.suppressSRMsgCookie)||this.renderSRMessage()},this.removeMessage=function(){e("#kb-shortcuts-msg").remove(),a(this.attr.suppressSRMsgCookie,"1",{expires:1/0})},this.renderShortcutsDialog=function(){if(!e("#keyboard-shortcut-dialog").length){var t={keyboard_shortcuts:this.attr.keyboardShortcuts};e("body").append(r["dialogs/keyboard_shortcuts_dialog"].render(t,r)),this.$dialogContainer=e("#keyboard-shortcut-dialog"),this.$dialog=this.$dialogContainer.find(this.attr.modalSelector)}},this.showShortcutsDialog=function(){this.renderShortcutsDialog(),this.open()},this.after("initialize",function(){this.on(document,"click",{showShortcutsBtnSelector:this.showShortcutsDialog,dismissShortcutsBtnSelector:this.removeMessage}),this.on(document,"uiSwiftLoaded",this.addMessage),this.on(document,"uiOpenKeyboardShortcutsDialog",this.showShortcutsDialog)})}var n=i(10),o=i(60),a=i(52),r=i(107),c=n(s,o);t.exports=c}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({promoCTASelector:".stream-items .leadgen-card-forward .promotion-cta",leadgenDialogIframeSelector:".cards2-promotion-iframe",tweetSelector:".leadgen-card-forward",macawCardsIframeContainerSelector:".js-macaw-cards-iframe-container"});var t={OPEN_DIALOG:"uiOpenLeadGenConfirmDialog",DIALOG_CLOSED:"uiDialogClosed"};this.setUpDialogWithElement=function(t,i){this.$tweet=e(i.el).closest(this.attr.tweetSelector);var s=this.$tweet.closest("[data-impression-id]").attr("data-impression-id"),n=this.$tweet.closest("[data-impression-id]").attr("data-disclosure-type"),o=e(i.el).data("card-url");this.leadgenDialogIframe.attr("src",o),this.setUpDialog(t,this.$tweet,s,n)},this.setUpDialogWithData=function(t,i){this.$tweet=e(this.attr.tweetSelector+"[data-tweet-id="+i.tweetId+"]"),this.macawCardsIframeContainer.attr(this.attr.srcAttr,i.fullCardIframeUrl),this.macawCardsIframeContainer.attr(this.attr.cardUrl,i.cardUrl),this.macawCardsIframeContainer.attr(this.attr.publisherId,i.publisherId),this.macawCardsIframeContainer.attr(this.attr.creatorId,i.creatorId),this.leadgenDialogIframe.hide(),this.macawCardsIframeContainer.length&&(this.createCard(e(this.macawCardsIframeContainer[0].parentElement)||this.$tweet),this.setUpDialog(t,this.$tweet,i.impressionId,i.disclosureType))},this.cleanUpDialog=function(t,e){this.macawCardsIframeContainer.removeData(this.attr.srcDataAttr),this.macawCardsIframeContainer.removeData(this.attr.cardUrlDataAttr),this.macawCardsIframeContainer.removeData(this.attr.publisherIdDataAttr),this.macawCardsIframeContainer.removeData(this.attr.creatorIdDataAttr),this.destroyCard(this.$tweet)},this.after("initialize",function(){this.leadgenDialogIframe=this.select("leadgenDialogIframeSelector"),this.macawCardsIframeContainer=this.select("macawCardsIframeContainerSelector"),this.on(document,"click",{promoCTASelector:this.setUpDialogWithElement}),this.on(document,t.OPEN_DIALOG,this.setUpDialogWithData),this.on(t.DIALOG_CLOSED,this.cleanUpDialog)}),this.setUpDialog=function(t,e,i,s){t.preventDefault(),this.open()}}var n=i(10),o=i(60),a=i(353),r=n(s,o,a);t.exports=r}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({top:90,contentSelector:".list-membership-content",createListSelector:".create-a-list",membershipSelector:".list-membership-container li"}),this.openListMembershipDialog=function(t,e){this.userId=e.userId,this.userId&&this.trigger("uiNeedsListMembershipContent",{userId:this.userId}),this.$content.empty(),this.$node.removeClass("has-content"),this.open()},this.addListMembershipContent=function(t,e){this.$node.addClass("has-content"),this.$content.html(e.html)},this.handleNoListMembershipContent=function(t,e){this.close(),this.trigger("uiShowError",e)},this.toggleListMembership=function(t,i){var s=e(t.target),n={userId:s.closest("[data-user-id]").attr("data-user-id"),listId:s.closest("[data-list-id]").attr("data-list-id")},o=e("#list_"+n.listId);o.is(":visible")&&(o.closest(this.attr.membershipSelector).addClass("pending"),o.data("is-checked")?this.trigger("uiRemoveUserFromList",n):this.trigger("uiAddUserToList",n))},this.updateMembershipState=function(t){return function(i,s){var n=e("#list_"+s.sourceEventData.listId);n.closest(this.attr.membershipSelector).removeClass("pending"),n.attr("checked",t?"checked":null),n.data("is-checked",t),n.attr("data-is-checked",t)}.bind(this)},this.openListCreateDialog=function(){this.close(),this.trigger("uiOpenCreateListDialog",{userId:this.userId})},this.after("initialize",function(){this.$content=this.select("contentSelector"),this.on("click",{createListSelector:this.openListCreateDialog,membershipSelector:this.toggleListMembership}),this.on(document,"uiListAction uiOpenListMembershipDialog",this.openListMembershipDialog),this.on(document,"dataGotListMembershipContent",this.addListMembershipContent),this.on(document,"dataFailedToGetListMembershipContent",this.handleNoListMembershipContent),this.on(document,"dataDidAddUserToList dataFailedToRemoveUserFromList",this.updateMembershipState(!0)),this.on(document,"dataDidRemoveUserFromList dataFailedToAddUserToList",this.updateMembershipState(!1))})}var n=i(10),o=i(60),a=n(s,o);t.exports=a}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({top:90,win:window,saveListSelector:".update-list-button",editorSelector:".list-editor",currentNameSelector:".js-list-details .js-list-name",currentDescSelector:".js-list-details .js-list-desc",nameInputSelector:".list-editor input[name='name']",descriptionSelector:".list-editor textarea[name='description']",privacySelector:".list-editor input[name='mode']"}),this.openListOperationsDialog=function(t,e){e=e||{},this.userId=e.userId,"uiOpenUpdateListDialog"===t.type&&this.modifyDialog(),this.open(),this.$nameInput.focus()},this.modifyDialog=function(){this.$modalTitle=this.select("modalTitleSelector"),this.originalTitle=this.originalTitle||this.$modalTitle.text(),this.$modalTitle.text("Editar lista"),this.$nameInput.val(e(this.attr.currentNameSelector).text().trim()),this.$descriptionInput.val(e(this.attr.currentDescSelector).text().trim()),this.isPublic||(this.$privacyInput[1].checked=!0),this.$saveButton.attr("data-list-id",this.listId).attr("data-operation","update"),this.toggleSaveButtonDisabled(),this.modified=!0,this.$descriptionInput.on("keyup",this.toggleSaveButtonDisabled.bind(this)),this.$privacyInput.on("change",this.toggleSaveButtonDisabled.bind(this))},this.revertModifications=function(){this.modified&&(this.revertDialog(),this.$editor.find("input,textarea").val(""),this.$descriptionInput.off("keyup"),this.$privacyInput.off("change"),this.modified=!1)},this.revertDialog=function(){this.$modalTitle.text(this.originalTitle),this.$saveButton.removeAttr("data-list-id").removeAttr("data-operation"),this.isPublic||(this.$privacyInput[0].checked=!0)},this.saveList=function(t,i){if(!this.requestInProgress){this.requestInProgress=!0;var s=e(i.el),n="update"===s.attr("data-operation")?"uiUpdateList":"uiCreateList",o={name:this.formValue("name"),description:this.formValue("description",{type:"textarea"}),mode:this.formValue("mode",{conditions:":checked"})};"update"===s.attr("data-operation")&&(o=a.merge(o,{list_id:s.attr("data-list-id")})),this.trigger(n,o),this.$saveButton.attr("disabled",!0)}},this.saveListSuccess=function(t,e){this.close();var i="¡Lista guardada!";"dataDidCreateList"===t.type?(i="¡Lista creada!",this.userId?this.trigger("uiOpenListMembershipDialog",{userId:this.userId}):e&&e.slug&&(this.attr.win.location="/"+this.attr.screenName+"/lists/"+e.slug)):this.revertDialog(),this.$editor.find("input:text,textarea").val(""),this.trigger("uiShowMessage",{message:i})},this.saveListComplete=function(t,e){this.requestInProgress=!1,this.toggleSaveButtonDisabled()},this.toggleSaveButtonDisabled=function(t,e){this.$saveButton.attr("disabled",""===this.$nameInput.val())},this.formValue=function(t,e){return e=e||{},e.type=e.type||"input",e.conditions=e.conditions||"",this.$editor.find(e.type+"[name='"+t+"']"+e.conditions).val()},this.disableSaveButton=function(){this.$saveButton.attr("disabled",!0)},this.updateState=function(t,e){this.listId=e.init_data.list_id,this.isPublic=e.init_data.is_public},this.after("initialize",function(){this.listId=this.attr.list_id,this.isPublic=this.attr.is_public,this.$editor=this.select("editorSelector"),this.$nameInput=this.select("nameInputSelector"),this.$descriptionInput=this.select("descriptionSelector"),this.$privacyInput=this.select("privacySelector"),this.$saveButton=this.select("saveListSelector"),this.on("click",{saveListSelector:this.saveList}),this.on("focus blur keyup",{nameInputSelector:this.toggleSaveButtonDisabled}),this.on("uiDialogOpened",this.disableSaveButton),this.on("uiDialogClosed",this.revertModifications),this.on(document,"uiOpenCreateListDialog uiOpenUpdateListDialog",this.openListOperationsDialog),this.on(document,"dataDidCreateList dataDidUpdateList",this.saveListSuccess),this.on(document,"dataDidCreateList dataDidUpdateList dataFailedToCreateList dataFailedToUpdateList",this.saveListComplete),this.on(document,"uiPageChanged",this.updateState)})}var n=i(10),o=i(60),a=(i(22),i(25)),r=n(s,o);t.exports=r}).call(e,i(1))},function(t,e,i){function s(){this.subscribe=function(t,e){var i=this.consumers[e]||[];i.indexOf(t)===-1&&i.push(t),this.consumers[e]=i,this.lpClient.subscribe(e)},this.unsubscribe=function(t,e){var i=this.consumers[e]||[];i=i.filter(function(e){return e!==t}),this.consumers[e]=i,i.length||(this.lpClient.unsubscribe(e),delete this.consumers[e])},this.subUnsubHandler=function(t,e){var i=e.consumer_id,s=e.topic;if(i&&s){var n="dataLPSubscribe"===t.type?this.subscribe:this.unsubscribe,o=Array.isArray(s)?s:[s];o.forEach(n.bind(this,i))}},this.handleVisibilityChange=function(t){"uiPageVisible"===t.type?Object.keys(this.consumers).length&&this.lpClient.reconnect():this.lpClient.close()},this.after("initialize",function(){this.consumers={},this.lpClient=new n,this.lpClient.onMessage(this.trigger.bind(this,"dataLPMessage")),this.on("dataLPSubscribe dataLPUnsubscribe",this.subUnsubHandler),this.on("uiPageVisible uiPageHidden",this.handleVisibilityChange)})}var n=i(437),o=i(10);t.exports=o(s)},function(t,e,i){(function(e){function i(t){t=t||{};var n={urls:{events:t.urls&&t.urls.events||s.urls.events,subscribe:t.urls&&t.urls.subscribe||s.urls.subscribe,unsubscribe:t.urls&&t.urls.unsubscribe||s.urls.unsubscribe},retry:{enabled:void 0===(t.retry&&t.retry.enabled)?s.retry.enabled:t.retry.enabled,backoffFactor:void 0===(t.retry&&t.retry.backoffFactor)?s.retry.backoffFactor:t.retry.backoffFactor,maxDelay:void 0===(t.retry&&t.retry.maxDelay)?s.retry.maxDelay:t.retry.maxDelay},resubPreemptDuration:t.resubPreemptDuration||s.resubPreemptDuration};this.onMessageCallback=n.message,this.onErrorCallback=n.error;var o,a,r,c,h=[],l={},d=!1;this.updateSessionData=function(t){l.sessionId=t.session_id,l.ttl=t.subscription_ttl_millis},this.newEventSource=function(t,e){return new EventSource(t,e)},this.hasSubscribedTopics=function(){return!!h.length},this.openConnection=function(){if(this.hasSubscribedTopics()){var t="?topic="+h.map(encodeURIComponent).join(",");this.close(),o=this.newEventSource(n.urls.events+t,{withCredentials:!0}),o.onmessage=this.messageHandler.bind(this),o.onerror=this.errorHandler.bind(this)}},this.messageHandler=function(t){var e=this.tryParseJSON(t.data);if(e)switch(e.topic){case"/system/config":this.updateSessionData(e.payload.config),d&&this.refreshSubscriptions(),this.resetRetryCount();break;default:this.onMessageCallback&&this.onMessageCallback(e)}},this.errorHandler=function(t){this.close(),this.onErrorCallback&&this.onErrorCallback(t),this.retry()},this.tryParseJSON=function(t){try{return JSON.parse(t)}catch(e){return}},this.subUnsubErrorHandler=function(t){if(400===t.status){var e=this.tryParseJSON(t.responseText),s=e&&e.errors&&e.errors[0];s&&s.code===i.API_ERROR_CODES.SESSION_NOT_FOUND&&this.retry()}},this.resetRetryCount=function(){a=void 0},this.retry=function(){if(n.retry.enabled){a=void 0===a?0:a+1;var t=Math.random()*(Math.pow(2,a)-1)*n.retry.backoffFactor,e=Math.min(t,n.retry.maxDelay);r=setTimeout(this.openConnection.bind(this),e)}},this.refreshSubscriptions=function(){return this.connectionStatus()===i.CONNECTING?void(d=!0):l.sessionId&&this.connectionStatus()!==i.CLOSED?void(h.length&&(d=!1,e.ajax({method:"POST",url:n.urls.subscribe,data:{session_id:l.sessionId,topic:h.join(",")},headers:{"LivePipeline-Session":l.sessionId},xhrFields:{withCredentials:!0},success:function(){this.resetRetryCount(),clearTimeout(c),c=setTimeout(this.refreshSubscriptions.bind(this),Math.max(0,l.ttl-n.resubPreemptDuration))}.bind(this),error:this.subUnsubErrorHandler.bind(this)}))):void this.openConnection()},this.subscribe=function(t){var e=h.indexOf(t)===-1,s=e||this.connectionStatus()===i.CLOSED;e&&h.push(t),s&&this.refreshSubscriptions()},this.unsubscribe=function(t){h.indexOf(t)!==-1&&(h=h.filter(function(e){return t!==e}),l.sessionId&&(h.length?e.ajax({method:"POST",url:n.urls.unsubscribe,data:{session_id:l.sessionId,topic:t},xhrFields:{withCredentials:!0}}):this.close()))},this.onMessage=function(t){this.onMessageCallback=t},this.onError=function(t){this.onErrorCallback=t},this.connectionStatus=function(){return o?o.readyState:i.CLOSED},this.reconnect=this.openConnection.bind(this),this.close=function(){o&&o.close(),l={},o=void 0,clearTimeout(r),clearTimeout(c)}}var s={urls:{events:"https://api.twitter.com/live_pipeline/events",subscribe:"/i/live_pipeline/subscribe",unsubscribe:"/i/live_pipeline/unsubscribe"},retry:{enabled:!0,backoffFactor:500,maxDelay:12e4},resubPreemptDuration:25e3};i.isSupported=function(){return"EventSource"in window},i.OPEN=i.isSupported()&&EventSource.OPEN,i.CLOSED=i.isSupported()&&EventSource.CLOSED,i.CONNECTING=i.isSupported()&&EventSource.CONNECTING,i.API_ERROR_CODES={SESSION_NOT_FOUND:392};var n=function(t){var e=new i(t);this.subscribe=e.subscribe.bind(e),this.unsubscribe=e.unsubscribe.bind(e),this.connectionStatus=e.connectionStatus.bind(e),this.reconnect=e.reconnect.bind(e),this.close=e.close.bind(e),this.onMessage=e.onMessage.bind(e),this.onError=e.onError.bind(e),this.__privateInstance=e};n.isSupported=i.isSupported,n.OPEN=i.OPEN,n.CLOSED=i.CLOSED,n.CONNECTING=i.CONNECTING,n.API_ERROR_CODES=i.API_ERROR_CODES,n.__privateObject=i,t.exports=n}).call(e,i(1))},function(t,e,i){function s(){var t="/i/locations/share";this.defaultAttrs({locationPickerIframeSelector:".LocationPickerDialog-iframe"}),this.openDialog=function(e,i){var s=i&&i.src||t;this.attr.loggedIn?(this.select("locationPickerIframeSelector").attr("src",s),this.open()):this.trigger(document,"uiOpenSignupDialog")},this.after("initialize",function(){this.on(document,"uiLocationQRCtaClicked uiLocationAttachmentClicked",this.openDialog)})}var n=i(10),o=i(60),a=i(68),r=n(s,o,a);t.exports=r},function(t,e,i){(function(e){function s(){this.defaultAttrs({applyButtonSelector:".MediaEditDialog-applyAltTextButton",altTextTextareaSelector:".MediaEditDialog-altTextTextarea",doneTargetSelector:".js-done",closeTargetSelector:".js-close",photoContainerSelector:".MediaEditDialog-photoContainer",videoTrimSelector:".VideoTrim",videoTitleSelector:".MediaEditForm-title",videoDescriptionSelector:".MediaEditForm-description",videoCtaSelectSelector:".MediaEditForm-ctaSelect",videoCtaUrlSelector:".MediaEditForm-ctaUrl",videoEmbeddableSelector:".MediaEditForm-embeddable",videoTitleCharCounterSelector:".MediaEditForm-titleCharCounter",videoDescriptionCharCounterSelector:".MediaEditForm-descriptionCharCounter",videoTitleMaxLength:70,videoDescriptionMaxLength:200}),this.fileId=0,this.renderMediaEditDialog=function(t){var e=this.advancedVideoFeatures,i=t.advanced||{},s={alt_text:t.altText,can_compose_alt_text:this.canComposeAltText(),has_cta:""!==i.ctaType,is_cta_visit_site:"visit_site"===i.ctaType,is_cta_watch_now:"watch_now"===i.ctaType,is_gif:this.isGif,is_photo:this.isPhoto,is_video:this.isVideo,is_video_embeddable:i.embeddable||"undefined"==typeof i.embeddable,title:this.getTitle(),video_ctl_url:i.ctaUrl,video_title:i.title,video_description:i.description,whitelisted_video_user:e},o=h["dialogs/media_edit_dialog"].render(s,h);this.$node.html(o),this.$dialog=this.$dialogContainer.find(this.attr.modalSelector),this.isVideo&&(this.attachChild(u,this.select("videoTrimSelector"),{maxSelectionDuration:l.getDeciderValue("maxVideoDuration")||I,maxVisibleDuration:1.2*(l.getDeciderValue("maxVideoDuration")||I),defaultSelectionDuration:l.getDeciderValue("defaultVideoDuration")||D}),e&&(this.attachChild(n,this.select("videoTitleCharCounterSelector"),{maxLength:this.attr.videoTitleMaxLength}),this.attachChild(n,this.select("videoDescriptionCharCounterSelector"),{maxLength:this.attr.videoDescriptionMaxLength})))},this.openMediaEditDialog=function(t,e){var i=e.fileId,s=c.get(i);if(s&&(this.fileId=i,this.isVideo=s.isVideo,this.isGif=s.isGif,this.isImage=s.isImage,this.composeAltText=e.composeAltText,this.advancedVideoFeatures=l.getDeciderValue("web_upload_video_advanced"),this.renderMediaEditDialog(s),this.open(),this.loadMedia(s),this.canComposeAltText())){var n=this.select("altTextTextareaSelector")[0],o=n.value;this.initialAltText=o,this.resizeAltTextInput(),n.selectionStart=n.selectionEnd=o.length}},this.loadMedia=function(t){this.isVideo?(this.loadVideo(t),this.trigger(this.select("videoTitleCharCounterSelector"),"uiCharacterCounterUpdate"),this.trigger(this.select("videoDescriptionCharCounterSelector"),"uiCharacterCounterUpdate")):this.loadPhoto(t.thumbnail.src)},this.loadVideo=function(t){this.mediaObjectUrl=a.getObjectUrl(t.fileHandle),this.trigger(this.select("videoTrimSelector"),"uiLoadVideo",{videoSrc:this.mediaObjectUrl,initialTrimRange:t.trimRange}),e(document).trigger("uiPauseAllMedia")},this.sizeAndPosition=function(){var t=this.select("photoContainerSelector").find("img");r.resetMinSize(this.$dialog),r.resizeMedia(t,this.$dialog,!1,".modal-footer",!1),this.position()},this.loadPhoto=function(t){var i=e("<img>",{"class":"MediaEditDialog-photo",src:t,on:{load:this.sizeAndPosition.bind(this)}});this.select("photoContainerSelector").html(i)},this.expandVideoDescription=function(){var t=3,e=parseInt(this.select("videoDescriptionSelector").css("line-height"))*t;this.off(this.select("videoDescriptionSelector"),"focus",this.expandVideoDescription),this.select("videoDescriptionSelector").height(e)},this.canComposeAltText=function(){return!this.isVideo&&!this.isGif&&this.composeAltText},this.getTitle=function(){var t;return this.isVideo?t=this.advancedVideoFeatures?S:w:this.isGif?t=b:this.isImage&&(t=this.canComposeAltText()?y:C),t},this.displayVideoCtaUrl=function(){var t=""===this.select("videoCtaSelectSelector").val();this.select("videoCtaSelectSelector").toggleClass("u-inactive",t),this.select("videoCtaUrlSelector").toggleClass("u-hidden",t),t?this.select("videoCtaUrlSelector").removeAttr("data-valid"):(this.validateVideoCtaUrl(),this.select("videoCtaUrlSelector").focus()),this.trigger("uiValidateForm")},this.validateForm=function(){var t=this.isValidInput("videoCtaUrlSelector"),e=this.isValidInput("videoTitleSelector")&&this.isValidInput("videoDescriptionSelector")&&t;return e?this.select("doneTargetSelector").removeAttr("disabled"):(this.select("doneTargetSelector").attr("disabled",""),!t&&this.select("videoCtaUrlSelector").val().length&&(this.trigger(document,"uiShowMessage",{message:v}),this.select("videoCtaUrlSelector").focus())),e},this.isValidInput=function(t){return"false"!==this.select(t).attr("data-valid")},this.validateVideoCtaUrl=function(){var t=this.select("videoCtaUrlSelector").val(),e=this.isValidUrl(t);return this.select("videoCtaUrlSelector").attr("data-valid",e),this.trigger("uiValidateForm"),e},this.isValidUrl=function(t){return f.test(t.trim())},this.notifyEditDone=function(){this.trigger("uiMediaEditDialogDone",{fileId:this.fileId})},this.updateVideoInfo=function(t,e){var i=d.merge(e,{duration:t.trimEnd-t.trimStart});return c.update(t.fileId,i)},this.editDone=function(){var t=this.isVideo,e=t?{trimStart:this.trimStart,trimEnd:this.trimEnd,trimRange:this.trimRange}:{},i=t&&this.advancedVideoFeatures?{advanced:{title:this.select("videoTitleSelector").val(),description:this.select("videoDescriptionSelector").val(),ctaType:this.select("videoCtaSelectSelector").val(),ctaUrl:this.select("videoCtaUrlSelector").val(),embeddable:this.select("videoEmbeddableSelector").is(":checked")}}:{},s=this.canComposeAltText()?{altText:(this.select("altTextTextareaSelector").val()||"").trim()}:{},n=d.merge(e,i,s),o=c.update(this.fileId,n);t?a.getVideoInfo(o.fileHandle,this.trimStart).then(this.updateVideoInfo.bind(this,o)).then(this.notifyEditDone.bind(this)):this.notifyEditDone()},this.closeMediaEditDialog=function(t,i){this.isVideo&&(this.trigger(this.select("videoTrimSelector"),"uiUnloadVideo"),this.mediaObjectUrl&&(a.revokeObjectUrl(this.mediaObjectUrl),this.mediaObjectUrl=null)),this.canComposeAltText()&&this.select("altTextTextareaSelector").val(""),this.close(),this.activeEl?e(this.activeEl).closest(".tweet-form, .modal").find(".tweet-box").focus():this.restorePreviousFocus()},this.updateTrimRange=function(t,e){this.trimStart=e.trimStart,this.trimEnd=e.trimEnd,this.trimRange=e.trimRange},this.resizeAltTextInput=function(t){var e=this.select("altTextTextareaSelector"),i=e[0],s=e.innerHeight()-e.height(),n=this.select("applyButtonSelector"),o=n.outerHeight()-4;e.height(1);var a=Math.max(i.scrollHeight,o);e.height(Math.min(a-s,T)),i.style.display="none",i.offsetHeight,i.style.display=""},this.toggleApplyButtonState=function(t){var i=e(t.target).val();this.select("applyButtonSelector").prop("disabled",!(this.initialAltText!==i))},this.after("initialize",function(){this.on(document,"uiOpenMediaEditDialog",this.openMediaEditDialog),this.on("uiShortcutEsc uiDialogClosed uiMediaEditDialogDone",this.closeMediaEditDialog),this.on("uiTrimRangeChanged",this.updateTrimRange),this.on("click",{doneTargetSelector:this.editDone,closeTargetSelector:this.closeMediaEditDialog}),this.on("uiShortcutCmdEnter",this.editDone),this.on("change",{videoTitleSelector:this.validateForm,videoDescriptionSelector:this.validateForm,videoCtaSelectSelector:this.displayVideoCtaUrl,videoCtaUrlSelector:this.validateVideoCtaUrl}),this.on("input",{altTextTextareaSelector:this.toggleApplyButtonState}),this.on("uiValidateForm",this.validateForm),this.on("focusin",{videoDescriptionSelector:this.expandVideoDescription}),this.on("input",{altTextTextareaSelector:this.resizeAltTextInput})})}var n=i(440),o=i(10),a=i(258),r=i(401),c=i(209),h=i(107),l=i(34),d=i(25),u=i(441),m=i(60),p=i(215),g=(i(22),o(s,m,p,n)),f=/^(https?:\/\/)?[a-z0-9-\.]+\.[a-z]+\/?([^\s<>#%",\{\}\\|\\\^\[\]`]+)?$/,v="La URL no es válida",S="Editar",w="Recortar",b="Archivo GIF",C="Imagen",y="Descripción de la imagen",T=60,D=20,I=30;t.exports=g}).call(e,i(1))},function(t,e,i){function s(){this.attributes({maxLength:null}),this.render=function(){var t=!this.maxLengthExceeded();this.$node.toggleClass("is-maxExceeded",!t),this.$input.attr("data-valid",t),this.$counter.text(this.getRemainingLength())},this.maxLengthExceeded=function(){return this.getRemainingLength()<0},this.getRemainingLength=function(){var t=this.getLength(this.$input.val());return this.attr.maxLength-t},this.getLength=function(t){return t.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x").length},this.after("initialize",function(){this.$input=this.$node.find(".CharCounter-target"),this.$counter=this.$node.find(".CharCounter-counter"),this.render(),this.on(this.$input,"input",this.render),this.on("uiCharacterCounterUpdate",this.render)})}var n=i(10),o=n(s);t.exports=o},function(t,e,i){(function(e){function s(){var t=0,i=1,s=2,n=3,o=4;this.defaultAttrs({timeBubbleSelector:".VideoTrim-timeBubble",timelineSelector:".VideoTrim-timeline",timelineCursorSelector:".VideoTrim-timelineCursor",scrubberSelector:".VideoTrim-scrubber",unplayedScrubberSelector:".VideoTrim-unplayedScrubber",timeSelector:".VideoTrim-time",widestTimeSelector:".VideoTrim-widestTime",selectionSelector:" .VideoTrim-selection",ticksSelector:".VideoTrim-ticks",innerSelectionSelector:".VideoTrim-innerSelection",leftHandleSelector:".VideoTrim-leftHandle",midHandleSelector:".VideoTrim-midHandle",midHandleCursorSelector:".VideoTrim-midHandleCursor",rightHandleSelector:".VideoTrim-rightHandle",shroudSelector:".VideoTrim-shroud",minSelectionDuration:1,maxSelectionDuration:30,maxVisibleDuration:36,defaultSelectionDuration:20,scrollPixels:20,timeToFadeOutBubble:1e3,pixelsBeforeWarningLength:50,maxPixelsPerSecond:30,widthForHandles:42,minWidthForMidHandle:18,dragScrollRepeatInterval:30}),this.setInitialTrimRange=function(t,e){this.initialTrimRange=e.initialTrimRange},this.initAfterVideoLoads=function(){if(""===this.initialTrimRange)this.startTime=0,this.endTime=this.videoDuration;else if(this.initialTrimRange){var t=this.initialTrimRange.split("-");this.startTime=+t[0],this.endTime=+t[1]}else this.startTime=(this.videoDuration-this.attr.defaultSelectionDuration)/2,this.endTime=this.startTime+this.attr.defaultSelectionDuration;this.startTime=this.clamp(this.startTime,0,this.videoDuration),this.endTime=this.clamp(this.endTime,0,this.videoDuration),this.visibleWidth=this.$node.width()-this.attr.widthForHandles,this.defaultPixelsPerSecond=this.visibleWidth/Math.min(this.videoDuration,this.attr.maxVisibleDuration),this.timelinePixelsPerSecond=this.$timeline.width()/this.videoDuration,this.generateTicks(),this.zoomToDefault(),this.showSelectionBubble(),this.playVideo(this.startTime),this.notifyTrimRange()},this.generateTicks=function(){for(var t="",e=0;e<this.videoDuration;e+=1){var i=(100*e/this.videoDuration).toFixed(4),s=e%60?"":a.formatDuration(e);t+='<div style="left:'+i+'%">'+s+"</div>"}this.$ticks.html(t)},this.calculateScale=function(){this.offset=-this.$selection.position().left,this.pixelsPerSecond=this.$innerSelection.width()/this.videoDuration,this.percentPerSecond=100/this.videoDuration,this.minTimeForScrolling=(this.offset-this.attr.scrollPixels)/this.pixelsPerSecond,this.maxTimeForScrolling=(this.offset+this.attr.scrollPixels+this.visibleWidth)/this.pixelsPerSecond},this.formatTimeProgress=function(t){return a.formatDuration(t)+" / "+a.formatDuration(this.videoDuration)},this.updatePositions=function(){if(this.$mid.toggle(!!this.videoDuration),this.videoDuration){this.calculateScale(),this.$mid.css({left:this.startTime*this.percentPerSecond+"%",width:(this.endTime-this.startTime)*this.percentPerSecond+"%"});var t=Math.min(-1,((this.endTime-this.startTime)*this.pixelsPerSecond-this.attr.minWidthForMidHandle)/2);this.$midHandleCursor.css({left:t,right:t});var e=this.isProgressVisible?Math.max(100*(this.getVideoCurrentTime()-this.startTime)/(this.endTime-this.startTime),0):0;this.$unplayedScrubber.css("left",e+"%"),this.$scrubber.css({left:this.startTime*this.percentPerSecond+"%",right:100-this.endTime*this.percentPerSecond+"%"}),this.$widestTime.text(this.formatTimeProgress(this.videoDuration)),this.$time.text(this.formatTimeProgress(this.getVideoCurrentTime())),this.select("timelineSelector"),this.updateBubblePos()}},this.showSelectionBubble=function(){var t=Math.max(this.selectionDuration(),this.attr.minSelectionDuration);this.setBubble(this.formatTimeForSelection(t),"mid")},this.setEndBubbleWhileDragging=function(){this.dragMode===n?this.setBubble(a.formatDuration(this.endTime),"right"):this.setBubble(a.formatDuration(this.startTime),"left")},this.selectionDuration=function(){return this.endTime-this.startTime},this.isMaxSelected=function(){return this.selectionDuration()>=this.attr.maxSelectionDuration},this.isMinSelected=function(){return this.selectionDuration()<=this.attr.minSelectionDuration},this.formatTimeForSelection=function(t){var e=Math.floor(t/60),i=Math.floor(t%60),s="abbreviated";this.timespanFormatter.patterns.none.minute.abbreviated||(s="short");var n={minutesWithAbbreviation:this.timespanFormatter.format(60*e,{direction:"none",type:s,unit:"minute"}),secondsWithAbbreviation:this.timespanFormatter.format(i,{direction:"none",type:s,unit:"second"})};return this.isMaxSelected()?e?_("{{minutesWithAbbreviation}} {{secondsWithAbbreviation}} máx. seleccionados",n):_("{{secondsWithAbbreviation}} máx. seleccionado",n):this.isMinSelected()?_("{{secondsWithAbbreviation}} mín. seleccionado",n):e?_("{{minutesWithAbbreviation}} {{secondsWithAbbreviation}} seleccionados",n):_("{{secondsWithAbbreviation}} seleccionados",n)},this.setBubble=function(t,e){this.bubbleMode=e,this.bubbleWidth=this.$timeBubble.attr("data-mode",e||"").text(t||"").css("opacity",0).show().outerWidth(),this.updateBubblePos(),this.$timeBubble.css("opacity",1).delay(this.attr.timeToFadeOutBubble).fadeOut(500)},this.updateBubblePos=function(){var t,e,i=null;switch(this.bubbleMode){case"left":t=0,e=0;break;case"right":t=100,e=-this.bubbleWidth;break;case"mid":t=50;var s=(this.startTime+this.endTime)*this.timelinePixelsPerSecond/2;s<this.bubbleWidth/2?(e=-15,i="left"):s>this.videoDuration*this.timelinePixelsPerSecond-this.bubbleWidth/2?(e=23-this.bubbleWidth,i="right"):e=-this.bubbleWidth/2;break;default:return}this.$timeBubble.css({left:t+"%","margin-left":e}),i?this.$timeBubble.attr("data-clip",i):this.$timeBubble.removeAttr("data-clip")},this.setSelectionView=function(t,e){e?this.$selection.width(e+this.attr.widthForHandles):e=this.$innerSelection.width(),this.$selection.css("left",-this.clamp(t,0,e-this.visibleWidth)),this.updatePositions()},this.zoomToDefault=function(){var t=this.defaultPixelsPerSecond*this.videoDuration,e=(this.defaultPixelsPerSecond*(this.startTime+this.endTime)-this.visibleWidth)/2;
e=this.clamp(e,0,t-this.visibleWidth),this.setSelectionView(e,t)},this.playLastFewSeconds=function(t){this.playVideo(t?Math.max(this.endTime-3,this.startTime):this.startTime),this.updatePositions()},this.beginDrag=function(t,e){if(this.$shroud.toggleClass("is-sideways",t===i||t===n),this.dragMode=t,this.dragStartX=e.clientX,this.dragDirty=!1,this.dragStartOffset=this.offset,this.dragHandlesInView=[t===i||t===o,t===n||t===o],t===o){var s=(e.clientX-this.$timeline.offset().left)/this.timelinePixelsPerSecond;if(s<this.startTime||s>this.endTime){var a=this.endTime-this.startTime;this.startTime=this.clamp(s,0,this.videoDuration-a),this.endTime=this.startTime+a}this.$shroud.show(),this.zoomToDefault()}this.$mid.addClass("is-active"),this.isVideoPlaying()||this.setDragPause(),this.updatePositions(),this.setEndBubbleWhileDragging()},this.drag=function(e){if(this.dragMode!==t){var i=window.getSelection();i&&i.removeAllRanges(),clearTimeout(this.dragTimeoutId);var n=!1;this.$shroud.show(),this.calculateScale(),this.dragMode===s&&(this.dragHandlesInView=this.dragHandlesInView.map(function(t,e){return t||0===this.scrollShiftForHandle(e)},this));var a,r=e.clientX-this.dragStartX;this.dragMode===o?a=this.timelinePixelsPerSecond:(a=this.pixelsPerSecond,r+=this.offset-this.dragStartOffset);var c=this.applyDrag(r/a)*a;c?(this.dragDirty=!0,this.updatePositions(),this.dragStartX+=c,this.setDragPause(),this.setEndBubbleWhileDragging()):Math.abs(r)>this.attr.pixelsBeforeWarningLength&&(this.isMaxSelected()||this.isMinSelected())&&this.showSelectionBubble(),this.dragMode===o?this.zoomToDefault():this.dragHandlesInView.forEach(function(t,e){if(t){var i=this.scrollShiftForHandle(e);i&&(this.setSelectionView(this.offset+i),n=!0)}},this),n&&(this.dragTimeoutId=setTimeout(this.drag.bind(this,e),this.attr.dragScrollRepeatInterval))}},this.endDrag=function(){if(this.dragMode){this.$shroud.hide(),this.updatePositions();var e=this.dragMode===n;this.dragDirty&&this.showSelectionBubble(),this.isVideoPlaying()?this.doubleClickTimeoutId||(this.doubleClickTimeoutId=setTimeout(function(){this.doubleClickTimeoutId=null,this.playLastFewSeconds(e)}.bind(this),300)):this.playLastFewSeconds(e),this.$mid.removeClass("is-active"),this.dragMode=t,clearTimeout(this.dragTimeoutId),this.notifyTrimRange()}},this.setDragPause=function(t){this.pauseVideo(this.dragMode===n?this.endTime:this.startTime)},this.calculateDrag=function(t,e,s){return t=this.clamp(t+e,0,this.videoDuration),this.dragMode===i?t=this.clamp(t,this.endTime-this.attr.maxSelectionDuration,this.endTime-this.attr.minSelectionDuration):this.dragMode===n&&(t=this.clamp(t,this.startTime+this.attr.minSelectionDuration,this.startTime+this.attr.maxSelectionDuration)),this.dragMode!==o&&this.dragHandlesInView[s]&&(t=this.clamp(t,this.minTimeForScrolling,this.maxTimeForScrolling)),t},this.applyDragLeft=function(t){var e=this.startTime;return this.startTime=this.calculateDrag(this.startTime,t,0),this.startTime-e},this.applyDragRight=function(t){var e=this.endTime;return this.endTime=this.calculateDrag(this.endTime,t,1),this.endTime-e},this.applyDrag=function(t){return this.dragMode===i?this.applyDragLeft(t):this.dragMode===n?this.applyDragRight(t):t<0?this.applyDragRight(this.applyDragLeft(t)):this.applyDragLeft(this.applyDragRight(t))},this.scrollShiftForHandle=function(t){var e=(t?this.endTime:this.startTime)*this.pixelsPerSecond;return this.clamp(this.offset,e-this.visibleWidth,e)-this.offset},this.hoverSideHandle=function(i){this.dragMode===t&&e(i.target).toggleClass("is-hover","mouseenter"===i.type)},this.hoverMidHandle=function(e){this.dragMode===t&&this.$left.add(this.$right).toggleClass("is-hover","mouseenter"===e.type)},this.hoverSelectionBubble=function(){this.dragMode===t&&this.showSelectionBubble()},this.notifyTrimRange=function(){var t=this.endTime-this.startTime>this.videoDuration-.01;this.trigger("uiTrimRangeChanged",{trimStart:this.startTime,trimEnd:this.endTime,trimRange:t?"":this.startTime.toFixed(3)+"-"+this.endTime.toFixed(3)})},this.clamp=function(t,e,i){return Math.max(e,Math.min(i,t))},this.after("initialize",function(){this.timespanFormatter=new r.TimespanFormatter,this.dragMode=t,this.$timeBubble=this.select("timeBubbleSelector"),this.$timeline=this.select("timelineSelector"),this.$scrubber=this.select("scrubberSelector"),this.$unplayedScrubber=this.select("unplayedScrubberSelector"),this.$time=this.select("timeSelector"),this.$widestTime=this.select("widestTimeSelector"),this.$selection=this.select("selectionSelector"),this.$ticks=this.select("ticksSelector"),this.$innerSelection=this.select("innerSelectionSelector"),this.$left=this.select("leftHandleSelector"),this.$mid=this.select("midHandleSelector"),this.$midHandleCursor=this.select("midHandleCursorSelector"),this.$right=this.select("rightHandleSelector"),this.$shroud=this.select("shroudSelector"),this.on("uiLoadVideo",this.setInitialTrimRange),this.on("uiVideoLoaded uiVideoUnloaded",this.initAfterVideoLoads),this.on("uiVideoStateChanged",this.updatePositions),this.on("mousedown",{leftHandleSelector:this.beginDrag.bind(this,i),rightHandleSelector:this.beginDrag.bind(this,n),midHandleCursorSelector:this.beginDrag.bind(this,s),timelineSelector:this.beginDrag.bind(this,o)}),this.on(window,"mousemove",this.drag),this.on(window,"mouseup",this.endDrag),this.on(this.$midHandleCursor,"mouseenter mouseleave",this.hoverMidHandle),this.on(this.$right.add(this.$left),"mouseenter mouseleave",this.hoverSideHandle),this.on(this.select("timelineCursorSelector").add(this.$mid),"mouseenter",this.hoverSelectionBubble)})}var _=i(22),n=i(10),o=i(442),a=i(267),r=i(343);t.exports=n(s,o)}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({videoSelector:".VideoTrim-video",playStateSelector:".VideoTrim-playState",audioStateSelector:".VideoTrim-audioState",isPlayingClass:"is-playing",isMutedClass:"is-muted",playVideoPollFreq:30}),this.loadVideo=function(t,e){this.videoDuration=0,this.video.pause(),this.video.src=e.videoSrc,this.video.load()},this.unloadVideo=function(){this.loadVideo(null,{videoSrc:""})},this.playVideo=function(t){void 0!==t&&this.setVideoCurrentTime(t),this.isVideoPlaying()||(clearInterval(this.playbackIntervalId),this.playbackIntervalId=setInterval(function(){this.video.paused?this.pauseVideo():this.isVideoAtEnd()&&this.pauseVideo(this.endTime),this.updateVideoState()}.bind(this),1e3/this.attr.playVideoPollFreq),this.video.play(),this.isProgressVisible=!0)},this.pauseVideo=function(t){this.video.pause(),clearInterval(this.playbackIntervalId),void 0!==t&&(this.isProgressVisible=!1,this.setVideoCurrentTime(t)),this.updateVideoState()},this.isVideoPlaying=function(){return!this.video.paused&&this.video.currentTime>0},this.setVideoMuted=function(t){this.video.muted=t},this.isVideoMuted=function(){return this.video.muted},this.isVideoAtEnd=function(){var t=1/this.attr.playVideoPollFreq;return this.getVideoCurrentTime()>this.endTime-t||this.video.ended},this.getVideoCurrentTime=function(){return this.video.currentTime},this.setVideoCurrentTime=function(t){this.video.currentTime=t},this.updateVideoState=function(){this.$node.toggleClass(this.attr.isPlayingClass,this.isVideoPlaying()).toggleClass(this.attr.isMutedClass,this.isVideoMuted()),this.trigger("uiVideoStateChanged")},this.readVideoMetadata=function(){this.videoDuration=this.video.duration,this.startTime=0,this.endTime=this.videoDuration,this.trigger("uiVideoLoaded"),this.updateVideoState()},this.videoError=function(t){this.trigger("uiVideoError",{message:"El video no se puede reproducir."})},this.videoUnloaded=function(t){this.videoDuration=0,this.startTime=0,this.endTime=0,this.trigger("uiVideoUnloaded")},this.toggleVideoPlayback=function(){this.videoDuration&&(this.isVideoPlaying()?this.pauseVideo():this.isVideoAtEnd()?this.playVideo(this.startTime):this.playVideo())},this.toggleAudioState=function(){this.setVideoMuted(!this.isVideoMuted()),this.updateVideoState()},this.after("initialize",function(){this.video=this.select("videoSelector")[0],this.on("uiLoadVideo",this.loadVideo),this.on("uiUnloadVideo",this.unloadVideo),this.on(this.video,"loadedmetadata",this.readVideoMetadata),this.on(this.video,"error",this.videoError),this.on(this.video,"emptied",this.videoUnloaded),this.on("click",{videoSelector:this.toggleVideoPlayback,playStateSelector:this.toggleVideoPlayback,audioStateSelector:this.toggleAudioState})}),this.before("teardown",function(){this.unloadVideo()})}i(22);t.exports=s},function(t,e,i){(function(e){function s(){this.defaultAttrs({scrollThrottleMs:200,mediaSelectors:".PlayableMedia-player, .js-macaw-cards-iframe-container.card-type-promo_video_convo, .js-macaw-cards-iframe-container.card-type-audio, .js-macaw-cards-iframe-container.card-type-live_video, .js-macaw-cards-iframe-container.card-type-periscope_broadcast, .js-macaw-cards-iframe-container.card-type-player",tweetIdDataAttr:"data-tweet-id",tweetsSelector:".tweet",permalinkOverlaySelector:".PermalinkOverlay",tweetNonceId:"data-tweet-nonce"}),this.notifyViewportPositionChange=function(){var t=o.getVisibleViewport();this.watchedMedia.filter(function(t){return 0!==t.mediaElement.children.length}).filter(function(t){return this.permalinkOpen===t.inPermalink}.bind(this)).map(function(e){var i=e.mediaElement.getBoundingClientRect();return{tweetId:e.tweetId,parentViewportSize:t,positionInParent:r(i),videoHidden:this.pageHidden||this.modalWithinPermalinkOpen||this.modalOpen&&!e.inPermalink}}.bind(this)).forEach(function(t){this.notifyViewportPositionChangeForElement(t.tweetId,t.parentViewportSize,t.positionInParent,t.videoHidden)}.bind(this))},this.notifyViewportPositionChangeForElement=function(t,e,i,s){var n={parentViewportSize:e,positionInParent:r(i),videoHidden:s};this.trigger("uiPlayableMediaPositionChange",{tweetId:t,positionData:n})},this.isMediaElementWithinPermalink=function(t){var e=t.closest(this.attr.permalinkOverlaySelector);return e.length>0},this.updateTweetList=function(){this.watchedMedia=this.select("mediaSelectors").map(function(t,i){var s=e(i),n=this.modalOpen&&this.isMediaElementWithinPermalink(s),o=s.closest(this.attr.tweetsSelector);return{mediaElement:i,tweetId:o.attr(this.attr.tweetNonceId)||o.attr(this.attr.tweetIdDataAttr),inPermalink:n}}.bind(this)).get(),this.updatePermalinkVisibility(),this.throttledNotifyViewportPositionChange()},this.updatePermalinkVisibility=function(){this.permalinkOpen=this.$permalink.is(":visible")},this.updatePageVisibility=function(){var t=!document.hasFocus()||document.hidden;t!==this.pageHidden&&(this.pageHidden=t,this.throttledNotifyViewportPositionChange())},this.setModalOpen=function(){this.permalinkOpen?this.modalWithinPermalinkOpen=!0:this.modalOpen=!0,this.throttledNotifyViewportPositionChange()},this.setModalClosed=function(){this.modalWithinPermalinkOpen?this.modalWithinPermalinkOpen=!1:this.modalOpen=!1,this.updateTweetList()},this.after("initialize",function(){this.watchedMedia=[],this.pageHidden=!1,this.modalOpen=!1,this.permalinkOpen=!1,this.modalWithinPermalinkOpen=!1,this.throttledNotifyViewportPositionChange=a.throttle(this.notifyViewportPositionChange.bind(this),this.attr.scrollThrottleMs),this.on(document,"scroll uiDynamicCardLoaded uiDynamicCardUnloaded uiPlayableMediaReady",this.throttledNotifyViewportPositionChange),this.on(window,"resize",this.throttledNotifyViewportPositionChange),this.on(document,"uiPageHidden uiPageVisible",this.updatePageVisibility),this.on(window,"focus focusin blur focusout",this.updatePageVisibility),this.$permalink=this.select("permalinkOverlaySelector"),this.$permalink.on("scroll",this.throttledNotifyViewportPositionChange),this.on(document,"uiDialogOpened",this.setModalOpen),this.on(document,"uiDialogClosed",this.setModalClosed),this.on(document,"uiWatchPlayableMedia",this.updateTweetList),this.updateTweetList()})}var n=i(10),o=i(73),a=i(25),r=i(444);t.exports=n(s)}).call(e,i(1))},function(t,e){t.exports=function(t){return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}}},function(t,e,i){(function(e){function s(){this.defaultAttrs({top:80,closeOnOtherDialogOpened:!0,topMargin:60,bottomMargin:60,containerSelector:".MomentCapsuleSummaryListDialog-listContainer",itemsSelector:".MomentCapsuleSummaryListDialog-items",capsuleSelector:".MomentCapsuleSummary",createMomentSelector:".MomentCapsuleSummaryListDialog-button--newMoment",spinnerSelector:".spinner"}),this.around("open",function(t,e,i){this.tweetId=i.tweet_id,0===this.$items.children().length&&this.trigger("uiMomentsGetDialogUserMoments"),t()}),this.renderDialogContents=function(t,e){this.select("spinnerSelector").hide(),this.$items.append(e.html),this.$items.trigger("uiMomentsHasInjectedNewItems"),this.trigger("uiTriggerEllipsis"),this.updatePaginationValues(e),this.resizeDialog()},this.getOlderMoments=function(){this.hasMoreItems&&(this.select("spinnerSelector").show(),this.trigger("uiMomentsGetDialogUserMoments",{before:this.oldestMomentId}))},this.updatePaginationValues=function(t){this.oldestMomentId=t.oldest_moment_id,this.hasMoreItems=t.has_more_items},this.windowHeight=function(){return e(window).height()},this.resizeDialog=function(){var t=this.$dialog.height()+this.attr.topMargin+this.attr.bottomMargin-this.windowHeight();this.$container.css("max-height",this.$container.height()-t)},this.handleCapsuleClick=function(t,i){t.preventDefault(),t.stopPropagation();var s=e(t.target).closest(this.attr.capsuleSelector).attr("data-moment-id");this.trigger("uiMomentMakerAddTweet",{moment_id:s,tweet_id:this.tweetId,scribeContext:{component:"add_to_moment_dialog"}}),this.close()},this.handleCreateMoment=function(t,e){this.trigger("uiMomentMakerCreateMoment",{tweet_id:this.tweetId,scribeContext:{component:"add_to_moment_dialog"}}),this.close()},this.after("initialize",function(){this.tweetId=void 0,this.$container=this.select("containerSelector"),this.$items=this.select("itemsSelector"),this.attachChild(o,this.attr.containerSelector),this.attachChild(a,this.select("containerSelector"),{contentSelector:this.attr.itemsSelector}),this.on(document,"uiOpenAddToMomentDialog",this.open),this.on(document,"dataMomentsGetDialogUserMomentsSuccess",this.renderDialogContents),this.on("click",{capsuleSelector:this.handleCapsuleClick,createMomentSelector:this.handleCreateMoment}),this.on("uiNearTheBottom",this.getOlderMoments)})}var n=i(10),o=i(446),a=i(319),r=i(60),c=i(215);t.exports=n(r,c,s)}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({mediaItemSelector:".MomentMediaItem",mediaEntitySelector:".MomentMediaItem-entity",dataShowableSelector:'[data-showable="true"]',dataShowableAttr:"data-showable",dataCropAspectRatio:"data-crop-aspect-ratio",cropSquare:"square",cropPortrait3x4:"portrait-three-by-four"}),this.loadAllMedia=function(){var t=this.select("mediaItemSelector").not(this.attr.dataShowableSelector);t.each(this.loadMedia.bind(this))},this.loadMedia=function(t,i){var s=e(i),n=s.find(this.attr.mediaEntitySelector);n.length&&s.length&&n.css(this.getCssForLoading(s,n)),s.attr(this.attr.dataShowableAttr,!0)},this.getCssForLoading=function(t,e){var i=this.getMediaDimensions(e),s=this.getTargetDimensions(t),n=t.attr(this.attr.dataCropAspectRatio),a=n===this.attr.cropSquare,r=n===this.attr.cropPortrait3x4;if(a||r){var c=this.getCropData(e,n)||o.getDefaultCropRect(i,s);return o.calculateCrop(i,s,c)}return this.calculateScalingCss(s,i)},this.getCropData=function(t,e){var i={x:parseInt(t.data(e+"-crop-x"),10),y:parseInt(t.data(e+"-crop-y"),10),width:parseInt(t.data(e+"-crop-width"),10),height:parseInt(t.data(e+"-crop-height"),10)};if(this.validateCropData(i))return i},this.validateCropData=function(t){return Object.keys(t).every(function(e){return!isNaN(t[e])})},this.getMediaDimensions=function(t){var e="img"===t.get(0).nodeName.toLowerCase();return e?this.getImageDimensions(t):this.getIframeDimensions(t)},this.getImageDimensions=function(t){var e=t.get(0);return{width:t.data("width")||e.naturalWidth,height:t.data("height")||e.naturalHeight}},this.getIframeDimensions=function(t){return{width:t.data("width"),height:t.data("height")}},this.getTargetDimensions=function(t){return{width:t.width(),height:t.height()}},this.calculateScalingCss=function(t,e){var i=t.width/e.width*e.height;return{width:"100%",height:i+"px"}},this.after("initialize",function(){this.loadAllMedia(),this.on("uiMomentsHasInjectedNewItems uiActivityPopupRendered",this.loadAllMedia)})}var n=i(10),o=i(447);t.exports=n(s)}).call(e,i(1))},function(t,e){var i={cropRatioThreshold:.05,calculateCrop:function(t,e,i){var s=e.width/e.height,n=i.width/i.height,o=(s-n)/s;Math.abs(o)>this.cropRatioThreshold&&(i=this.getDefaultCropRect(t,s),n=i.width/i.height);var a=t.width/i.width*100,r=t.height/i.height*100,c=i.x/i.width*100,h=i.y/i.width*100;return{width:a+"%",height:r+"%",marginLeft:-1*c+"%",marginTop:-1*h+"%"}},getDefaultCropRect:function(t,e){var i,s=e.width/e.height,n=s<1,o=s>1;if(n){var a=t.height*s;i={width:a,height:t.height}}else if(o){var r=t.width/s;i={width:t.width,height:r}}else{var c=Math.min(t.width,t.height);i={width:c,height:c}}var h=1;return i.width>t.width?h=t.width/i.width:i.height>t.height&&(h=t.height/i.height),i.width=i.width*h,i.height=i.height*h,i.x=.5*(t.width-i.width),i.y=.5*(t.height-i.height),["width","height","x","y"].forEach(function(t){i[t]=Math.round(i[t])}),i}};t.exports=i},function(t,e,i){(function(e){function s(){this.defaultAttrs({tweetItemSelector:".tweet",deleteSelector:".js-actionDelete",shareViaDMSelector:".js-actionShareViaDM",copyLinkToTweetSelector:".js-actionCopyLinkToTweet",embedTweetSelector:".js-actionEmbedTweet",embedVideoSelector:".js-actionEmbedVideo",openAdsInfoLinkSelector:".js-actionOpenAdsInfoPage",blockOrReportTweetSelector:".js-actionBlockOrReport",blockTweetSelector:".js-actionBlock",reportTweetSelector:".js-actionReport",unblockTweetSelector:".js-actionUnblock",userTogglePinTweetSelector:".js-actionPinTweet",curateTweetSelector:".js-actionCurateTweet",curateToOtherSelector:".js-actionCurateTweetOther",curateToNewTimelineSelector:".js-actionCurateTweetNewTimeline",removeMediaTagSelector:".js-actionRemoveTag",tweetContainerSelector:".js-stream-item",mediaTagContainerSelector:".media-tags-container",pinnedTweetClass:"user-pinned",hasTimelinesClass:"has-timelines"}),this.renderCustomTimelinesList=function(t,e){var i=this.select("curateToOtherSelector");this.select("curateTweetSelector").remove(),i.before(e.html),this.select("curateTweetSelector").length>0&&i.addClass(this.attr.hasTimelinesClass)},this.curateTweet=function(t,i,s){var n=e(i.el),o=n.attr("data-timeline-id"),a=n.data("is-member"),r=s.tweetData;r.timelineId=o,a?this.trigger("uiCurateRemoveTweet",r):this.trigger("uiCurateAddTweet",r),this.trigger("uiCloseDropdowns")},this.getCustomTimelines=function(t,e,i){var s=i.$tweet.attr("data-tweet-id");this.trigger("uiNeedsCustomTimelines",{tweetId:s})},this.confirmRemoveMediaTag=function(t){this.trigger(t.target,"uiOpenConfirmDialog",{titleText:"¿Eliminar etiqueta de foto del Tweet?",bodyText:"¿Estás seguro de que quieres eliminar tu etiqueta de foto de este Tweet?",cancelText:"Cancelar",submitText:"OK",action:"MediaTagRemove"})},this.removeMediaTag=function(t,e,i){this.trigger(document,"uiDidRemoveMediaTag",i.tweetData)},this.handleRemoveMediaTagSuccess=function(t,e){var i=o(this.$node,this.attr.tweetItemSelector,e.id_str);i.find(this.attr.mediaTagContainerSelector).html(e.item_html),this.trigger("uiShowMessage",{message:"Etiqueta de foto eliminada"})},this.handleRemoveMediaTagFailure=function(t){this.trigger("uiShowMessage",{message:"No se puede eliminar la etiqueta. Por favor, inténtalo de nuevo más tarde."})},this.showConfirmPinDialog=function(t){t.stopImmediatePropagation(),this.trigger(t.target,"uiOpenConfirmDialog",{titleText:"Fija este Tweet en la parte superior de tu perfil",bodyText:"Esto reemplazará cualquier Tweet fijado anteriormente. ¿Estás seguro?",cancelText:"Cancelar",submitText:"Fijar",action:"UserPinTweetToggle"})},this.showConfirmUnPinDialog=function(t){t.stopImmediatePropagation(),this.trigger(t.target,"uiOpenConfirmDialog",{titleText:"Desfijar de tu perfil",bodyText:"¿Estás seguro?",cancelText:"Cancelar",submitText:"Desfijar",action:"UserPinTweetToggle"})},this.showUserPinToggledMessage=function(t,e){this.trigger("uiShowStickyMessage",e)},this.unpinOtherTweets=function(t,e){this.select("tweetItemSelector").removeClass(this.attr.pinnedTweetClass),this.handleTransition("addClass",this.attr.pinnedTweetClass).call(this,t,e)},this.handleTransition=function(t,e){return function(i,s){var n=s.id||s.sourceEventData.id,a=o(this.$node,this.attr.tweetItemSelector,n);a[t](e)}},this.confirmPinToggle=function(t,e,i){var s=i.$tweet.hasClass(this.attr.pinnedTweetClass)?"uiNeedUserUnpinTweetConfirm":"uiNeedUserPinTweetConfirm";this.trigger(i.$tweet,s)},this.togglePinnedTweet=function(t,e,i){return i.$tweet.hasClass(this.attr.pinnedTweetClass)?"uiDidUserUnpinTweet":"uiDidUserPinTweet"},this.unblockFromTweetAction=function(t,e){this.trigger("uiCloseDropdowns"),this.trigger("uiUnblockAction",e)},this.openAdsInfoLink=function(t,e){var i="https://business.twitter.com/help/how-twitter-ads-work";window.open(i,"_blank"),this.trigger("uiCloseDropdowns")},this.after("initialize",function(){var t=this.mkTweetDataCollectorForAction(this.interactionDataWithCard);this.on("click",{embedTweetSelector:this.composeHandler(this.getClosestTweet,t,this.triggerTweetAction("uiNeedsEmbedTweetDialog")),embedVideoSelector:this.composeHandler(this.getClosestTweet,t,this.triggerTweetAction("uiNeedsEmbedVideoDialog")),copyLinkToTweetSelector:this.composeHandler(this.getClosestTweet,t,this.triggerTweetAction("uiNeedsCopyLinkToTweetDialog")),openAdsInfoLinkSelector:this.openAdsInfoLink}),this.attr.loggedIn&&(this.on("click",{deleteSelector:this.composeHandler(this.getClosestTweet,t,this.triggerTweetAction("uiOpenDeleteDialog")),userTogglePinTweetSelector:this.composeHandler(this.getClosestTweet,this.confirmPinToggle),shareViaDMSelector:this.composeHandler(this.getClosestTweet,t,this.triggerTweetAction("uiComposeNewDMWithTweet")),curateTweetSelector:this.composeHandler(this.getClosestTweet,t,this.curateTweet),curateToOtherSelector:this.composeHandler(this.getClosestTweet,t,this.triggerTweetAction("uiOpenCurateDialog")),curateToNewTimelineSelector:this.composeHandler(this.getClosestTweet,t,this.triggerTweetAction("uiOpenCreateCustomTimelineDialog")),removeMediaTagSelector:this.confirmRemoveMediaTag,blockOrReportTweetSelector:this.composeHandler(this.getClosestTweet,t,this.triggerTweetAction("uiNeedsBlockOrReportDialog")),blockTweetSelector:this.composeHandler(this.getClosestTweet,t,this.triggerTweetAction("uiNeedsBlockDialog")),unblockTweetSelector:this.composeHandler(this.getClosestTweet,t,this.triggerTweetAction("uiDidUnblockFromTweet")),reportTweetSelector:this.composeHandler(this.getClosestTweet,t,this.triggerTweetAction("uiNeedsReportDialog"))}),this.on("uiDropdownOpened",this.composeHandler(this.getClosestTweet,this.getCustomTimelines)),this.on("uiUserPinTweetToggleConfirm",this.composeHandler(this.getClosestTweet,t,this.triggerTweetAction(this.togglePinnedTweet.bind(this)))),this.on("uiMediaTagRemoveConfirm",this.composeHandler(this.getClosestTweet,t,this.removeMediaTag)),this.on(document,"uiHasInjectedNewTimeline uiHasInjectedOldTimelineItems uiHasInjectedRangeTimelineItems",this.applyARIAAttrs),this.on(document,"dataGotCustomTimelines",this.renderCustomTimelinesList),this.on(document,"uiNeedUserPinTweetConfirm",this.showConfirmPinDialog),this.on(document,"uiNeedUserUnpinTweetConfirm",this.showConfirmUnPinDialog),this.on(document,"uiDidUnblockFromTweet",this.unblockFromTweetAction),this.on(document,"dataDidUserPinTweet dataDidUserUnpinTweet",this.showUserPinToggledMessage),this.on(document,"dataDidUserPinTweet",this.unpinOtherTweets),this.on(document,"uiDidUserPinTweet dataFailedToUserUnpinTweet",this.handleTransition("addClass",this.attr.pinnedTweetClass)),this.on(document,"uiDidUserUnpinTweet dataFailedToUserPinTweet",this.handleTransition("removeClass",this.attr.pinnedTweetClass)),this.on(document,"dataMediaTagRemoveSuccess",this.handleRemoveMediaTagSuccess),this.on(document,"dataMediaTagRemoveFailure",this.handleRemoveMediaTagFailure))})}var n=(i(22),i(10)),o=i(449),a=i(396),r=i(36),c=i(450),h=i(398),l=i(451),d=n(s,a,h,r,c,l);t.exports=d}).call(e,i(1))},function(t,e){function i(t,e,i){var s=e.split(",").map(function(t){return t+"[data-tweet-id="+i+"]"}).join();return t.find(s)}t.exports=i},,function(t,e,i){(function(e){function i(){this.defaultAttrs({momentItemSelector:".MomentCurationMenuItem",addTweetFromMomentSelector:".MomentCurationMenuItem:not(.is-member)",removeTweetFromMomentSelector:".MomentCurationMenuItem.is-member",addTweetToOtherMomentSelector:".js-actionMomentMakerAddTweetToOtherMoment",addTweetToNewMomentSelector:".js-actionMomentMakerCreateMoment",momentMemberClass:"is-member"}),this.renderUserMomentsList=function(t,e){this.select("momentItemSelector").remove(),this.select("addTweetToOtherMomentSelector").toggle(e.html.length>0).before(e.html)},this.setCurationClassValue=function(t){return function(e,i){this.select("momentItemSelector").filter("[data-moment-id="+i.moment_id+"]").toggleClass(this.attr.momentMemberClass,t)}.bind(this)},this.triggerMomentCurationEvent=function(t){return function(i,s,n){var o=e(s.el),a=o.attr("data-moment-id"),r=n.$tweet.attr("data-tweet-id");this.trigger(t,{moment_id:a,tweet_id:r,scribeContext:{component:"tweet_actions_dropdown"}}),this.trigger("uiCloseDropdowns")}},this.getMomentsWithEvent=function(t){return function(e,i,s){var n=s.$tweet.attr("data-tweet-id");this.trigger(t,{tweet_id:n})}},this.after("initialize",function(){this.attr.loggedIn&&(this.on("click",{addTweetFromMomentSelector:this.composeHandler(this.getClosestTweet,this.triggerMomentCurationEvent("uiMomentMakerAddTweet")),removeTweetFromMomentSelector:this.composeHandler(this.getClosestTweet,this.triggerMomentCurationEvent("uiMomentMakerRemoveTweet")),addTweetToOtherMomentSelector:this.composeHandler(this.getClosestTweet,this.getMomentsWithEvent("uiOpenAddToMomentDialog")),addTweetToNewMomentSelector:this.composeHandler(this.getClosestTweet,this.triggerMomentCurationEvent("uiMomentMakerCreateMoment"))}),this.on("uiDropdownOpened",this.composeHandler(this.getClosestTweet,this.getMomentsWithEvent("uiMomentsGetDropdownUserMoments"))),this.on(document,"dataMomentMakerAddTweetSuccess",this.setCurationClassValue(!0)),this.on(document,"dataMomentMakerRemoveTweetSuccess",this.setCurationClassValue(!1)),this.on(document,"dataMomentsGetDropdownUserMomentsSuccess",this.renderUserMomentsList))})}t.exports=i}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({unEllipsifiedTextClass:"js-ellipsis",unEllipsifiedTextSelector:".js-ellipsis",maxCharsRemoveEnsureEndOnWordBreak:5}),this.after("initialize",function(){"undefined"!=typeof document.createRange&&this.on(document,"uiSwiftLoaded uiPageChanged uiHasInjectedNewTimeline uiHasInjectedOldTimelineItems uiHasInjectedRangeTimelineItems uiOverlayUpdate uiTrendsDisplayed uiShowMoreTrends uiCommerceTabToggled uiTriggerEllipsis",this.addEllipses)}),this.addEllipses=function(){var t=this.select("unEllipsifiedTextSelector").filter(":visible");t.removeClass(this.attr.unEllipsifiedTextClass),t.each(this.addEllipsis.bind(this))},this.addEllipsis=function(t,i){var s=e(i),n=this.createRange(s);if(n.hasOverflow()){s.data("full-text",s.text()),n.shortenToVisibleContent(),n.ensureLastLineAvailableWidth(this.maxEllipsisWidth(s)),n.shortenToNearestWordBreak({maxCharsToRemove:this.attr.maxCharsRemoveEnsureEndOnWordBreak});var o=n.toDocumentFragment();o.appendChild(document.createTextNode("…")),s.html(o),this.trigger(s,"uiEllipsisAdded")}},this.maxEllipsisWidth=function(t){var e=parseInt(t.css("font-size"));return 2*e},this.createRange=function(t){return new o(t)}}var n=i(10),o=i(453);t.exports=n(s)}).call(e,i(1))},function(t,e){function i(t){function e(){var e=document.createRange(),i=t.contents(),s=t.contents().last()[0];return i.length>0&&(e.setStart(i[0],0),e.setEnd(s,h(s))),e}function i(t){return 3===t.nodeType||4===t.nodeType}function r(){for(var t=c(),e=null,i=null,s=null,n=null,o=0;o<t.length;o++){var a=t[o];(null===i||a.bottom>i)&&(i=a.bottom),(null===e||a.top<e)&&(e=a.top),(null===s||a.left<s)&&(s=a.left),(null===n||a.right>n)&&(n=a.right)}return{top:e,bottom:i,left:s,right:n,width:Math.abs(n-s),height:Math.abs(i-e)}}function c(){for(var t=g.getClientRects(),e=[],i=0;i<t.length;i++)e.push(t[i]);return e.filter(function(t){return t.width>0})}function h(t){return i(t)?t.nodeValue.length:t.childNodes.length}function l(){return t.width()-d()}function d(){var t=r(),e=c(),i=e[e.length-1];return 0===e.length?0:i.right-t.left}function u(t){var e=t.match(o);if(null!==e){var i=e[e.length-1],s=t.lastIndexOf(i);return{startIndex:s,endIndex:s+i.length}}return null}function m(t){return!!t.match(n)}function p(t){return(t.match(s)||[]).length}var g=e();this.shortenToVisibleContent=function(){for(var e=t.contents(),s=e.length-1;s>=0;s--){var n=e[s];if(i(n)){for(var o=n.nodeValue.length;o>=0;o--)if(g.setEnd(n,o),!this.hasOverflow())return}else if(g.setEnd(n,n.childNodes.length),!this.hasOverflow())return}},this.shortenToNearestWordBreak=function(t){var e=g.endContainer,s=t.maxCharsToRemove;if(i(e)&&(e.nodeValue.match(a)||g.endOffset!==e.nodeValue.length&&!m(e.nodeValue[g.endOffset]))){var n=e.nodeValue.slice(0,g.endOffset),o=u(n);null!==o&&(void 0!==s&&p(n.substring(o.endIndex))>s||g.setEnd(e,o.startIndex))}},this.ensureLastLineAvailableWidth=function(t){for(;l(g)<=t;){var e=g.endContainer;if(i(e)&&g.endOffset>1)g.setEnd(e,g.endOffset-1);else{var s=e.previousSibling;if(null===s)break;g.setEnd(s,h(s))}}},this.hasOverflow=function(){var e=r(),i=parseFloat(t.css("line-height"));return Math.round(e.height/i)>Math.round(t.height()/i)},this.toDocumentFragment=function(){return g.cloneContents()},this.setEnd=function(t,e){g.setEnd(t,e)}}var s=/([\uD800-\uDBFF][\uDC00-\uDFFF]|[\S\s])/g,n=/\s/,o=/\s+/g,a=/^\n$/;t.exports=i},function(t,e,i){function s(){this.attributes({defaultDisplayDuration:5e3,defaultIcon:void 0}),this.displayNotification=function(t,e){if(e&&"granted"===Notification.permission){var i=new Notification(e.title,{body:e.body,icon:e.icon||this.attr.defaultIcon,tag:e.tag});this.trigger("uiNativeNotificationTriggered",{type:e.type}),i.onclick=this.clickCallback.bind(this,e.click,e.type),i.onerror=this.errorCallback.bind(this,e.error,e.type),setTimeout(i.close.bind(i),e.displayDuration||this.attr.defaultDisplayDuration)}},this.clickCallback=function(t,e,i){i.target.close&&i.target.close(),this.trigger("uiNativeNotificationClicked",{type:e}),this.triggerEventWithData(t)},this.errorCallback=function(t,e){this.trigger("uiNativeNotificationError",{type:e}),this.triggerEventWithData(t)},this.triggerEventWithData=function(t){t&&t.eventName&&this.trigger(t.eventName,t.eventData||{})},this.requestPermission=function(){Notification.requestPermission(function(t){switch(t){case"granted":this.trigger("uiNativeNotificationPermissionGranted");break;case"denied":this.trigger("uiNativeNotificationPermissionDenied");break;case"default":this.trigger("uiNativeNotificationPermissionDismissed")}}.bind(this)),this.trigger("uiNativeNotificationPermissionRequested")},this.after("initialize",function(){"Notification"in window&&(this.on("uiRequestNativeNotificationPermission",this.requestPermission),this.on("uiDisplayNativeNotification",this.displayNotification))})}var n=i(10),o=n(s);t.exports=o},function(t,e,i){function s(){this.after("initialize",function(){this.scribeOnEvent("uiNativeNotificationPermissionGranted",{page:"",section:"",component:"native_notifications",element:"permission",action:"success"}),this.scribeOnEvent("uiNativeNotificationPermissionDenied",{page:"",section:"",component:"native_notifications",element:"permission",action:"failure"}),this.scribeOnEvent("uiNativeNotificationPermissionDismissed",{
page:"",section:"",component:"native_notifications",element:"permission",action:"dismiss"}),this.scribeOnEvent("uiNativeNotificationPermissionRequested",{page:"",section:"",component:"native_notifications",element:"permission",action:"impression"}),this.scribeOnEvent("uiNativeNotificationTriggered",{page:"",section:"",component:"native_notifications",element:"notification",action:"show"}),this.scribeOnEvent("uiNativeNotificationClicked",{page:"",section:"",component:"native_notifications",element:"notification",action:"click"}),this.scribeOnEvent("uiNativeNotificationError",{page:"",section:"",component:"native_notifications",element:"notification",action:"error"})})}var n=i(10),o=i(40),a=n(s,o);t.exports=a},,function(t,e,i){function s(){this.pollForNotifications=function(t,e){a.shouldPoll()&&this.trigger("uiDMPoll")},this.resetDMs=function(t,e){a.resetDMState(t,e)},this.notifications=a,this.after("initialize",function(){a.init(this.attr),this.on(document,"uiResetDMPoll",this.resetDMs),this.on(document,"uiPollForNotifications",this.pollForNotifications),this.timer=o("uiPollForNotifications")})}var n=i(10),o=i(458),a=i(230),r=n(s);t.exports=r},function(t,e,i){(function(e){function s(t,i,s){var a={focusedInterval:3e4,blurredInterval:9e4,backoffFactor:2};s=o.merge(a,s);var r=n.setIntervalEvent(t,s.focusedInterval,s.eventData);return e(document).on("uiPageHidden",r.backoff.bind(r,s.blurredInterval,s.backoffFactor)),e(document).on("uiPageVisible",r.cancelBackoff.bind(r)),r}var n=i(9),o=i(25);t.exports=s}).call(e,i(1))},function(t,e,i){function s(){this.requestEmbedCode=function(t,e){var i=this.cacheKeyForOptions(e),s=this.cachedEmbedCodes[i],n=this.receivedEmbedCode.bind(this,e),o=this.failedToReceiveEmbedCode.bind(this,e);return s?void this.receivedEmbedCode(e,s):void this.get({dataType:"jsonp",url:this.embedCodeUrl(),data:a.merge({id:e.tweetId},e.data),eventData:{},success:n,error:o})},this.embedCodeUrl=function(){return"//api.twitter.com/1/statuses/oembed.json"},this.receivedEmbedCode=function(t,e){var i=this.cacheKeyForOptions(t);this.cachedEmbedCodes[i]=e,this.trigger("dataOembedSuccess",{options:t,data:e})},this.failedToReceiveEmbedCode=function(t){t.retry?(t.retry=!1,this.trigger("dataOembedRetry",t),this.requestEmbedCode({},t)):this.trigger("dataOembedError",t)},this.cacheKeyForOptions=function(t){return JSON.stringify(t.data)+t.tweetId},this.after("initialize",function(){this.on("uiNeedsOembed",this.requestEmbedCode),this.cachedEmbedCodes={}})}var n=i(10),o=i(225),a=i(25);t.exports=n(s,o)},function(t,e,i){function s(){this.scribeError=function(t,e){this.scribe({component:"oembed",action:"request_failed"})},this.scribeRetry=function(t,e){this.scribe({component:"oembed",action:"retry"})},this.scribeRequest=function(t,e){this.scribe({component:"oembed",action:"request"},e)},this.scribeSuccess=function(t,e){this.scribe({component:"oembed",action:"success"},e)},this.after("initialize",function(){this.on("dataOembedError",this.scribeError),this.on("dataOembedRetry",this.scribeRetry),this.on("dataOembedRequest",this.scribeRequest),this.on("dataOembedSuccess",this.scribeSuccess)})}var n=i(10),o=i(40);t.exports=n(s,o)},function(t,e,i){(function(e){function s(){var t;this.defaultAttrs({offersDialogIframeSelector:".offers-card-iframe",offersActionSelector:".OffersCard-offersAction",tweetSelector:".tweet",commerceCardSelector:".OffersCard",top:47,defaultHeight:"600px"}),this.openDialog=function(t,e){var i;e&&e.retweetId?i="/i/redeem/status/"+e.retweetId:e&&e.tweetId&&(i="/i/redeem/status/"+e.tweetId),i&&(this.trigger("uiOffersCardClicked",e),this.select("offersDialogIframeSelector").attr("src",i),this.open())},this.closeDialog=function(t,e){this.select("offersDialogIframeSelector").attr("src","about:blank"),this.select("offersDialogIframeSelector").css("height",this.attr.defaultHeight),this.off(window,"message",this.adjustIframeHeight)},this.adjustIframeHeight=function(t){var e={iframeSelector:this.attr.offersDialogIframeSelector,isQualified:function(t){return t.name&&"offers"===t.name&&t.height}};this.fitIframeHeight(t,e)},this.offersActionClicked=function(i,s){var n=e(s.el).closest(this.attr.tweetSelector);t={tweetId:n.data("tweet-id"),retweetId:n.data("retweet-id"),impressionId:n.data("impression-id"),disclosureType:n.data("disclosure-type")},this.trigger("uiNeedsOffersDialog",t)},this.onSuccess=function(e,i){this.trigger("uiCloseDialog"),this.trigger("uiOffersSaveSuccess",t),setTimeout(function(t){t.trigger("uiShowMessage",{message:"¡Oferta reclamada! Los detalles del reembolso se enviarán por correo electrónico en breve."})},200,this)},this.setupMessageListener=function(){this.on(window,"message",this.adjustIframeHeight)},this.after("initialize",function(){this.on("uiDialogOpened",this.setupMessageListener),this.on("uiDialogClosed",this.closeDialog),this.on(document,"uiOffersSaveComplete",this.onSuccess),this.on("uiNeedsOffersDialog",this.openDialog),this.on(document,"click",{offersActionSelector:this.offersActionClicked})})}var n=i(10),o=(i(22),i(60)),a=i(68),r=i(462),c=i(69),h=n(s,o,a,c,r);t.exports=h}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({emailNotConfirmedClass:"email-not-confirmed",confirmDialogOptionData:{titleText:"Verificar dirección de correo electrónico",bodyText:"Para continuar, primero debes confirmar tu dirección de correo electrónico en la configuración de tu cuenta.",cancelText:"Cancelar",submitText:"Ve a configuración",action:"CommerceUserWantToVerifyEmail"}}),this.isEmailConfirmedOrHandle=function(t){var i=e(t).closest(this.attr.commerceCardSelector);return!i.hasClass(this.attr.emailNotConfirmedClass)||(this.trigger("uiOpenConfirmDialog",this.attr.confirmDialogOptionData),!1)},this.goToVerifyEmail=function(){window.location.href="/settings/account"},this.after("initialize",function(){this.on("uiCommerceUserWantToVerifyEmailConfirm",this.goToVerifyEmail)})}i(22);t.exports=s}).call(e,i(1))},function(t,e,i){function s(){this.addCount=function(t,e){this.trigger(document,{type:"uiUpdatePageCount",defaultBehavior:this.updateCount.bind(this,e)})},this.updateCount=function(t){t.count&&(document.title="("+t.count+") "+this.title)},this.removeCount=function(t,e){document.title=this.title},this.setTitle=function(t,e){var i=e||t.originalEvent.state;i&&i.title&&(document.title=this.title=i.title)},this.after("initialize",function(){this.title=document.title,this.on("uiAddPageCount",this.addCount),this.on("uiHasInjectedNewTimeline",this.removeCount),this.on(document,"uiBeforePageChanged uiUpdatePageTitle",this.setTitle)})}var n=i(10),o=n(s);t.exports=o},function(t,e,i){(function(e){function s(){this.defaultAttrs({heartBeat:0,doc:document,isIe:e.browser.msie});var t,i=!1;this.visibilityChange=function(e){var s;switch(e.type){case"focus":case"focusin":s=!1;break;case"blur":case"focusout":s=!0;break;case"beforeunload":case"uiBeforeUnload":this.trigger("uiPageUnload");break;default:t&&(s=this.attr.doc[t])}s===!0?(i=!0,this.trigger("uiPageHidden")):s===!1&&(i=!1,this.trigger("uiPageVisible"))},this.focusTick=function(){i||this.trigger("uiPageVisible")},this.after("initialize",function(){var e={hidden:"visibilitychange",mozHidden:"mozvisibilitychange",webkitHidden:"webkitvisibilitychange",msHidden:"msvisibilitychange"},i=!1;for(var s in e)s in this.attr.doc&&(t=s,this.on(this.attr.doc,e[t],this.visibilityChange),i=!0);i||(this.attr.isIe?this.on(this.attr.doc,"focusin focusout",this.visibilityChange):this.on(window,"focus focusin blur focusout",this.visibilityChange)),this.on(window,"beforeunload uiBeforeUnload",this.visibilityChange),this.attr.heartBeat&&(this.timer=n.setIntervalEvent("uiPageFocusTick",this.attr.heartBeat),this.on("uiPageFocusTick",this.focusTick))})}var n=i(9),o=i(10);t.exports=o(s)}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({isLoadingClass:"PaymentOrderDialog-isLoading",isLoadedClass:"PaymentOrderDialog-isLoaded",isFailedClass:"PaymentOrderDialog-isFailed",containerSelector:".PaymentOrderDialog-orderDetails",spinnerSelector:".spinner-bigger",errorAlertSelector:".alert"}),this.setLoading=function(){this.select("modalBodySelector").addClass(this.attr.isLoadingClass).removeClass(this.attr.isLoadedClass).removeClass(this.attr.isFailedClass)},this.setLoaded=function(){this.select("modalBodySelector").removeClass(this.attr.isLoadingClass).addClass(this.attr.isLoadedClass).removeClass(this.attr.isFailedClass)},this.setFailed=function(){this.select("modalBodySelector").removeClass(this.attr.isLoadingClass).removeClass(this.attr.isLoadedClass).addClass(this.attr.isFailedClass)},this.openDialog=function(t,e){this.setLoading(),this.open(),this.trigger("uiShowPaymentOrderDetail",{orderId:e.orderId})},this.populateDialog=function(t,e){this.setLoaded(),this.select("modalBodySelector").addClass(this.attr.isLoadedClass),this.select("containerSelector").html(e.html),this.position()},this.after("initialize",function(){this.on(document,"uiRequestPaymentOrderDetail",this.openDialog),this.on(document,"dataCommercePaymentOrderDetailFetched",this.populateDialog),this.on(document,"dataCommercePaymentOrderDetailFetchFailed",this.setFailed)})}var n=i(10),o=i(60),a=n(s,o);t.exports=a},function(t,e,i){(function(e){function s(){this.scribeAjaxDuration=function(t,i){if(!i.statsName)throw new Error("statsName is required for stats logging.");var s=["stats","ajax","perf",i.statsName];i.statsSubcategory&&s.push(i.statsSubcategory);var n=i.requestData||{};n.interval?s.push("polling"):n.min_position?s.push("newer"):n.max_position&&s.push("older"),i.status&&s.push(i.status);var o=s.join(":"),a={url:i.url,browser:r(e.browser),response_size:(i.responseText||{}).length};this.scribePerftown(o,i.duration,a)},this.after("initialize",function(){a.getDecider("web_perftown_stats")&&this.on("dataAjaxDuration",this.scribeAjaxDuration)})}var n=i(10),o=i(467),a=i(34),r=i(427);t.exports=n(s,o)}).call(e,i(1))},function(t,e,i){function s(){this.scribeTransport=n,this.scribePerftown=function(t,e,i){var s={product:"webclient",description:t,duration_ms:e,start_time_ms:this.startTime,metadata:JSON.stringify(i)};this.scribeTransport.send(s,"perftown")},this.after("initialize",function(){this.startTime=o.now()})}var n=i(30),o=i(231);t.exports=s},function(t,e,i){(function(e){function s(t){o.attachTo("#profile-hover-container",h.merge(t,{eventData:{scribeContext:{component:"profile_hover"}}})),a.attachTo(document,h.merge(t,{eventData:{scribeContext:{component:"profile_dialog"}}})),c.attachTo(document,t),n.attachTo(document,t),r.attachTo(document,t)}var n=i(469),o=i(470),a=i(472),r=i(473),c=i(474),h=i(25),l=e("#profile-hover-container").length>0;t.exports=l?s:e.noop}).call(e,i(1))},function(t,e,i){function s(){this.listMembershipContent=function(t,e){this.get({url:"/i/"+e.userId+"/lists",dataType:"json",data:{},eventData:e,success:"dataGotListMembershipContent",error:"dataFailedToGetListMembershipContent"})},this.addUserToList=function(t,e){this.post({url:"/i/"+e.userId+"/lists/"+e.listId+"/members",dataType:"json",data:{},eventData:e,success:"dataDidAddUserToList",error:"dataFailedToAddUserToList"})},this.removeUserFromList=function(t,e){this.destroy({url:"/i/"+e.userId+"/lists/"+e.listId+"/members",dataType:"json",data:{},eventData:e,success:"dataDidRemoveUserFromList",error:"dataFailedToRemoveUserFromList"})},this.createList=function(t,e){this.post({url:"/i/lists/create",dataType:"json",data:e,eventData:e,success:"dataDidCreateList",error:"dataFailedToCreateList"})},this.after("initialize",function(){this.on("uiNeedsListMembershipContent",this.listMembershipContent),this.on("uiAddUserToList",this.addUserToList),this.on("uiRemoveUserFromList",this.removeUserFromList),this.on("uiCreateList",this.createList)})}var n=i(10),o=i(225);t.exports=n(s,o)},function(t,e,i){(function(e){function s(){this.defaultAttrs({excludedContainerSelector:".modal-container, .Gallery, .ProfileCard",profileLinkSelector:"a.profile-picture, .fullname a",itemType:"user",subTargetClass:".username"}),this.openProfileHover=function(t,i){"true"!==o("disable_profile_hovers")&&(i.screenName&&delete i.userId,this.skipScreenName&&i.screenName&&i.screenName.toLowerCase()===this.skipScreenName.toLowerCase()||this.skipUserId&&i.userId===this.skipUserId||(i.isHoverRequest=!0,t.target&&e(t.target).closest(this.attr.excludedContainerSelector).length>0||(this.refEventData=i,this.refEl=e(t.target).find(this.attr.subTargetClass)[0]||t.target,this.lastRequested=i.screenName?i.screenName.toLowerCase():i.userId,this.prepareHover(this.lastRequested),this.$node.attr("data-associated-tweet-id",i.tweetId||null),this.$node.attr("data-impression-id",i.impressionId||null),this.$node.attr("data-disclosure-type",i.disclosureType||null),this.$node.attr("data-impression-cookie",i.impressionCookie||null),this.trigger("uiWantsProfilePopup",i))))},this.dataAvailable=function(t,i){if(i.screen_name&&this.lastRequested===i.screen_name.toLowerCase()||this.lastRequested===i.user_id){this.$node.attr("data-screen-name",i.screen_name||null),this.$node.attr("data-user-id",i.user_id||null);var s=e(i.html);s.find("a[href^='/"+i.screen_name+"']").attr("data-send-impression-cookie","true"),this.showHTML(i.user_id,s,e(this.refEl),this.refEventData)}},this.after("initialize",function(t,e){c.attachTo(this.$node,{eventData:{scribeContext:{component:"profile_hover"}}}),e.profile_user&&(this.skipScreenName=e.profile_user.screen_name,this.skipUserId=e.profile_user.id_str),this.on(document,"dataProfilePopupSuccess",this.dataAvailable),this.on(document,"uiShowProfileHover",this.openProfileHover),this.on(document,"uiHideProfileHover",this.hide)})}var n=i(10),o=i(52),a=i(471),r=i(394),c=i(456),h=n(s,a,r);t.exports=h}).call(e,i(1))},function(t,e,i){(function(e){function s(){n.mixin(this,[o]),this.defaultAttrs({hoverContentSelector:".hovercard",hoverContainerClasses:"hovercard",showDelay:600,hideDelay:100}),this.prepareHover=function(t){this.currentKey!==t&&this.forceHide(!1),this.openTimer=setTimeout(this.timerSaysOK.bind(this),this.attr.showDelay)},this.timerSaysOK=function(){this.okToOpen=!0,this.queuedOpen&&this.queuedOpen()},this.showHTML=function(t,i,s,n){if(n=n||{},n.id=t,this.currentKey===t&&this.timeout)return clearTimeout(this.timeout),void(this.timeout=null);if(!this.okToOpen)return void(this.queuedOpen=function(){this.showHTML(t,i,s,n)});this.queuedOpen=null,this.forceHide(),this.currentKey=t,this.$hoverContent=e(i),this.$hoverContent.addClass(this.attr.hoverContainerClasses),this.$node.html(this.$hoverContent),this.pos=this.adjacent(this.$node,e(s),{gravity:"vertical"}),this.$hoverContent.addClass("gravity-"+this.pos.gravity),this.$hoverContent.addClass("weight-"+this.pos.weight),"south"===this.pos.gravity&&(this.pos.top-=10),this.$node.css({top:this.pos.top,left:this.pos.left});var o=function(){var t=this.pos.top,e=this.pos.top+("north"===this.pos.gravity?20:-20);this.$node.css({top:e,opacity:0}),this.$node.show(),this.$node.animate({top:t,opacity:1},150,"easeOutQuad"),this.trigger("uiHoverShown",n)}.bind(this),a=this.$hoverContent.find("img.banner");a.length>0?a.load(o):o()},this.forceHide=function(t){(null!==this.currentKey||t)&&(this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.openTimer&&(clearTimeout(this.openTimer),this.openTimer=null),this.currentKey=null,this.$hoverContent&&this.$node.fadeOut({duration:100,complete:function(){this.$hoverContent&&(this.$hoverContent.remove(),this.$hoverContent=null)}.bind(this),easing:"easeOutQuad"}))},this.hide=function(){this.okToOpen=!1,this.queuedOpen=null,clearTimeout(this.openTimer),this.openTimer=null,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(this.forceHide.bind(this,!1),this.attr.hideDelay)},this.mouseOverContent=function(){if(this.timeout)return clearTimeout(this.timeout),void(this.timeout=null)},this.after("initialize",function(){this.on(document,"uiOverlayNavigate uiBeforePageChanged uiShortcutEsc",this.forceHide.bind(this,!0)),this.on(document,"mouseover",{hoverContentSelector:this.mouseOverContent}),this.on(document,"mouseout",{hoverContentSelector:this.hide}),e.extend(e.easing,{def:"easeOutQuad",easeOutQuad:function(t,e,i,s,n){return-s*(e/=n)*(e-2)+i}})})}var n=i(20),o=i(68);t.exports=s}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({hoverFetchDelay:100,noShowError:!0,statsName:"swift_profile_popup"}),this.userCache={screenNames:Object.create(null),ids:Object.create(null)},this.socialProofCache={screenNames:Object.create(null),ids:Object.create(null)},this.saveToCache=function(t,e){t.ids[e.user_id]=e,t.screenNames[e.screen_name]=e},this.retrieveFromCache=function(t,e){var i;return e.userId?i=t.ids[e.userId]:e.user_id?i=t.ids[e.user_id]:e.screenName?i=t.screenNames[e.screenName]:e.screen_name&&(i=t.screenNames[e.screen_name]),i},this.invalidateCaches=function(t,e){var i,s,n;e.userId?(i=e.userId,n=this.userCache.ids[i],s=n&&n.screen_name):(s=e.screenName,n=this.userCache.screenNames[s],i=n&&n.user_id),i&&delete this.userCache.ids[i],i&&delete this.socialProofCache.ids[i],s&&delete this.userCache.screenNames[s],s&&delete this.socialProofCache.screenNames[s]},this.getProfilePopupMain=function(t,e){var i=function(t){this.saveToCache(this.userCache,t),this.trigger("dataProfilePopupSuccess",t);var e=this.retrieveFromCache(this.socialProofCache,t);e&&this.trigger("dataSocialProofSuccess",e)}.bind(this),s=function(t){this.trigger("dataProfilePopupFailure",t)}.bind(this),n=this.retrieveFromCache(this.userCache,t);if(n)return n.sourceEventData=t,void i(n);var o=function(){this.pendingRemoteRequest=null,this.get({url:"/i/profiles/popup",data:e,eventData:t,cache:!1,success:i,error:s})}.bind(this);e.wants_hovercard?this.pendingRemoteRequest=setTimeout(o,this.attr.hoverFetchDelay):o()},this.getProfilePopup=function(t,e){var i={};e.screenName?i.screen_name=e.screenName:e.userId&&(i.user_id=e.userId),e.isHoverRequest&&(i.wants_hovercard=!0),this.getProfilePopupMain(e,i)},this.hideProfileHover=function(){this.pendingRemoteRequest&&(clearTimeout(this.pendingRemoteRequest),this.pendingRemoteRequest=null)},this.after("initialize",function(){this.on("uiWantsProfilePopup",this.getProfilePopup),this.on("uiHideProfileHover",this.hideProfileHover),this.on(document,"dataFollowStateChange dataUserActionSuccess dataDidMuteUser dataDidUnmuteUser",this.invalidateCaches)})}var n=i(10),o=i(225),a=n(s,o);t.exports=a},function(t,e,i){(function(e){function s(){this.defaultAttrs({scribeContext:{component:"profile_hover"}}),this.scribeProfilePopupOpen=function(t,i){if(i.isHoverRequest){i.user_id=i.user_id||e(t.target).attr("data-user-id"),["profile","me"].indexOf(this.clientEvent.scribeContext.page)!==-1&&this.clientEvent.scribeData.profile_id||(this.clientEvent.scribeData.profile_id=i.user_id);var s=o.merge(this.attr.scribeContext,{action:"open"});this.scribeInteraction(s,i)}},this.cleanupProfilePopupScribing=function(t,e){this.clientEvent.scribeData.profile_id&&["profile","me"].indexOf(this.clientEvent.scribeContext.page)===-1&&delete this.clientEvent.scribeData.profile_id},this.after("initialize",function(){this.clientEvent=r,this.on(document,"uiHideProfileHover",this.cleanupProfilePopupScribing),this.on(document,"uiHoverShown",this.scribeProfilePopupOpen)})}var n=i(10),o=i(25),a=i(39),r=i(32);t.exports=n(s,a)}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({urlToActionMap:{"/i/user/follow":"follow","/i/user/unfollow":"unfollow","/i/user/block":"block","/i/user/unblock":"unblock","/i/user/hide":"dismiss"},millisecInDay:864e5,ageGateingErrorCode:250,ageGateCookieKey:"age-gated"}),this.hasBeenAgeGatedWithin24Hr=function(){var t=a(this.attr.ageGateCookieKey);return!!t&&(new Date).getTime()-parseInt(t,10)<this.attr.millisecInDay},this.getUserAction=function(t){return this.attr.urlToActionMap[t]},this.updateFollowStatus=function(t,e){function i(i){i.message&&this.trigger("uiShowMessage",i),this.trigger("dataFollowStateChange",o.merge(i,t,{userId:t.userId,newState:i.new_state,requestUrl:e,isFollowBack:i.is_follow_back,action:this.getUserAction(e),username:t.screenName})),this.trigger(document,"dataGotProfileStats",{stats:i.profile_stats})}function s(i){var s=t.userId,n=t.originalFollowState,a=i&&i.data&&i.data.code===this.attr.ageGateingErrorCode;i.new_state&&(n=i.new_state),this.trigger("dataFollowStateChange",o.merge(i,{userId:s,newState:n,action:this.getUserAction(e),username:t.screenName})),a&&this.trigger("uiNeedsAgeGateDialog",{originalData:t,newState:n,ageGated:this.hasBeenAgeGatedWithin24Hr(),minBirthDate:parseInt(i.data.timestamp,10)})}var n=t.disclosureType?"earned"===t.disclosureType:void 0,a={user_id:t.userId,impression_id:t.impressionId,earned:n,fromShortcut:t.fromShortcut,handles_challenges:1};t.lifeline&&(a.lifeline=1),a.challenges_passed=!!t.passedAgeGating,this.post({url:e,data:a,eventData:t,success:i.bind(this),error:s.bind(this),retryIfUnavailable:!0})},this.reversibleAjaxCall=function(t,i,s){function n(s){this.trigger("dataUserActionSuccess",e.extend({},s,{userId:t.userId,requestUrl:i,action:this.getUserAction(i)})),s.message&&this.trigger("uiShowMessage",s)}function o(e){this.trigger(s,t)}this.post({url:i,data:{user_id:t.userId,impression_id:t.impressionId},eventData:t,success:n.bind(this),error:o.bind(this)})},this.normalAjaxCall=function(t,i,s){function n(s){this.trigger("dataUserActionSuccess",e.extend({},s,{userId:t.userId,requestUrl:i,action:this.getUserAction(i)})),s.message&&this.trigger("uiShowMessage",s)}var o=e.extend({user_id:t.userId,token:t.feedbackToken,impression_id:t.impressionId},s);this.post({url:i,data:o,eventData:t,success:n.bind(this),error:"dataUserActionError"})},this.followAction=function(t,e){var i="/i/user/follow";this.updateFollowStatus(e,i)},this.unfollowAction=function(t,e){var i="/i/user/unfollow";this.updateFollowStatus(e,i)},this.cancelAction=function(t,e){var i="/i/user/cancel";this.updateFollowStatus(e,i)},this.blockAction=function(t,e){var i="/i/user/block";this.updateFollowStatus(e,i)},this.unblockAction=function(t,e){var i="/i/user/unblock";this.updateFollowStatus(e,i)},this.reportSpamAction=function(t,e){this.normalAjaxCall(e,"/i/user/report_spam",{screen_name:e.screenName,report_type:e.reportType,block_user:e.blockUser,impression_id:e.impressionId})},this.hideSuggestionAction=function(t,e){this.normalAjaxCall(e,"/i/user/hide")},this.retweetOnAction=function(t,e){this.reversibleAjaxCall(e,"/i/user/retweets_on","dataRetweetOffAction")},this.retweetOffAction=function(t,e){this.reversibleAjaxCall(e,"/i/user/retweets_off","dataRetweetOnAction")},this.deviceNotificationsOnAction=function(t,e){this.reversibleAjaxCall(e,"/i/user/device_notifications_on","dataDeviceNotificationsOffAction")},this.deviceNotificationsOffAction=function(t,e){this.reversibleAjaxCall(e,"/i/user/device_notifications_off","dataDeviceNotificationsOnAction")},this.after("initialize",function(){this.on(document,"uiFollowAction",this.followAction),this.on(document,"uiUnfollowAction",this.unfollowAction),this.on(document,"uiCancelFollowRequestAction",this.cancelAction),this.on(document,"uiBlockAction",this.blockAction),this.on(document,"uiUnblockAction",this.unblockAction),this.on(document,"uiReportSpamAction uiReportUserAction",this.reportSpamAction),this.on(document,"uiHideSuggestionAction",this.hideSuggestionAction),this.on(document,"uiRetweetOnAction",this.retweetOnAction),this.on(document,"uiRetweetOffAction",this.retweetOffAction),this.on(document,"uiDeviceNotificationsOnAction",this.deviceNotificationsOnAction),this.on(document,"uiDeviceNotificationsOffAction",this.deviceNotificationsOffAction),this.on(document,"uiAgeGatePassed",this.followAction)})}var n=i(10),o=i(25),a=i(52),r=i(225),c=n(s,r);t.exports=c}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({currentUserPath:""}),this.navigateToProfilePath=function(){this.trigger("uiNavigate",{href:this.attr.currentUserPath})},this.after("initialize",function(){this.on("uiNavigateToProfile",this.navigateToProfilePath)})}var n=i(10),o=n(s);t.exports=o},function(t,e,i){var s=i(477),n=i(478),o=i(479),a=i(481),r=i(482),c=i(500),h=i(501),l=i(503),d=i(504),u=i(506),m=i(507),p=i(508),g=i(484),f=i(25);t.exports=function(t){var e=t.promptbirdData||{};if(e.promptbirdEnabled){s.attachTo(document),n.attachTo(document),o.attachTo(document,e),a.attachTo(document,e),u.attachTo(document,s),d.attachTo(document,s),r.attachTo("#above-timeline-prompt",e),c.attachTo("#dashboard-profile-prompt",e),p.attachTo("#promptbird-modal-prompt",e);var i=g.timelinePromptOptions(e.format),v=f.merge(e,i.promptOptions);m.attachTo(i.timelineSelector,v),h.attachTo(i.timelineSelector,f.merge(v,{actionSelector:".PromptbirdPrompt--inline .js-promptAction",dismissSelector:".PromptbirdPrompt--inline .js-promptDismiss"})),l.attachTo(i.timelineSelector,f.merge(v,{actionSelector:".PromptbirdPrompt--inlinePointer .js-promptAction",dismissSelector:".PromptbirdPrompt--inlinePointer .js-promptDismiss"}))}}},function(t,e,i){function s(){this.postFunction=function(t,e,i,s,n){var o={prompt_id:n.prompt_id};this.post({url:"/i/users/prompts/"+t,eventData:o,data:o,success:e,error:i})},this.after("initialize",function(){this.on("uiPromptbirdDismissPrompt",this.postFunction.bind(this,"dismiss","dataPromptbirdPromptDismissed","dataPromptbirdPromptDismissalError")),this.on("uiPromptbirdClick",this.postFunction.bind(this,"click","dataPromptbirdPromptClicked","dataPromptbirdPromptClickError")),this.on("uiPromptbirdPromptWasShown uiInlinePromptScrolledIn",this.postFunction.bind(this,"impress","dataPromptbirdPromptImpressed","dataPromptbirdPromptImpressError")),this.on("uiPromptbirdPromptWasShown uiInlinePromptScrolledIn","uiItemsInjected")})}var n=i(10),o=i(225);t.exports=n(s,o)},function(t,e,i){function s(){this.after("initialize",function(){this.scribeOnEvent("uiPromptbirdPromptWasShown",{action:"impression"}),this.scribeOnEvent("uiInlinePromptScrolledIn",{action:"impression"}),this.scribeOnEvent("uiPromptbirdClick",{action:"click"}),this.scribeOnEvent("uiPromptbirdDismissPrompt",{action:"dismiss"}),this.scribeOnEvent("uiPromptbirdPreviewPromotedAccount",{action:"preview"}),this.scribeOnEvent("uiShowDashboardProfilePromptbird",{action:"show"})})}var n=i(10),o=i(40);t.exports=n(s,o)},function(t,e,i){(function(e){function s(){this.defaultAttrs({delayedPrompts:[],tweetItemSelector:'.js-stream-item[data-item-type="tweet"]:visible',originalTweetSelector:".js-original-tweet",promotedTweetClass:"promoted-tweet",immediateTriggers:[]}),this.initPage=function(){this.trigger("uiPromptbirdManagerWantsPrompts",{tweetIds:this.getTweetIds()})},this.renderImmediatePrompts=function(t){var e=t.filter(function(t){return this.shouldRenderPromptImmediately(t)},this);e.forEach(this.renderPrompt,this)},this.renderPrompt=function(t){this.trigger("uiPromptbirdShouldRenderPrompt",{prompt:t})},this.saveDelayedPrompts=function(t){var e=t.filter(function(t){return!this.shouldRenderPromptImmediately(t)},this);this.attr.delayedPrompts=e},this.refreshPrompts=function(t,e){e.prompts&&(this.renderImmediatePrompts(e.prompts),this.saveDelayedPrompts(e.prompts))},this.shouldRenderPromptImmediately=function(t){return!t.trigger||this.attr.immediateTriggers.indexOf(t.trigger)>-1},this.getTweetIds=function(){var t=this.select("tweetItemSelector").filter(function(t,i){return!e(i).find(this.attr.originalTweetSelector).hasClass(this.attr.promotedTweetClass)}.bind(this)).map(function(){return e(this).data("item-id")}).toArray();return t.join(",")},this.after("initialize",function(){this.on(document,"uiSwiftLoaded uiPageChanged",this.initPage),this.on("dataPromptbirdManagerHasPrompts",this.refreshPrompts)})}var n=i(10),o=i(480);t.exports=n(s,o)}).call(e,i(1))},function(t,e){function i(){this.renderActionPrompt=function(t,e,i){this.renderDelayedPromptForAction(i.sourceEventData.id,t)},this.renderDelayedPromptForAction=function(t,e){var i=this.getDelayedPromptForAction(e);i&&(i.pointerTweetId=t,this.renderPrompt(i))},this.getDelayedPromptForAction=function(t){var e=this.attr.delayedPrompts.filter(function(e){return e.trigger===t})[0];if(e){var i=this.attr.delayedPrompts.indexOf(e);this.attr.delayedPrompts.splice(i,1)}return e},this.after("initialize",function(){this.on(document,"dataDidRetweet",this.renderActionPrompt.bind(this,"retweet")),this.on(document,"dataDidFavoriteTweet",this.renderActionPrompt.bind(this,"favorite"))})}t.exports=i},function(t,e,i){function s(){this.defaultAttrs({endpoint:"/i/users/prompts",format:""}),this.fetchPrompts=function(t,e){e=e||{};var i={format:this.attr.format,tweet_ids:e.tweetIds,force_prompt_id:this.getForcePromptIdParam()};this.get({url:this.attr.endpoint,eventData:i,data:i,success:"dataPromptbirdManagerHasPrompts",error:"dataPromptbirdManagerPollFailure"})},this.getForcePromptIdParam=function(){return a.decode(window.location.search.replace(/^\?/,"")).force_prompt_id},this.after("initialize",function(){this.on("uiPromptbirdManagerWantsPrompts",this.fetchPrompts)})}var n=i(10),o=i(225),a=i(233);t.exports=n(s,o)},function(t,e,i){function s(){this.defaultAttrs({promptType:"above_timeline"}),this.insertPrompt=function(t){this.$node.html(t.html)}}var n=i(483),o=i(498),a=i(499);t.exports=n.mixin(s,o,a)},function(t,e,i){(function(e){function s(){this.defaultAttrs({promptType:null,promptSelector:".PromptbirdPrompt",actionSelector:".js-promptAction",dismissSelector:".js-promptDismiss",promptLayoutContainerSelector:".js-prompt-layout-container",promptBirdStreamItemSelector:".PromptbirdPrompt-streamItem",isStickyClass:"js-isSticky",triggerImpressionOnInsert:!0}),this.insertPrompt=function(t){},this.removePrompt=function(t){t.closest(this.attr.promptLayoutContainerSelector).remove()},this.showPrompt=function(t,e){var i=this.filterPrompt(e.prompt);i&&(i.html=o.getPromptHtml(i,this.attr.format),this.insertPrompt(i),this.bootPrompt(i),this.attr.triggerImpressionOnInsert&&this.trigger("uiPromptbirdPromptWasShown",this.scribeData(i.id)))},this.bootPrompt=function(t){if(t.js_boot){var e=function(e){e({promptElement:this.getPromptByPromptId(t.id)})}.bind(this);i.e(4,function(s){var n=i(485)("./"+t.js_boot);e(n)})}},this.filterPrompt=function(t){if(this.attr.promptType===t.type)return t},this.actionClicked=function(t,i){this.triggerPromptAction(i.el,"uiPromptbirdClick");var s=e(i.el);s.hasClass(this.attr.isStickyClass)||this.removePrompt(this.getPromptFromChild(i.el))},this.dismissClicked=function(t,e){t.preventDefault(),this.dismissPrompt(e.el)},this.dismissPrompt=function(t){this.triggerPromptAction(t,"uiPromptbirdDismissPrompt");var i=e(t).closest(this.attr.promptBirdStreamItemSelector);this.trigger(i,"uiRemoveClassBeforePromptbird"),this.removePrompt(this.getPromptFromChild(t))},this.triggerPromptAction=function(t,e){var i=this.getPromptFromChild(t),s=i.data("prompt-intent"),n=i.data("prompt-intent-params"),o=parseInt(i.data("prompt-id"),10);this.trigger(e,this.scribeData(o,s,n))},this.scribeData=function(t,e,i){return{scribeContext:{component:"promptbird_"+t},prompt_id:t,intent:e,intent_params:i}},this.getPromptFromChild=function(t){return e(t).closest(this.attr.promptSelector)},this.getPromptByPromptId=function(t,e){var i=this.attr.promptSelector+'[data-prompt-id="'+t+'"]',s=this.$node.find(i).addBack(i);return e?s.closest(this.attr.promptLayoutContainerSelector):s},this.getPromptIdFromNode=function(t){var e=t.is(this.attr.promptSelector)?t:t.find(this.attr.promptSelector);return e.data("prompt-id")},this.after("initialize",function(){this.on(document,"uiPromptbirdShouldRenderPrompt",this.showPrompt),this.on("click",{actionSelector:this.actionClicked,dismissSelector:this.dismissClicked})})}var n=i(10),o=i(484);t.exports=n(s)}).call(e,i(1))},function(t,e,i){(function(e){var s=i(107),n={PROFILE_FORMATS:["ProfileOther","ProfileSelf"],TIMELINE_LAYOUT_TYPES:["inline","inline_pointer"],timelinePromptOptions:function(t){return this.isProfileFormat(t)?{timelineSelector:".GridTimeline-items",promptOptions:{streamItemSelector:".Grid .Grid-cell .js-stream-item",
streamItemContainerSelector:"> .Grid"}}:{timelineSelector:"#stream-items-id",promptOptions:{streamItemSelector:"> .js-stream-item",streamItemContainerSelector:"> .js-stream-item"}}},getPromptLayout:function(t,e){var i;return i=this.hasTimelineLayout(t)?this.isProfileFormat(e)?"grid_timeline_layout":"list_timeline_layout":"default_layout"},getPromptHtml:function(t,i){var n=this.getPromptLayout(t.type,i),o=s["promptbird/prompts/"+n].render(t.renderData,s),a=s["promptbird/prompts/"+t.template].render(t.renderData,s),r=e("<div></div>");return r.html(o),r.find(".js-prompt-layout-content").html(a),r.html()},isProfileFormat:function(t){return this.PROFILE_FORMATS.indexOf(t)>-1},hasTimelineLayout:function(t){return this.TIMELINE_LAYOUT_TYPES.indexOf(t)>-1}};t.exports=n}).call(e,i(1))},,,,,,,,,,,,,,function(t,e){function i(){this.after("insertPrompt",function(){this.select("promptSelector").slideDown()})}t.exports=i},function(t,e){function i(){this.defaultAttrs({removePromptDuration:400}),this.around("removePrompt",function(t,e){e.slideUp(this.attr.removePromptDuration,function(){t(e)})})}t.exports=i},function(t,e,i){function s(){this.defaultAttrs({promptType:"dashboard_profile"}),this.insertPrompt=function(t){this.$node.html(t.html)}}var n=i(483),o=i(499);t.exports=n.mixin(s,o)},function(t,e,i){function s(){this.defaultAttrs({promptType:"inline",promptItemSelector:".PromptbirdPrompt--inline",defaultInsertionIndex:0}),this.insertPrompt=function(t){var e=t.renderData.insertionIndex||this.attr.defaultInsertionIndex,i=t.renderData.shouldInsertAbove||!1;this.insertPromptAtIndex(t,e,i)}}var n=i(502),o=i(498);t.exports=n.mixin(s,o)},function(t,e,i){(function(e){function s(){this.defaultAttrs({streamItemSelector:"> .js-stream-item",streamItemContainerSelector:"> .js-stream-item",scrollDebounceInterval:100}),this.enabledScrollCheck=function(t){var e=this.getPromptIdFromNode(t);setTimeout(function(){this.updateVisibility(t)}.bind(this),0),this.on(window,"scroll.prompt"+e,a.debounce(this.updateVisibility.bind(this,t),this.attr.scrollDebounceInterval))},this.disableScrollCheck=function(t){var e=t.data("prompt-id");this.off(window,"scroll.prompt"+e)},this.updateVisibility=function(t,i,s){var n=r.isWithinBounds(e(window),t),o=this.getPromptIdFromNode(t);!this.promptVisibility[o]&&n&&this.trigger("uiInlinePromptScrolledIn",this.scribeData(o)),this.promptVisibility[o]=n},this.insertPromptAtIndex=function(t,i,s){var n=s?"before":"after",o=e(t.html),a=this.select("streamItemContainerSelector").eq(i);a[n](o),this.enabledScrollCheck(o)},this.before("removePrompt",this.disableScrollCheck),this.after("initialize",function(){this.attr.triggerImpressionOnInsert=!1,this.promptVisibility={}})}var n=i(483),o=i(499),a=i(25),r=i(73);t.exports=n.mixin(s,o)}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({promptType:"inline_pointer",promptItemSelector:".PromptbirdPrompt--inlinePointer",pointerArrowSelector:".PromptbirdPrompt-arrow",pointerTargetSelectors:{favorite_action:".ProfileTweet-action .js-actionFavorite .Icon, .ProfileTweet-action .js-actionFavorite .HeartAnimation",reply_action:".ProfileTweet-action .js-actionReply .Icon",retweet_action:".ProfileTweet-action .js-actionRetweet .Icon",more_action:".ProfileTweet-action .js-dropdown-toggle .Icon"}}),this.insertPrompt=function(t){this.trigger("uiPromptNeedsInsertionIndex",{prompt:t})},this.insertPromptWithIndex=function(t,e){var i=e.prompt;this.insertPromptAtIndex(i,e.insertionIndex,e.shouldInsertAbove),this.setPointerArrowOffset(i)},this.setPointerArrowOffset=function(t){var e=this.attr.pointerTargetSelectors[t.renderData.pointerTarget],i=this.getPromptByPromptId(t.id,!0),s=i.find(this.attr.pointerArrowSelector),n=i.prev(),o=n.find(e),a=o.offset().left-n.offset().left;a<=i.width()&&s.css({left:a+"px"})},this.after("initialize",function(){this.on("uiPromptHasInsertionIndex",this.insertPromptWithIndex)})}var n=i(502),o=i(498);t.exports=n.mixin(s,o)},function(t,e,i){function s(){this.defaultAttrs({intent:"post_then_trigger"}),this.action=function(t){var e=o.decode(t),i=e.post_path,s=e.success_event_name,n=e.fail_event_name,a=this.tryParseData(e.post_data),r=this.tryParseData(e.success_event_data),c=this.tryParseData(e.fail_event_data);this.post({url:i,data:a}).then(function(){this.trigger(s,r)}.bind(this)).fail(function(){n&&this.trigger(n,c)}.bind(this))},this.tryParseData=function(t){var e;try{e=JSON.parse(t)}catch(i){e={}}return e}}var n=i(505),o=i(233),a=i(225);t.exports=n.mixin(s,a)},function(t,e,i){function s(){this.defaultAttrs({intent:null}),this.action=function(){},this.checkIntents=function(t,e){e.intent&&this.attr.intent===e.intent&&this.action(e.intent_params)},this.after("initialize",function(){this.on(document,"uiPromptbirdClick",this.checkIntents)})}var n=i(10);t.exports=n(s)},function(t,e,i){function s(){this.defaultAttrs({intent:"tweet"}),this.action=function(t){var e=o.decode(t);e.canTweetDefaultText=!0,this.trigger("uiOpenTweetDialog",e)}}var n=i(505),o=i(233);t.exports=n.mixin(s)},function(t,e,i){(function(e){function s(){this.defaultAttrs({streamItemSelector:".js-stream-item",promotedTweetSelector:".promoted-tweet",originalTweetSelector:".js-original-tweet",favoritedClass:"favorited",favoriteCountSelector:".ProfileTweet-action--favorite .ProfileTweet-actionCount",tweetStatCountSelector:"tweet-stat-count",tweetSelectionAlgorithmMap:{most_favorited:"getMostFavoritedTweet",mutual_follow:"getMutualFollowTweet",not_following:"getNotFollowingTweet"}}),this.getInsertionIndex=function(t,e){var i=e.prompt,s=this.getInsertionIndexForPrompt(i);s<0||this.trigger("uiPromptHasInsertionIndex",{prompt:i,insertionIndex:s})},this.getEligibleTweets=function(){var t=this.attr.promotedTweetSelector;return this.select("streamItemSelector").filter(function(i,s){return 0===e(s).find(t).length})},this.getInsertionIndexForPrompt=function(t){var i=t.renderData.pointerTweetId||this.getTweetIdForPrompt(t),s=this.select("streamItemSelector").map(function(){return e(this).data("item-id").toString()}).toArray();return s.indexOf(i)},this.getTweetIdForPrompt=function(t){var e=this.attr.tweetSelectionAlgorithmMap[t.renderData.pointerTweetSelection];if(this[e]){var i=this[e]();return i.size()>0?i.data("item-id").toString():void 0}},this.getMutualFollowTweet=function(){return this.getEligibleTweets().filter(function(t,i){var s=e(i).find(this.attr.originalTweetSelector);return s.data("you-follow")&&s.data("follows-you")}.bind(this)).eq(0)},this.getNotFollowingTweet=function(){return this.getEligibleTweets().filter(function(t,i){return!e(i).find(this.attr.originalTweetSelector).data("you-follow")}.bind(this)).eq(0)},this.getMostFavoritedTweet=function(){var t=this.getEligibleTweets().filter(function(t,i){return!e(i).find(this.attr.originalTweetSelector).hasClass(this.attr.favoritedClass)}.bind(this));return t.sort(function(t,i){var s=function(t){return e(t).find(this.attr.favoriteCountSelector).data(this.attr.tweetStatCountSelector)}.bind(this);return s(i)-s(t)}.bind(this)).eq(0)},this.after("initialize",function(){this.on("uiPromptNeedsInsertionIndex",this.getInsertionIndex)})}var n=i(10);t.exports=n(s)}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({promptType:"modal",backgroundCloseTarget:".close-modal-background-target",top:120,width:590,blockClickDuration:2e3}),this.insertPrompt=function(t){this.disableBackgroundClicks(),this.select("modalContentSelector").html(t.html),this.open(),this.adjustCloseBtnPosition()},this.removePrompt=function(){},this.disableBackgroundClicks=function(){var t=function(t){t.stopImmediatePropagation()},e=this.select("backgroundCloseTarget");e.on("click",t),setTimeout(function(){e.off("click",t)},this.attr.blockClickDuration)},this.adjustCloseBtnPosition=function(){this.select("closeButtonSelector").remove(),this.select("promptSelector").append(this.$modalCloseBtn)},this.dismissPromptOnDismissDialog=function(){this.isOpen()&&this.dismissPrompt(this.select("promptSelector"))},this.onUiShortcutEsc=function(){this.isOpen()&&this.trigger("uiPromptbirdModalPromptKeyboardDismiss"),this.dismissPromptOnDismissDialog()},this.after("initialize",function(){this.$modalCloseBtn=this.select("closeButtonSelector").clone(!1),this.on(document,"uiShortcutEsc",this.onUiShortcutEsc),this.on("click",{backgroundCloseTarget:this.dismissPromptOnDismissDialog,actionSelector:this.close})})}var n=i(483),o=i(60);t.exports=n.mixin(s,o)},function(t,e,i){(function(e){function s(){this.defaultAttrs({autoSubscribe:!0,allowRegistration:!0,serviceWorkerPath:"/push_service_worker.js",pushCheckinTTL:864e5}),this.subscriptionChangeRequested=function(t,e){if(this.serviceWorkerRegistration&&this.attr.allowRegistration){var i=!this.subscription&&e.subscribe,s=this.subscription&&!e.subscribe;if(i)this.subscribe(this.serviceWorkerRegistration);else if(s){var n=function(){this.subscription=null,this.storeUnregister(),this.trigger("uiBrowserPushUnsubscribe"),this.sendCurrentStatus()}.bind(this);this.subscription.unsubscribe().then(n,n)}}},this.showInitialNotification=function(){this.trigger("uiDisplayNativeNotification",{title:"Personaliza tus notificaciones",body:"Haz clic para ir a tu configuración y elegir qué notificaciones web quieres recibir",displayDuration:15e3,click:{eventName:"uiPushSettingsNotificationClicked"}})},this.subscribe=function(t){if(t&&this.attr.allowRegistration){var e="granted"===this.getNotificationPermission();e?this.trigger("uiBrowserSilentSubscribeAttempt"):this.trigger("uiBrowserPushPromptImpression"),t.pushManager.subscribe({userVisibleOnly:!0}).then(this.subscribeSuccess.bind(this,e),this.subscribeFailure.bind(this,e))}},this.subscribeSuccess=function(t,e){t?this.trigger("uiBrowserSilentSubscribeSuccess"):this.trigger("uiBrowserPushPromptAllow"),this.subscription=e,this.storeSubscription(this.subscription,!0),this.sendCurrentStatus(),this.showInitialNotification()},this.subscribeFailure=function(t){"denied"===this.getNotificationPermission()?this.trigger("uiBrowserPushPromptDeny"):"default"===this.getNotificationPermission()?this.trigger("uiBrowserPushPromptDismiss"):t?this.trigger("uiBrowserSilentSubscribeError"):this.trigger("uiBrowserPushPromptError")},this.isSupported=function(){var t="PushManager"in window,e="denied"!==this.getNotificationPermission(),i="serviceWorker"in navigator,s=i&&"showNotification"in ServiceWorkerRegistration.prototype;return s&&t&&e&&i},this.serviceWorkerReady=function(t){this.serviceWorkerRegistration=t,this.serviceWorkerRegistration.pushManager.getSubscription().then(function(e){this.subscription=e,"granted"===this.getNotificationPermission()&&this.trigger("uiABImpression",{experiment:"web_native_push_notifications_4335"}),"granted"===this.getNotificationPermission()&&!e&&this.attr.autoSubscribe?this.subscribe(t):this.sendCurrentStatus(),this.storeSubscription(this.subscription)}.bind(this))},this.getNotificationPermission=function(){return"Notification"in window&&Notification.permission},this.storeSubscription=function(t,i){if(t&&(!this.storage.getItem("isSaved")||i)){var s={subscribe:!0,token:t.endpoint};t.subscriptionId&&t.endpoint.indexOf(t.subscriptionId)===-1&&(s.token=t.endpoint+"/"+t.subscriptionId),this.post({url:"/i/push_destinations",data:s,success:function(){this.storage.setItem("isSaved",!0,this.attr.pushCheckinTTL)}.bind(this),error:e.noop})}},this.storeUnregister=function(){this.storage.clear(),this.post({url:"/i/push_destinations/destroy",success:e.noop,error:e.noop})},this.sendCurrentStatus=function(){this.trigger("dataPushSubscriptionState",{supported:this.attr.allowRegistration&&this.supported,subscribed:!!this.subscription})},this.navigateToSettings=function(t,e){this.trigger("uiNavigate",{href:"/settings/web_notifications"})},this.after("initialize",function(){if(this.serviceWorkerRegistration=null,this.subscription=null,this.on("uiPushSettingsNotificationClicked",this.navigateToSettings),this.supported=this.isSupported(),this.supported){var t=o({withExpiry:!0});this.storage=new t("push_notifications"),this.on("uiWantsPushSubscriptionState",this.sendCurrentStatus),this.on("uiPushSubscriptionChangeRequested",this.subscriptionChangeRequested);var e=navigator.serviceWorker;e.register(this.attr.serviceWorkerPath).then(function(){return e.ready}).then(this.serviceWorkerReady.bind(this)).then(void 0,function(){this.supported=!1,this.sendCurrentStatus()}.bind(this))}else"denied"===this.getNotificationPermission()&&this.trigger("uiBrowserPushPermissionDenied"),this.sendCurrentStatus()})}var n=i(10),o=i(226),a=i(225);i(22);t.exports=n(s,a)}).call(e,i(1))},function(t,e,i){function s(){this.after("initialize",function(){this.scribeOnEvent("uiPushPromptShown",{component:"push_manager",element:"soft_prompt",action:"impression"}),this.scribeOnEvent("uiPushPromptClick",{component:"push_manager",element:"soft_prompt",action:"click"}),this.scribeOnEvent("uiPushPromptDismiss",{component:"push_manager",element:"soft_prompt",action:"dismiss"}),this.scribeOnEvent("uiBrowserPushPromptImpression",{component:"push_manager",element:"browser_prompt",action:"impression"}),this.scribeOnEvent("uiBrowserPushPromptAllow",{component:"push_manager",element:"browser_prompt",action:"permissions_granted"}),this.scribeOnEvent("uiBrowserPushPromptDeny",{component:"push_manager",element:"browser_prompt",action:"permissions_denied"}),this.scribeOnEvent("uiBrowserPushPermissionDenied",{component:"push_manager",action:"permissions_denied"}),this.scribeOnEvent("uiBrowserPushPromptDismiss",{component:"push_manager",element:"browser_prompt",action:"dismiss"}),this.scribeOnEvent("uiBrowserPushPromptError",{component:"push_manager",element:"browser_prompt",action:"permissions_error"}),this.scribeOnEvent("uiBrowserPushUnsubscribe",{component:"push_manager",action:"disable"}),this.scribeOnEvent("uiBrowserSilentSubscribeAttempt",{component:"push_manager",element:"silent_subscribe",action:"impression"}),this.scribeOnEvent("uiBrowserSilentSubscribeError",{component:"push_manager",element:"silent_subscribe",action:"error"}),this.scribeOnEvent("uiBrowserSilentSubscribeSuccess",{component:"push_manager",element:"silent_subscribe",action:"success"})})}var n=i(10),o=i(40);t.exports=n(o,s)},function(t,e,i){(function(e){function s(){"use strict";this.defaultAttrs({quickPromoteIframeSelector:".quick-promote-iframe",cancelButtonSelector:".cancel-action",top:47}),this.openDialog=function(t,i){var s=e(t.target),n=s.attr("data-tfb-view");this.select("quickPromoteIframeSelector").attr("src",n),this.open(),this.scribeDialogOpenInteraction(t)},this.closeDialog=function(t,e){this.select("quickPromoteIframeSelector").removeAttr("src style"),this.off(window,"message",this.postMessageHandler)},this.postMessageHandler=function(t){var e=t.originalEvent,i=!1;if(e.origin===window.location.protocol+"//"+window.location.host){if("string"==typeof e.data&&"undefined"!==e.data)try{i=JSON.parse(e.data)}catch(s){}if(i&&i.name&&"quick_promote"===i.name)if("resize"===i.type)this.adjustIframeHeight(e);else if("scribe"===i.type){var n=i.scribeData||{};this.scribeUiInteraction(n.uiEvent,n.data)}else"close"===i.type&&this.close()}},this.scribeDialogOpenInteraction=function(t){this.scribe({component:"tweet",element:"view_tweet_analytics",action:"navigate"})},this.scribeUiInteraction=function(t,e){t=t&&t.toLowerCase();var i=["click","confirm"];i.indexOf(t)>=0&&this.scribe({component:"tweet",element:"quick_promote",action:t})},this.adjustIframeHeight=function(t){var e={iframeSelector:this.attr.quickPromoteIframeSelector,isQualified:function(t){return t.height}};this.fitIframeHeight(t,e)},this.setupMessageListener=function(){this.on(window,"message",this.postMessageHandler)},this.after("initialize",function(){this.on("click",{cancelButtonSelector:this.close}),this.on("uiDialogOpened",this.setupMessageListener),this.on(document,"uiOpenQuickPromoteDialog",this.openDialog),this.on("uiDialogClosed",this.closeDialog),this.on(window,"message",this.postMessageHandler)})}var n=i(10),o=i(60),a=i(69),r=i(68),c=i(40),h=n(s,o,r,a,c);t.exports=h}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({reporterUserIdSelector:"#current-user-id",newReportFlowFormSelector:".new-report-flow-form",newReportFlowIframeSelector:"#new-report-flow-frame",newReportFlowNextSelector:".new-report-flow-next-button",newReportFlowNextTextSelector:".next-text",newReportFlowAddTextSelector:".add-text",newReportFlowBackSelector:".new-report-flow-back-button",newReportFlowCloseSelector:".new-report-flow-close-button",newReportFlowDoneSelector:".new-report-flow-done-button"}),this.setUpDialog=function(t,e){this.reset(),this.clientEvent=e.clientEvent||o,this.eventData=e,this.setTriggeredTarget(),this.setNewReportFlowContext(),this.showNewReportFlow(),this.open()},this.reset=function(){this.isComplete=!1},this.setTriggeredTarget=function(){this.$node.removeClass("report-moment report-user report-tweet"),"user"===this.eventData.target?this.$node.addClass("report-user"):"moment"===this.eventData.target?this.$node.addClass("report-moment"):this.$node.addClass("report-tweet")},this.buildReportClientContextParams=function(t){var e=this.clientEvent.scribeContext.page,i=this.clientEvent.scribeContext.section||"",s=this.eventData.scribeContext?this.eventData.scribeContext.component||"":"",n=e+":"+i+":"+s;if(t.client_location=n,this.clientEvent.scribeData)switch(this.clientEvent.scribeData.internal_referer&&(t.client_referer=this.clientEvent.scribeData.internal_referer),e){case"profile":t.profile_id=this.clientEvent.scribeData.profile_id||"";break;case"search":this.clientEvent.scribeData.search_details&&(t.search_query=this.clientEvent.scribeData.search_details.query||"",t.search_source=this.clientEvent.scribeData.search_details.query_source||"")}return t},this.buildReportSourceParams=function(t){return this.$node.hasClass("report-user")?t.source="reportprofile":this.$node.hasClass("report-moment")?(t.source="reportmoment",t.is_media="true",t.reported_moment_id=this.eventData.momentId,t.reported_tweet_id=this.eventData.tweetId):(t.source="reporttweet",t.reported_moment_id=this.eventData.momentId,t.reported_tweet_id=this.eventData.tweetId),t},this.setNewReportFlowContext=function(){var t=this.select("reporterUserIdSelector").val(),e=(!!this.eventData.mediaType).toString(),i=("promoted"===this.eventData.disclosureType).toString(),s={next_view:"report_story_start",reporter_user_id:t,reported_user_id:this.eventData.userId,is_media:e,is_promoted:i},n=this.buildReportSourceParams(s),o="/i/safety/report_story?"+r.encode(this.buildReportClientContextParams(n));this.select("newReportFlowIframeSelector").attr("src",o)},this.showNewReportFlow=function(){this.$node.addClass("new-report-flow-dialog"),this.$node.attr("aria-hidden",!1),this.select("newReportFlowBackSelector").hide(),this.select("newReportFlowDoneSelector").hide(),this.select("newReportFlowNextSelector").show(),this.select("newReportFlowNextTextSelector").show(),this.select("newReportFlowAddTextSelector").hide()},this.cancelReport=function(){this.trigger("uiDidCancelReport",this.eventData)},this.completeReport=function(){this.isComplete=!0,this.close()},this.around("close",function(t){this.isOpen()&&!this.isComplete&&this.cancelReport(),this.select("newReportFlowIframeSelector").attr("src",""),t()}),this.newReportFlowFrameNext=function(){this.select("newReportFlowIframeSelector").contents().find("#report_webview_form").submit()},this.newReportFlowFrameBack=function(){this.select("newReportFlowNextTextSelector").show(),this.select("newReportFlowAddTextSelector").hide(),this.select("newReportFlowIframeSelector").get(0).contentWindow.history.back()},this.checkNewReportFlowContentAndUpdate=function(){var t=this.select("newReportFlowIframeSelector").contents().get(0).location,e=t.href.indexOf("report_story_start")>=0,i=t.href.indexOf("/i/safety/report_story_complete")>=0;if(e)this.select("newReportFlowBackSelector").hide(),this.select("newReportFlowDoneSelector").hide(),this.select("newReportFlowCloseSelector").hide(),this.select("newReportFlowNextTextSelector").show(),this.select("newReportFlowAddTextSelector").hide();else if(i){this.select("newReportFlowBackSelector").hide(),this.select("newReportFlowNextSelector").hide(),this.select("newReportFlowAddTextSelector").hide(),this.select("newReportFlowNextTextSelector").hide(),this.select("newReportFlowDoneSelector").show();var s=t.search.match(/\baction=([^&]+)/);if(null!=s){var n={userId:this.eventData.userId,impressionId:this.eventData.impressionId,disclosureType:this.eventData.disclosureType,skipScribe:!0},o=s[1].toLowerCase();if("error"===o)this.select("newReportFlowCloseSelector").show(),this.select("newReportFlowBackSelector").hide(),this.select("newReportFlowDoneSelector").hide();else{var a;"mute"===o?a="uiDidMuteUser":"block"===o?a="uiBlockAction":"unfollow"===o&&(a="uiUnfollowAction"),void 0!==a&&this.trigger(a,n),this.completeReport()}}}else this.select("newReportFlowBackSelector").show(),this.select("newReportFlowDoneSelector").hide(),this.select("newReportFlowCloseSelector").hide()},this.after("initialize",function(){this.isComplete=!1,this.on(document,"uiNeedsReportDialog",this.setUpDialog);var t=this;this.select("newReportFlowIframeSelector").on("load",function(){t.checkNewReportFlowContentAndUpdate()}),this.on("click",{newReportFlowNextSelector:this.newReportFlowFrameNext,newReportFlowBackSelector:this.newReportFlowFrameBack,newReportFlowDoneSelector:this.close,newReportFlowCloseSelector:this.close})})}var n=i(10),o=i(32),a=i(60),r=i(233),c=n(a,s);t.exports=c},function(t,e,i){(function(e){function s(){this.defaultAttrs({leftDashboardSelector:".dashboard-left",rightDashboardSelector:".dashboard-right",roamingSelector:".roaming-module:not(.roaming-top-module)",roamingTopSelector:".roaming-module.roaming-top-module",threeColWidth:1236}),this.setWindowWidth=function(t){this.windowWidth=this.$window.width(),this.windowWidth<this.attr.threeColWidth?(this.threeCol||t)&&(this.$dashboardLeft.prepend(this.$dashboardRight.find(this.attr.roamingTopSelector)),this.$dashboardLeft.append(this.$dashboardRight.find(this.attr.roamingSelector)),this.$body.removeClass("three-col"),this.threeCol=!1):this.threeCol&&!t||(this.$dashboardRight.prepend(this.$dashboardLeft.find(this.attr.roamingTopSelector)),this.$dashboardRight.append(this.$dashboardLeft.find(this.attr.roamingSelector)),this.$body.addClass("three-col"),this.threeCol=!0)},this.after("initialize",function(){this.$dashboardRight=this.select("rightDashboardSelector"),this.$dashboardRight.length&&(this.$window=e(window),this.$body=e(document.body),this.$dashboardLeft=this.select("leftDashboardSelector"),this.threeCol=!1,this.setWindowWidth(!0),this.on(window,"resize",o.debounce(this.setWindowWidth.bind(this),100)))})}var n=i(10),o=i(25);t.exports=n(s)}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaults={retweetSelector:".retweet-action",commentBoxSelector:".RetweetDialog-commentBox",tweetBoxSelector:"form.tweet-form",isWithCommentClass:"is-withComment",composeIgnoreAttachmentText:!1,top:"20%"},this.openRetweet=function(t,e){this.tweetBoxReady||(r.attachTo(this.$tweetBox,{condensable:!0,thumbnailSize:"large",condenseContainer:this.attr.commentBoxSelector,typeaheadData:this.attr.typeaheadData,noTeardown:this.attr.noTeardown,ignoreAttachmentText:this.attr.composeIgnoreAttachmentText,hashflagsEnabled:!0}),this.tweetBoxReady=!0),this.trigger(this.$tweetBox,"uiOverrideTweetBoxOptions",{draftTweetId:"retweet_"+e.tweetId,urlToRetweet:["https://twitter.com",e.screenName,"status",e.id].join("/"),impressionId:e.impressionId,earned:e.disclosureType?"earned"===e.disclosureType:void 0}),this.sourceEventData=e,this.displayTweet(e.id,{modal:"retweet",disableLinks:!0}),this.open()},this.retweet=function(){this.$tweetBox.hasClass(this.attr.isWithCommentClass)||this.trigger("uiDidRetweet",this.sourceEventData)},this.retweetSuccess=function(t,e){void 0!==this.sourceEventData&&(this.trigger("uiDidRetweetSuccess",this.sourceEventData),"uiRetweetWithCommentSuccess"===t.type&&this.trigger("uiDidRetweetWithCommentSuccess",this.sourceEventData)),this.close(),this.sourceEventData=void 0},this.restoreFocusToTweet=function(t){e(t.target).is(this.$dialog)&&this.activeEl&&(t.preventDefault(),this.trigger(e(this.activeEl).closest(".tweet"),"uiShouldAddFocusStyle"),this.activeEl.focus())},this.updateTitle=function(t,e){e&&e.title&&this.select("modalTitleSelector").text(e.title)},this.after("initialize",function(t){this.$tweetBox=this.select("tweetBoxSelector"),this.on("click",{retweetSelector:this.retweet}),this.on(document,"uiOpenRetweetDialog",this.openRetweet),this.on(document,"uiRetweetWithCommentSuccess dataDidRetweet",this.retweetSuccess),this.on(document,"uiDialogRestorePreviousFocus",this.restoreFocusToTweet),this.on("uiDialogUpdateTitle",this.updateTitle)})}var n=i(10),o=i(60),a=i(77),r=i(515);t.exports=n(s,o,a)}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({tweetActionSelector:".retweet-action",tweetboxId:"retweet",isWithCommentClass:"is-withComment"}),this.dmRegex=/^\s*(?:d|m|dm)\s+[@＠]?(\S+)\s*(.*)/i,this.createDataForSending=function(){var t={status:this.getVisibleText(),impression_id:this.impressionId,earned:this.earned,attachment_url:this.urlToRetweet};return t},this.isEmpty=function(){return!this.getVisibleText().trim()},this.hasAttachment=function(){return!0},this.sendRetweet=function(){this.detectUpdatedText(),this.isEmpty()||(this.trigger("uiSendTweet",{tweetboxId:this.attr.tweetboxId,tweetData:this.createDataForSending()}),this.$node.addClass("tweeting"),this.disable())},this.updateTweetStateOnTextChanged=function(t){var e=!this.isEmpty();this.maxReached()||this.$node.hasClass("tweeting")||this.getVisibleText().match(this.dmRegex)?this.disable():this.enable(),this.$node.toggleClass(this.attr.isWithCommentClass,e),e?this.trigger("uiDialogUpdateTitle",{title:"Citar Tweet"}):this.trigger("uiDialogRestoreTitle")},this.retweetSent=function(t,e){var i=e.tweetboxId||e.sourceEventData.tweetboxId;i===this.attr.tweetboxId&&(this.trigger("uiShowMessage",{message:"¡Tu Tweet ha sido enviado!"}),this.trigger("uiRetweetWithCommentSuccess",e),this.$node.removeClass("tweeting"),this.clear())},this.retweetError=function(t,e){var i=e.tweetboxId||e.sourceEventData.tweetboxId;i===this.attr.tweetboxId&&(this.$node.removeClass("tweeting"),this.enable())},this.enable=function(){this.$tweetButton.removeClass("disabled").attr("disabled",!1)},this.disable=function(){this.$tweetButton.addClass("disabled").attr("disabled",!0)},this.clear=function(){this.reset()},this.reset=function(){this.resetTweetText()},this.resetAndFocus=function(){this.reset(),this.focus()},this.resetTweetText=function(){this.trigger("uiClearUndoState"),this.setVisibleText("")},this.handleCmdEnterSubmit=function(){this.$tweetButton.hasClass("disabled")||this.$tweetButton.click()},this.overrideOptions=function(t,e){this.urlToRetweet=e.urlToRetweet,this.impressionId=e.impressionId,this.earned=e.earned},this.after("initialize",function(){this.$tweetButton=this.select("tweetActionSelector"),this.on("uiTextChanged",this.updateTweetStateOnTextChanged),this.on("uiComposerResetAndFocus",this.resetAndFocus),this.initDraftTweets(),this.initTextNode(),this.on(this.$tweetButton,"click",this.sendRetweet),this.on("uiShortcutCmdEnter",this.handleCmdEnterSubmit),this.on(document,"dataTweetSuccess",this.retweetSent),this.on(document,"dataTweetError",this.retweetError),this.on("uiOverrideTweetBoxOptions",this.overrideOptions),this.reset()})}var n=(i(22),i(10)),o=i(516),a=i(217),r=i(517),c=i(301),h=i(302),l=i(212),d=i(303),u=i(518);t.exports=n(s,o,l,d,a,h,r,u,c)},,,,function(t,e,i){"use strict";function s(){this.saveSearch=function(t,e){this.post({url:"/i/saved_searches/create.json",data:e,eventData:{scribeComponent:e.scribeComponent,scribeAction:"add"},success:"dataAddedSavedSearch",error:"dataSavedSearchError"})},this.removeSavedSearch=function(t,e){this.post({url:"/i/saved_searches/destroy/"+encodeURIComponent(e.id)+".json",data:"",eventData:{scribeComponent:e.scribeComponent,scribeAction:"remove"},success:"dataRemovedSavedSearch",error:"dataSavedSearchError"})},this.after("initialize",function(){this.on("uiAddSavedSearch",this.saveSearch),this.on("uiRemoveSavedSearch",this.removeSavedSearch)})}var n=i(10),o=i(225),a=i(234);t.exports=n(s,o,a)},function(t,e,i){function s(){this.scribeSavedSearchAction=function(t,e){this.scribe({component:e.sourceEventData.scribeComponent,element:"saved_search",action:e.sourceEventData.scribeAction})},this.after("initialize",function(){this.on("dataAddedSavedSearch dataRemovedSavedSearch",this.scribeSavedSearchAction)})}var n=i(10),o=i(40);t.exports=n(s,o)},function(t,e,i){(function(e){function s(){this.defaultAttrs({querySourceLinkSelector:"a[data-query-source]",querySourceDataAttr:"data-query-source",storageExpiration:6e4}),this.saveQuerySource=function(t){this.storage.setItem("source",{source:{value:t,expire:Date.now()+this.attr.storageExpiration}},this.attr.storageExpiration)},this.catchLinkClick=function(t,i){var s=e(i.el).attr(this.attr.querySourceDataAttr);s&&this.saveQuerySource(s)},this.saveTypedQuery=function(t,e){"search"===e.source&&this.saveQuerySource("typed_query")},this.after("initialize",function(){var t=o({withExpiry:!0});this.storage=new t("searchQuerySource"),this.on("click",{querySourceLinkSelector:this.catchLinkClick}),this.on("uiSearchQuery",this.saveTypedQuery)})}var n=i(10),o=i(226);t.exports=n(s)}).call(e,i(1))},function(t,e,i){function s(){this.handleMessage=function(t){try{var e=JSON.parse(t.data),i=e.event,s=e.data;this.trigger(i,s)}catch(n){}},this.after("initialize",function(){navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",this.handleMessage.bind(this))})}var n=i(10),o=n(s);t.exports=o},function(t,e,i){(function(e){function s(){this.smsConfirmationAjaxCall=function(t,i,s){function n(t){t.error?this.trigger("uiAlertBanner",t):this.trigger(s,{message:t.message})}var o=e.extend({user_id:t.userId},t);this.post({url:i,data:o,success:n.bind(this),error:"dataUserActionError"})},this.sendPinAction=function(t,e){var i={phone_number:e.phone_number,country_code:e.country_code};this.smsConfirmationAjaxCall(i,"/i/devices/sms_confirmation_begin","dataSendPinSuccess")},this.resendPinAction=function(t,e){var i={phone_number:e.phone_number,country_code:e.country_code,resend:!0};this.smsConfirmationAjaxCall(i,"/i/devices/sms_confirmation_begin","dataResendPinSuccess")},this.verifyPinAction=function(t,e){var i={numeric_pin:e.numeric_pin,phone_number:e.phone_number,country_code:e.country_code};this.smsConfirmationAjaxCall(i,"/i/devices/sms_confirmation_complete","dataVerifyPinSuccess")},this.after("initialize",function(){this.on(document,"uiSendPinAction",this.sendPinAction),this.on(document,"uiResendPinAction",this.resendPinAction),this.on(document,"uiVerifyPinAction",this.verifyPinAction)})}var n=i(10),o=i(225),a=n(s,o);t.exports=a}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({phoneNumberInputModalSelector:"#sms-confirmation-begin-modal",pinVerificationModalSelector:"#sms-confirmation-complete-modal",alertBoxSelector:"#sms-alert-box",alertMessageSelector:"#sms-alert-message",alertBoxCloseSelector:"#sms-alert-close",authenticityTokenSelector:"#authenticity_token",resendCodeSelector:"#resend_code"}),this.setUpDialog=function(t,e){this.reset(),this.open()},this.reset=function(){this.select("pinVerificationModalSelector").hide(),this.select("phoneNumberSelector").val(""),this.savedPhoneNumber="",this.savedCountryCode=""},this.afterOpen=function(){this.position(),this.select("alertBoxSelector").hide()},this.alertBannerHandler=function(t,e){this.showAlert(e.message)},this.showAlert=function(t){this.select("alertBoxSelector").show(),this.select("alertMessageSelector").text(t)},this.hideAlert=function(){this.select("alertBoxSelector").hide(),this.select("alertMessageSelector").text("")},this.sendPinCode=function(t,e){t.preventDefault(),
this.callbackIfValidPhoneNumber(function(){var t=this.select("phoneNumberSelector").val(),e=this.select("countryCodeSelector").val();this.savedPhoneNumber=t,this.savedCountryCode=e,this.trigger("uiSendPinAction",{phone_number:t,country_code:e})})},this.resendPinCode=function(){this.trigger("uiResendPinAction",{phone_number:this.savedPhoneNumber,country_code:this.savedCountryCode})},this.verifyPinCode=function(t,e){t.preventDefault();var i=this.stripPin(this.select("pinCodeSelectorRaw").val());return i?void this.trigger("uiVerifyPinAction",{numeric_pin:i,phone_number:this.savedPhoneNumber,country_code:this.savedCountryCode}):void this.showAlert("Código incorrecto. Por favor, vuelve a intentarlo o solicita uno nuevo.")},this.sendPinSuccess=function(t,e){this.select("phoneNumberInputModalSelector").remove(),this.hideAlert();var i=this.trimSavedPhoneNumber();this.select("pinVerificationModalSelector").find("#phone_number_to_verify").html(i),this.select("pinVerificationModalSelector").show(),this.trigger("uiVerifyPinFormImpression")},this.trimSavedPhoneNumber=function(){var t=/\(*\)*\+*-*#* */g,e=this.savedPhoneNumber.replace(t,"");return this.savedCountryCode+e},this.verifyPinSuccess=function(t,e){this.isCompleted=!0,this.close(),this.trigger("uiShowMessage",{message:"Tu cuenta está desbloqueada."})},this.resendPinSuccess=function(t,e){this.showAlert(e.message)},this.updateSmsConfirmationCountryCode=function(t,e){this.trigger("uiSmsConfirmationCountryChange")},this.phoneNumberInput=function(t,e){this.startedPhoneInput||(this.trigger("uiSmsConfirmationPhoneNumberInput"),this.startedPhoneInput=!0)},this.pinInput=function(t,e){this.startedPinInput||(this.trigger("uiSmsConfirmationPinCodeInput"),this.startedPinInput=!0)},this.around("close",function(t){this.isOpen()&&!this.isCompleted&&this.trigger("uiCancelSmsConfirmationDialog"),t()}),this.after("initialize",function(){this.on(document,"uiNeedsSmsConfirmationDialog",this.setUpDialog),this.on("uiDialogOpened",this.afterOpen),this.on(document,"dataSendPinSuccess",this.sendPinSuccess),this.on(document,"dataResendPinSuccess",this.resendPinSuccess),this.on(document,"dataVerifyPinSuccess",this.verifyPinSuccess);var t=this.attr.show_sms_confirmation_dialog;t&&this.trigger("uiNeedsSmsConfirmationDialog"),this.on("click",{submitRegisterButtonSelector:this.sendPinCode,submitVerifyButtonSelector:this.verifyPinCode,alertBoxCloseSelector:this.clearInvalidPhoneMessage,resendCodeSelector:this.resendPinCode}),this.on("uiAlertBanner",this.alertBannerHandler),this.on("uiAlertBannerClose",this.hideAlert),this.on("submit",{phoneNumberInputModalSelector:this.sendPinCode,pinVerificationModalSelector:this.verifyPinCode}),this.on("change",{countryNameSelector:this.updateSmsConfirmationCountryCode}),this.on("input",{phoneNumberSelector:this.phoneNumberInput,pinCodeSelectorRaw:this.pinInput}),this.startedPhoneInput=!1,this.startedPinInput=!1,this.isCompleted=!1})}var n=i(10),o=(i(22),i(60)),a=i(525),r=n(o,a,s);t.exports=r},function(t,e,i){function s(){this.defaultAttrs({countryCodeDisplaySelector:"#country_code_display",countryCodeSelector:"#country_code",countryNameSelector:"#device_country_code",phoneNumberSelector:"#phone_number",pinCodeSelector:"#numeric_pin",pinCodeSelectorRaw:"#numeric_pin_raw",submitRegisterButtonSelector:"#send_verification_pin",submitVerifyButtonSelector:"#device_verify"}),this.updateCountryCode=function(t,e){var i=e.value;this.select("countryCodeDisplaySelector").html("+"+i),this.select("countryCodeSelector").val(i),""!==this.select("phoneNumberSelector").val()&&this.callbackIfValidPhoneNumber(this.clearInvalidPhoneMessage)},this.callbackIfValidPhoneNumber=function(t){var e=this.select("countryCodeSelector").val(),i=this.select("phoneNumberSelector").val(),s=this.validatePhoneNumber(e,i);s?t.call(this):this.showInvalidPhoneMessage(e)},this.showInvalidPhoneMessage=function(t){var e="Los números de teléfono de Estados Unidos y Canadá deben tener 11 dígitos.",i="Este número de teléfono parece no ser válido.",s="1"===t?e:i;s+="Por favor, ingresa un número de teléfono válido.",this.trigger("uiAlertBanner",{message:s})},this.clearInvalidPhoneMessage=function(){this.trigger("uiAlertBannerClose")},this.validatePhoneNumber=function(t,e){var i=/\(*\)*\+*-*#* */g,s=e.replace(i,""),n=/^\d{11}$/;return"1"!==t&&(n=/^\d{10,15}$/),n.test(t+s)},this.enableIfValue=function(t){return function(e,i){var s=e.target||e.srcElement;this.select(t).attr("disabled",""===s.value)}},this.stripPin=function(t){return t.replace(/[^a-zA-Z0-9]/g,"")},this.after("initialize",function(){n.attachTo(this.attr.countryNameSelector),this.on(this.attr.countryNameSelector,"uiItemSelect",this.updateCountryCode),this.on("input",{phoneNumberSelector:this.enableIfValue("submitRegisterButtonSelector"),pinCodeSelectorRaw:this.enableIfValue("submitVerifyButtonSelector")})})}var n=(i(22),i(526));t.exports=s},function(t,e,i){(function(e){function s(){this.clickItems=function(t,e){this.trigger("uiItemClick")},this.itemSelect=function(){var t,e,i={index:this.node.selectedIndex};if(this.node.selectedIndex>=0){e=this.node.options[this.node.selectedIndex];for(var s=0;s<e.attributes.length;s++)t=e.attributes[s].name,i[t]=e.attributes[s].value;i.text=e.innerHTML}this.trigger("uiItemSelect",i)},this.setItems=function(t,i){this.$node.empty(),i.items&&i.items.forEach(function(t){var i=e("<option />");for(var s in t)"text"===s?i.html(t[s]):i.attr(s,t[s]);i.appendTo(this.$node)}.bind(this)),this.itemSelect()},this.after("initialize",function(){this.node.jquery&&(this.node=this.node[0]),this.attr.items&&this.node.trigger("setItems",{items:this.attr.items}),this.on("setItems",this.setItems),this.on("change",this.itemSelect),this.on("mousedown",this.clickItems)})}var n=i(10);t.exports=n(s)}).call(e,i(1))},function(t,e,i){function s(){this.scribeDialogImpression=function(t,e){this.scribe({component:"sms_confirmation_dialog",action:"impression"},e)},this.scribeCountryChange=function(t,e){this.scribe({component:"sms_confirmation_dialog",element:"mobile_country_code",action:"change"},e)},this.scribePhoneNumberInput=function(t,e){this.scribe({component:"sms_confirmation_dialog",element:"phone_number",action:"change"},e)},this.scribeSendPinClick=function(t,e){this.scribe({component:"sms_confirmation_dialog",element:"activate_mobile",action:"click"},e)},this.scribeVerifyPinFormImpression=function(t,e){this.scribe({component:"sms_confirmation_dialog",element:"verify_pin",action:"impression"},e)},this.scribePinCodeInput=function(t,e){this.scribe({component:"sms_confirmation_dialog",element:"verify_pin",action:"input"},e)},this.scribeVerifyButtonClick=function(t,e){this.scribe({component:"sms_confirmation_dialog",element:"verify_pin",action:"click"},e)},this.scribeResendPinCodeButtonClick=function(t,e){this.scribe({component:"sms_confirmation_dialog",element:"resend_pin",action:"click"},e)},this.scribeDialogCancelClick=function(t,e){this.scribe({component:"sms_confirmation_dialog",action:"cancel"},e)},this.scribeUnlockSuccessImpression=function(t,e){this.scribe({component:"sms_confirmation_dialog",element:"verify_pin",action:"success"},e)},this.after("initialize",function(){this.on("dataVerifyPinSuccess",this.scribeUnlockSuccessImpression),this.on("uiCancelSmsConfirmationDialog",this.scribeDialogCancelClick),this.on("uiNeedsSmsConfirmationDialog",this.scribeDialogImpression),this.on("uiResendPinAction",this.scribeResendPinCodeButtonClick),this.on("uiSendPinAction",this.scribeSendPinClick),this.on("uiSmsConfirmationCountryChange",this.scribeCountryChange),this.on("uiSmsConfirmationPhoneNumberInput",this.scribePhoneNumberInput),this.on("uiSmsConfirmationPinCodeInput",this.scribePinCodeInput),this.on("uiVerifyPinAction",this.scribeVerifyButtonClick),this.on("uiVerifyPinFormImpression",this.scribeVerifyPinFormImpression)})}var n=i(10),o=i(40);t.exports=n(s,o)},function(t,e,i){(function(e){function s(){this.defaultAttrs({supportedChallengeTypes:["Captcha"],captchaName:"Captcha",defaultCompletionMessage:"Desafío completado.",recaptchaLoadTime:100,maxCaptchaLoadRetries:3}),this.hitChallengeEndpoint=function(t){this.get({url:"/account/challenge",data:{challenge:t.challenge,response:t.response,challenge_name:t.challengeName},success:this.handleSuccessResponse.bind(this),error:this.handleErrorResponse.bind(this)})},this.handleErrorResponse=function(t){this.closeCurrentChallenge(),this.resetChallengeParams()},this.closeCurrentChallenge=function(){this.currentChallenge&&this.trigger("uiCloseSpam"+this.currentChallenge+"Challenge")},this.allChallengesCompleted=function(t){return!t.challengeName},this.isValidChallengeType=function(t){return this.attr.supportedChallengeTypes.indexOf(t.challengeName)!==-1},this.needToRefreshCaptchaChallenge=function(t){return this.currentChallenge===this.attr.captchaName&&t.challengeName===this.attr.captchaName},this.handleSuccessResponse=function(t){this.allChallengesCompleted(t)?(this.closeCurrentChallenge(),this.sendCompletionMessage(),this.resetChallengeParams()):this.needToRefreshCaptchaChallenge(t)?this.trigger("uiRefreshSpamCaptchaChallenge"):this.isValidChallengeType(t)?(this.closeCurrentChallenge(),this.setAndOpenNewChallenge(t)):(this.closeCurrentChallenge(),this.resetChallengeParams())},this.setAndOpenNewChallenge=function(t){this.setChallengeParams(t.challengeName,t.completionMessage),this.trigger("uiOpenSpam"+this.currentChallenge+"Challenge",t)},this.sendCompletionMessage=function(){this.trigger("uiShowMessage",{message:this.getCompletionMessage()})},this.getCompletionMessage=function(){return this.completionMessage||this.attr.defaultCompletionMessage},this.createInitialChallenge=function(t,e){this.needToCreateRecaptchaWidget(e)?this.fetchRecaptchaScript(t,e):this.setAndOpenNewChallenge(e)},this.needToCreateRecaptchaWidget=function(t){return t.challengeName===this.attr.captchaName&&!this.isRecaptchaObjectDefined()},this.isRecaptchaObjectDefined=function(){return"undefined"!=typeof Recaptcha},this.fetchScriptDone=function(t,e,i){"success"===i?this.ensureRecaptchaCreatedAndLoadChallenge(t):this.trigger(document,"uiShowError",{message:"Internal server error."})},this.fetchScriptFailure=function(t,e,i){this.trigger(document,"uiShowError",{message:"Internal server error."})},this.fetchRecaptchaScript=function(t,i){e.getScript(this.attr.recaptchaApiUrl).done(this.fetchScriptDone.bind(this,i)).fail(this.fetchScriptFailure.bind(this))},this.ensureRecaptchaCreatedAndLoadChallenge=function(t){return this.isRecaptchaObjectDefined()?void this.setAndOpenNewChallenge(t):(this.loadAttempts=this.attr.maxCaptchaLoadRetries,void(this.recaptchaLoadInterval=setInterval(this.checkIfRecaptchaCreated.bind(this,t),this.attr.recaptchaLoadTime)))},this.clearRecaptchLoadInterval=function(){clearInterval(this.recaptchaLoadInterval)},this.clearLoadAttempts=function(){this.loadAttempts=void 0},this.isLoadAttemptsDefined=function(){return"undefined"!=typeof this.loadAttempts},this.checkIfRecaptchaCreated=function(t){this.isLoadAttemptsDefined()&&this.loadAttempts--,this.isRecaptchaObjectDefined()&&(this.clearRecaptchLoadInterval(),this.setAndOpenNewChallenge(t),this.clearLoadAttempts()),(!this.isLoadAttemptsDefined()||this.loadAttempts<=0)&&(this.clearRecaptchLoadInterval(),this.clearLoadAttempts(),this.trigger(document,"uiShowError",{message:"Internal server error."}))},this.submitChallenge=function(t,e){this.hitChallengeEndpoint(e)},this.resetChallengeParams=function(){this.setChallengeParams()},this.setChallengeParams=function(t,e){this.currentChallenge=t,this.completionMessage=e},this.after("initialize",function(){this.on("uiSubmitSpamChallenge",this.submitChallenge),this.on("dataInitialChallengeNeeded",this.createInitialChallenge)})}var n=i(10),o=(i(22),i(225));t.exports=n(s,o)}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.scribeSruStats=function(t,i){var s=["stats","sru",i.mediaCategory,i.command,i.status],n={browser:r(e.browser),append_byte_size:i.appendByteSize,total_duration_ms:i.totalDuration,total_byte_size:i.totalByteSize};this.scribePerftown(s.join(":"),i.duration,n)},this.after("initialize",function(){a.getDecider("web_sru_stats")&&this.on("dataSruStats",this.scribeSruStats)})}var n=i(10),o=i(467),a=i(34),r=i(427);t.exports=n(s,o)}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({tcoSelector:".js-display-url",appendTarget:"head"}),this.preconnect=function(t){var i=t.target.parentNode,s=i&&i.href,n=i&&i.getAttribute("data-expanded-url");n&&s&&0===s.indexOf("https://t.co/")&&e('<link rel="preconnect">').attr({href:n}).appendTo(this.attr.appendTarget)},this.after("initialize",function(){this.on("click",{tcoSelector:this.preconnect})})}var n=i(10),o=n(s);t.exports=o}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({width:590,sourceLangSelector:".TranslationFeedbackDialog-sourceLanguage select",translationInputSelector:".TranslationFeedbackDialog-translationInput",submitSelector:".modal-submit"}),this.openDialog=function(t,e){this.resetDialog(),this.displayTweet(e.tweetId,{modal:"translation_feedback",disableLinks:!0}),this.tweetId=e.tweetId,this.destLang=e.destLang,this.select("sourceLangSelector").val(e.sourceLang),this.setVisibleText(this.unescapeHtml(e.translation)),this.open()},this.resetDialog=function(){this.enableSubmitButton()},this.unescapeHtml=function(t){return e("<div/>").html(t).text()},this.submit=function(){this.disableSubmitButton();var t={id:this.tweetId,source:this.select("sourceLangSelector").val(),dest:this.destLang,translation:this.getVisibleText()};this.trigger("uiSuggestTweetTranslation",t)},this.enableSubmitButton=function(){this.select("submitSelector").removeAttr("disabled")},this.disableSubmitButton=function(){this.select("submitSelector").attr("disabled",!0)},this.isEmpty=function(){return!this.getVisibleText().trim()},this.updateSubmitButton=function(){this.isEmpty()?this.disableSubmitButton():this.enableSubmitButton()},this.translationSubmitted=function(t,e){this.enableSubmitButton(),this.close()},this.submissionError=function(t,e){this.enableSubmitButton(),this.close()},this.after("initialize",function(){this.attr.textSelector=this.attr.translationInputSelector,this.initTextNode(),this.on(document,"uiNeedsTranslationFeedbackDialog",this.openDialog),this.on(document,"dataTweetTranslationSuggestionSuccess",this.translationSubmitted),this.on(document,"dataTweetTranslationSuggestionError",this.submissionError),this.on("uiTextChanged",this.updateSubmitButton),this.on("click",{submitSelector:this.submit})})}var n=i(10),o=i(225),a=i(60),r=i(77),c=i(212);t.exports=n(s,a,c,r,o)}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({favoriteSelector:".js-toggle-fav a, .js-actionFavorite",replySelector:".js-actionReply",retweetSelector:".js-toggleRt a:not([aria-disabled=true]), .js-actionRetweet:not(:disabled)",quickPromoteSelector:".js-actionQuickPromote",permalinkSelector:".tweet .js-permalink",tweetItemSelector:".tweet",retweetInlineSelector:".js-actionInlineRetweet",togglableTweetActionsSelector:"a:visible",toggleContainerSelector:".js-toggleState",otherReplyUsersSelector:".js-other-reply-users",anyLoggedInActionSelector:".js-toggleRt a:not([aria-disabled=true]), .js-toggle-fav a, .js-actionReply, .js-actionRetweet, .js-actionFavorite, .js-actionCount",favoritedTweetClass:"favorited",retweetedTweetClass:"retweeted"}),this.handleTransition=function(t,i){return function(s,n){var a,r=n.id||n.sourceEventData.id,c=o(this.$node,this.attr.tweetItemSelector,r),h=c[0],l=document.activeElement;h&&e.contains(h,l)&&(a=e(l).closest(this.attr.toggleContainerSelector)),c[t](i),a&&a.find(this.attr.togglableTweetActionsSelector).focus()}},this.getDataForReply=function(t){var e,i,s=t.closest("[data-semantic-annotation-ids]").attr("data-semantic-annotation-ids");try{e=JSON.parse(t.attr("data-reply-to-users-json")||"[]"),i=e.map(function(t){return t.screen_name})}catch(n){}return Array.isArray(e)||(e=[],i=a.extractMentionsForReply(t,this.attr.screenName)),r.merge({screenNames:i,isReplyLinkClick:!0,replyToUsers:e,retweetId:t.attr("data-retweet-id"),semanticAnnotationIds:s},!0)},this.toggleFavorite=function(t,e,i){var s=i.$tweet.hasClass(this.attr.favoritedTweetClass)?"uiDidUnfavoriteTweet":"uiDidFavoriteTweet";this.trigger(i.$tweet,s,i.tweetData)},this.toggleRetweet=function(t,e,i){var s=i.$tweet.hasClass(this.attr.retweetedTweetClass)?"uiDidUnretweet":"uiOpenRetweetDialog";this.trigger(i.$tweet,s,i.tweetData)},this.uiOpenSignupDialog=function(t,i,s){var n,o=e(i.el);n=o.is(this.attr.replySelector)?"reply":o.is(this.attr.retweetSelector)?"retweet":o.is(this.attr.favoriteSelector)?"favorite":"default",this.trigger("uiOpenSignupDialog",{screenName:s.tweetData.screenName,action:n})},this.handleLoggedOutFavoriteClick=function(t,e,i){this.trigger("uiLoggedOutActionAttempt",r.merge(i.tweetData,{action:"favorite_attempt"}))},this.handleLoggedOutRetweetClick=function(t,e,i){this.trigger("uiLoggedOutActionAttempt",r.merge(i.tweetData,{action:"retweet_attempt"}))},this.handleLoggedOutReplyClick=function(t,e,i){this.trigger("uiLoggedOutActionAttempt",r.merge(i.tweetData,{action:"reply_attempt"}))},this.otherReplyUsersPopup=function(t,e,i){this.trigger(i.$tweet,"uiRequestActivityPopup",{component:"people_in_conversation_popup",contentId:i.tweetData.tweetId,htmlTitle:"Personas en esta conversación"})},this.after("initialize",function(){var t=this.mkTweetDataCollectorForAction(this.interactionDataWithCard);if(!this.attr.loggedIn)return void this.on("click",{anyLoggedInActionSelector:this.composeHandler(this.preventDefault,this.getClosestTweet,t,this.uiOpenSignupDialog),favoriteSelector:this.composeHandler(this.preventDefault,this.getClosestTweet,t,this.handleLoggedOutFavoriteClick),retweetSelector:this.composeHandler(this.preventDefault,this.getClosestTweet,t,this.handleLoggedOutRetweetClick),replySelector:this.composeHandler(this.preventDefault,this.getClosestTweet,t,this.handleLoggedOutReplyClick)});var e=this.mkTweetDataCollectorForAction(this.interactionDataWithCard,this.getDataForReply);this.on("click",{favoriteSelector:this.composeHandler(this.preventDefault,this.getClosestTweet,t,this.toggleFavorite),retweetSelector:this.composeHandler(this.preventDefault,this.getClosestTweet,t,this.toggleRetweet),replySelector:this.composeHandler(this.preventDefault,this.getClosestTweet,e,this.triggerTweetAction("uiReplyToTweet")),quickPromoteSelector:this.composeHandler(this.preventDefault,this.getClosestTweet,this.triggerTweetAction("uiOpenQuickPromoteDialog")),permalinkSelector:this.composeHandler(this.getClosestTweet,t,this.triggerTweetAction("uiPermalinkClick")),otherReplyUsersSelector:this.composeHandler(this.getClosestTweet,t,this.otherReplyUsersPopup)}),this.on(document,"uiDidFavoriteTweet dataFailedToUnfavoriteTweet",this.handleTransition("addClass",this.attr.favoritedTweetClass)),this.on(document,"uiDidUnfavoriteTweet dataFailedToFavoriteTweet",this.handleTransition("removeClass",this.attr.favoritedTweetClass)),this.on(document,"uiDidRetweet dataFailedToUnretweet",this.handleTransition("addClass",this.attr.retweetedTweetClass)),this.on(document,"uiDidUnretweet dataFailedToRetweet",this.handleTransition("removeClass",this.attr.retweetedTweetClass))})}var n=(i(22),i(10)),o=i(449),a=i(307),r=i(25),c=i(398),h=i(36),l=i(533),d=i(534),u=i(535),m=n(s,c,h,l,d,u);t.exports=m}).call(e,i(1))},function(t,e){function i(){this.before("toggleFavorite",function(t,e,i){i.tweetData.tweetStatCount=i.$tweet.find(".ProfileTweet-action--favorite .ProfileTweet-actionCount").attr("data-tweet-stat-count")}),this.before("toggleRetweet",function(t,e,i){i.tweetData.tweetStatCount=i.$tweet.find(".ProfileTweet-action--retweet .ProfileTweet-actionCount").attr("data-tweet-stat-count")})}t.exports=i},function(t,e,i){(function(e){function i(){this.defaultAttrs({tweetActionContainerSelector:".ProfileTweet-action",animationStateClass:"is-animating",animationTweetSelector:".tweet",animationName:"heart-burst"}),this.getTweetActions=function(t){return t.find(this.attr.tweetActionContainerSelector)},this.isTweetAnimating=function(t){return this.getTweetActions(t).find(this.animationStateClass)},this.cleanupAnimation=function(t){this.isTweetAnimating(t)&&(this.getTweetActions(t).removeClass(this.attr.animationStateClass),this.trigger("uiAnimationEnd"))},this.completeAnimation=function(t){t.originalEvent&&t.originalEvent.animationName===this.attr.animationName&&this.cleanupAnimation(e(t.target).closest(this.attr.animationTweetSelector))},this.unfavoriteHandler=function(t){this.cleanupAnimation(e(t.target))},this.animateAction=function(t,i){this.getTweetActions(e(t.target)).addClass(this.attr.animationStateClass)},this.after("initialize",function(){this.on(document,"uiDidFavoriteTweet",this.animateAction),this.on(document,"uiDidUnfavoriteTweet",this.unfavoriteHandler),this.on("webkitAnimationEnd oanimationend oAnimationEnd msAnimationEnd animationend",{animationTweetSelector:this.completeAnimation})})}t.exports=i}).call(e,i(1))},function(t,e,i){(function(e){function i(){this.addCancelHoverStyleClass=function(t,i,s){var n=e(t.target).closest(this.attr.tweetItemSelector),o=e(t.target).closest(this.attr.toggleContainerSelector);return"click"!==t.type||n.hasClass(this.attr.favoritedTweetClass)||n.hasClass(this.attr.retweetedTweetClass)?void o.removeClass("is-hoverStateCancelled"):(o.addClass("is-hoverStateCancelled"),void o.one("mouseleave",function(){o.removeClass("is-hoverStateCancelled")}))},this.after("toggleFavorite",this.addCancelHoverStyleClass),this.after("toggleRetweet",this.addCancelHoverStyleClass)}t.exports=i}).call(e,i(1))},function(t,e,i){function s(){this.updateRetweetState=function(t,e){var i=this.$node.find('[data-tweet-id="'+e.tweet_id+'"]');i.attr("data-my-retweet-id",e.retweet_id)},this.updateUnRetweetState=function(t,e){var i=this.$node.find('[data-tweet-id="'+e.tweet_id+'"]');i.removeAttr("data-my-retweet-id data-retweet-id data-retweeter")},this.after("initialize",function(){this.attr.loggedIn&&(this.on(document,"dataDidRetweet",this.updateRetweetState),this.on(document,"dataDidUnretweet",this.updateUnRetweetState))})}var n=i(10),o=n(s);t.exports=o},function(t,e,i){(function(e){function s(){this.defaultAttrs({limit:10,remoteDebounceInterval:300,remoteThrottleInterval:300,outstandingRemoteRequestCount:0,queuedRequestData:!1,outstandingRemoteRequestMax:6,useThrottle:!1,tweetContextEnabled:!1,topicsWithFiltersEnabled:!1}),this.triggerSuggestionsEvent=function(t,e,i){this.trigger("dataTypeaheadSuggestionsResults",{suggestions:i,queryData:e,id:t})},this.hasAnySuggestions=function(t,e){return e.some(function(e){return t[e]&&t[e].length})},this.needsRemoteRequest=function(t,e){return e.some(function(e){return this.datasources[e]&&this.datasources[e].requiresRemoteSuggestions&&this.datasources[e].requiresRemoteSuggestions(t)},this)},this.getLocalSuggestions=function(t,e,i){function s(){o++,o===e.length&&i(n)}var n={},o=0;e.forEach(function(e){this.datasources[e]?this.datasources[e].getLocalSuggestions(t,function(t){t.length&&(t.forEach(function(t){t.origin="prefetched"}),n[e]=t),s()}):s()},this)},this.processRemoteSuggestions=function(t){this.adjustRequestCount(-1);var e=t.sourceEventData,i=e.suggestions||{};e.datasources.forEach(function(s){var n=s.processRemoteSuggestions(e,t,i);if(n[s.attr.id]&&n[s.attr.id].length){for(var o in n)n[o].forEach(function(t){t.origin=t.origin||"remote"});e.suggestions[s.attr.id]=n[s.attr.id]}},this),this.processSuggestionsByDataset(i),this.triggerSuggestionsEvent(e.id,e.queryData,i),this.makeQueuedRemoteRequestIfPossible()},this.getRemoteSuggestions=function(t,e,i,s){e&&this.needsRemoteRequest(e,s)&&(this.request[t]||(this.attr.useThrottle?this.request[t]=o.throttle(this.splitRemoteRequests.bind(this),this.attr.remoteThrottleInterval):this.request[t]=o.debounce(this.splitRemoteRequests.bind(this),this.attr.remoteDebounceInterval)),0===e.query.indexOf("@")&&"COMPOSE"===e.typeaheadSrc&&(e.query=e.query.substring(1),e.atSignRemoved=!0),this.request[t](t,e,i,s))},this.makeQueuedRemoteRequestIfPossible=function(){if(this.attr.outstandingRemoteRequestCount===this.attr.outstandingRemoteRequestMax-1&&this.attr.queuedRequestData){var t=this.attr.queuedRequestData;this.getRemoteSuggestions(t.id,t.queryData,t.suggestions,t.datasources),this.attr.queuedRequestData=!1}},this.adjustRequestCount=function(t){this.attr.outstandingRemoteRequestCount+=t},this.canMakeRemoteRequest=function(t){return this.attr.outstandingRemoteRequestCount<this.attr.outstandingRemoteRequestMax||(this.attr.queuedRequestData=t,!1)},this.processRemoteRequestError=function(){this.adjustRequestCount(-1),this.makeQueuedRemoteRequestIfPossible()},this.splitRemoteRequests=function(t,e,i,s){var n={};s.forEach(function(t){if(this[t]&&this[t].requiresRemoteSuggestions&&this[t].requiresRemoteSuggestions(e)){var i=this[t];n[i.attr.remotePath]?n[i.attr.remotePath].push(i):n[i.attr.remotePath]=[i]}},this.datasources);for(var o in n){this.executeRemoteRequest(t,e,i,n[o]);break}},this.executeRemoteRequest=function(t,e,i,s){var n={id:t,queryData:e,suggestions:i,datasources:s};this.canMakeRemoteRequest(n)&&((!this.attr.tweetContextEnabled||e.tweetContext&&e.tweetContext.length>1e3)&&(e.tweetContext=void 0),this.adjustRequestCount(1),this.get({url:s[0].attr.remotePath,data:{q:e.query,tweet_context:e.tweetContext,count:this.attr.limit,result_type:s.map(function(t){return t.attr.remoteType}).join(","),filters:this.attr.topicsWithFiltersEnabled,src:e.typeaheadSrc},eventData:n,success:this.processRemoteSuggestions.bind(this),error:this.processRemoteRequestError.bind(this)}))},this.truncateTopicsWithRecentSearches=function(t){if(t.topics&&t.recentSearches){var e=t.recentSearches.length,i=4-e;t.topics=t.topics.slice(0,i)}},this.dedupSuggestions=function(t,e,i){function s(){return e.some(function(t){return t in i})}function n(t){var e=t.topic||t.name;return!o[e.toLowerCase()]}if(i[t]&&s()){var o={};i[t].forEach(function(t){var e=t.name||t.topic;o[e.toLowerCase()]=!0}),e.forEach(function(t){t in i&&(i[t]=i[t].filter(n))})}},this.processSuggestionsByDataset=function(t){this.dedupSuggestions("recentSearches",["topics"],t),this.truncateTopicsWithRecentSearches(t)},this.getSuggestions=function(t,e){if("undefined"==typeof e)throw"No parameters specified";if(!e.datasources)throw"No datasources specified";if("undefined"==typeof e.queryData)throw"No query data specified";if("undefined"==typeof e.queryData.query)throw"No query specified";if(!e.id)throw"No id specified";this.getLocalSuggestions(e.queryData,e.datasources,function(t){this.processSuggestionsByDataset(t);var i="@"!==e.queryData.query&&this.needsRemoteRequest(e.queryData,e.datasources);!this.hasAnySuggestions(t,e.datasources)&&i||this.triggerSuggestionsEvent(e.id,e.queryData,t),i&&this.getRemoteSuggestions(e.id,e.queryData,t,e.datasources)}.bind(this))},this.getGlobalDatasources=function(){return T},this.setGlobalDatasources=function(t){T=t},this.addSynchronousDatasource=function(t,e,i){var s=i[e]||{};this.isDatasourceEnabled(e)&&(T.hasOwnProperty(e)?this.datasources[e]=T[e]:T[e]=this.datasources[e]=new t(o.merge(s,{id:e})),this.setupEventListeners(e))},this.addAsynchronousDatasource=function(t){var e=t.datasource;t=t||{};var i=t.dsName,s=this.componentOptions[i]||{},n=new e(o.merge(s,{id:i}),t);return n.initialize().then(function(t){return T[i]=this.datasources[i]=n,t}.bind(this))},this.initializeLocalData=function(t){this.addDatasourcesNotUsingIndexedDB();var i=this.shouldUseIndexedDB()?this.addAsynchronousDatasources():this.addSynchronousDatasources(),s=this.addDMTypeaheadDatasources();e.when(i,s).always(t)},this.isDatasourceEnabled=function(t){var e=this.componentOptions[t]||{};return!!e.enabled},this.isBrowserSafari=function(){return e.browser.safari},this.shouldUseIndexedDB=function(){return b.isSupported()&&this.attr.useIndexedDB&&!this.isBrowserSafari()},this.addAsync=function(t){var i=t.dsName,s=t.dbName,n=t.datasource,o=y.log(e.Deferred(),{title:"Typeahead ("+i+")",enabled:window.DEBUG&&window.DEBUG.enabled});return this.isDatasourceEnabled(i)?this.addAsynchronousDatasource({dbName:s,dsName:i,datasource:n,indexedDBWrapper:C}).then(function(t){this.setupEventListeners(i),this.addDBHandleToGlobals(s,t),o.resolve(i,s,t)}.bind(this)).fail(function(){this.indexedDBInitializationFailed=!0,o.reject.apply(null,arguments)}.bind(this)):o.resolve(),o.promise()},this.addDBHandleToGlobals=function(t,e){e&&(window.globalIndexedDBs[t]=e)},this.addDMTypeaheadDatasources=function(){return this.addAsync({dsName:"dmConversations",dbName:"dm_typeahead",datasource:d})},this.addAsynchronousDatasources=function(){return y.chain([this.addAsync.bind(this,{dsName:"accounts",dbName:"accounts",datasource:l}),this.addAsync.bind(this,{dsName:"dmAccounts",dbName:"accounts",datasource:l}),this.addAsync.bind(this,{dsName:"mediaTagAccounts",dbName:"accounts",datasource:l})])},this.addDatasourcesNotUsingIndexedDB=function(){this.addSynchronousDatasource(u,"savedSearches",this.componentOptions),this.addSynchronousDatasource(g,"topics",this.componentOptions),this.addSynchronousDatasource(g,"hashtags",o.merge(this.componentOptions,{hashtags:{remoteType:"hashtags"}},!0)),this.addSynchronousDatasource(f,"trendLocations",this.componentOptions),this.addSynchronousDatasource(S,"selectedUsers",this.componentOptions),this.addSynchronousDatasource(w,"prefillUsers",this.componentOptions),this.addSynchronousDatasource(m,"recentSearches",this.componentOptions),this.addSynchronousDatasource(v,"concierge",this.componentOptions)},this.addSynchronousDatasources=function(){return this.addSynchronousDatasource(h,"accounts",this.componentOptions),this.addSynchronousDatasource(h,"dmAccounts",this.componentOptions),this.addSynchronousDatasource(h,"mediaTagAccounts",this.componentOptions),e.Deferred().resolve()},this.possiblyScribeIndexedDB=function(){if(this.shouldUseIndexedDB()){var t=this.indexedDBInitializationFailed?"failure":"success";this.scribe({component:"indexeddb",action:t})}},this.after("initialize",function(t,e){this.datasources={},this.request={},this.componentOptions=e,this.initializeLocalData(function(){this.on("uiNeedsTypeaheadSuggestions",this.getSuggestions),this.possiblyScribeIndexedDB()}.bind(this))})}var n=i(10),o=i(25),a=i(225),r=i(538),c=i(40),h=i(539),l=i(541),d=i(543),u=i(544),m=i(545),p=i(546),g=i(547),f=i(548),v=i(549),S=i(550),w=i(551),b=i(542),C=i(552),y=i(265);t.exports=n(s,a,r,p,c),window.globalIndexedDBs={};var T={}}).call(e,i(1))},function(t,e){function i(){this.defaultAttrs({cache_limit:10}),this.getCachedSuggestions=function(t){return this.cache[t]?this.cache[t].value:null},this.clearCache=function(){this.cache={NEWEST:null,OLDEST:null,COUNT:0,LIMIT:this.attr.cache_limit}},this.deleteCachedSuggestions=function(t){return!!this.cache[t]&&(this.cache.COUNT>1&&(t===this.cache.NEWEST.query?(this.cache.NEWEST=this.cache.NEWEST.before,this.cache.NEWEST.after=null):t===this.cache.OLDEST.query?(this.cache.OLDEST=this.cache.OLDEST.after,this.cache.OLDEST.before=null):(this.cache[t].after.before=this.cache[t].before,this.cache[t].before.after=this.cache[t].after)),delete this.cache[t],this.cache.COUNT-=1,!0)},this.setCachedSuggestions=function(t,e){0!==this.cache.LIMIT&&(this.deleteCachedSuggestions(t),this.cache.COUNT>=this.cache.LIMIT&&this.deleteCachedSuggestions(this.cache.OLDEST.query),0===this.cache.COUNT?(this.cache[t]={query:t,value:e,before:null,after:null},this.cache.NEWEST=this.cache[t],this.cache.OLDEST=this.cache[t]):(this.cache[t]={query:t,value:e,before:this.cache.NEWEST,after:null},this.cache.NEWEST.after=this.cache[t],this.cache.NEWEST=this.cache[t]),this.cache.COUNT+=1)},this.aroundGetSuggestions=function(t,e,i){var s=i.id+":"+i.query,n=this.getCachedSuggestions(s);return n?void this.triggerSuggestionsEvent(i.id,i.query,n):void t(e,i)},this.afterTriggerSuggestionsEvent=function(t,e,i,s){if(!s){var n=t+":"+e;this.setCachedSuggestions(n,i);
}},this.after("triggerSuggestionsEvent",this.afterTriggerSuggestionsEvent),this.around("getSuggestions",this.aroundGetSuggestions),this.after("initialize",function(){this.clearCache(),this.on("uiTypeaheadDeleteRecentSearch",this.clearCache)})}t.exports=i},function(t,e,i){(function(e){function s(t){this.attr={id:null,ttl_ms:1728e5,localStorageCount:1200,ie8LocalStorageCount:1e3,limit:6,version:4,localQueriesEnabled:!1,remoteQueriesEnabled:!1,onlyDMable:!1,onlyShowUsersWithCanMediaTag:!1,currentUserId:null,storageAdjacencyList:"userAdjacencyList",storageHash:"userHash",storageProtocol:"protocol",storageVersion:"userVersion",remotePath:"/i/search/typeahead.json",remoteType:"users",prefetchPath:"/i/search/typeahead.json",prefetchType:"users",storageBlackList:"userBlackList",maxLengthBlacklist:100},this.attr=h.merge(this.attr,t),this.after=e.noop,this.defaultAttrs=e.noop,c.mixin(this,[a,l,r]),this.getPrefetchCount=function(){return this.attr.localStorageCount},this.isMetadataExpired=function(){var t=this.storage.getItem(this.attr.storageVersion),e=this.storage.getItem(this.attr.storageProtocol);return t!==this.attr.version||e!==this.getProtocol()},this.getStorageKeys=function(){return[this.attr.storageVersion,this.attr.storageHash,this.attr.storageAdjacencyList,this.attr.storageProtocol]},this.getDataFromLocalStorage=function(){this.userHash=this.storage.getItem(this.attr.storageHash)||this.userHash,this.adjacencyList=this.storage.getItem(this.attr.storageAdjacencyList)||this.adjacencyList},this.processResults=function(t){return t&&t[this.attr.prefetchType]?(t[this.attr.prefetchType].forEach(function(t){this.isAccountMalformedAndScribe(t,"typeahead_local")||(t.tokens=t.tokens.map(function(t){return"string"==typeof t?t:t.token}),t.prefetched=!0,this.userHash[t.id]=t,t.tokens.forEach(function(e){var i=n.getFirstChar(e);i.trim().length&&(void 0===this.adjacencyList[i]&&(this.adjacencyList[i]=[]),this.adjacencyList[i].indexOf(t.id)===-1&&this.adjacencyList[i].push(t.id))},this))},this),this.storage.setItem(this.attr.storageHash,this.userHash,this.attr.ttl_ms),this.storage.setItem(this.attr.storageAdjacencyList,this.adjacencyList,this.attr.ttl_ms),this.storage.setItem(this.attr.storageVersion,this.attr.version,this.attr.ttl_ms),void this.storage.setItem(this.attr.storageProtocol,this.getProtocol(),this.attr.ttl_ms)):void this.useStaleData()},this.getLocalSuggestions=function(t,e){if(!this.attr.localQueriesEnabled)return void e([]);var i=n.tokenizeText(t.query.replace("@","")),s=this.getPotentiallyMatchingIds(i),o=this.getAccountsFromIds(s),a=o.filter(this.matcher(i));a.sort(this.sorter),a=a.slice(0,this.attr.limit),e(a)},this.getPotentiallyMatchingIds=function(t){var e=[];return t.map(function(t){var i=this.adjacencyList[n.getFirstChar(t)];i&&(e=e.concat(i))},this),e=h.uniqueArray(e)},this.getAccountsFromIds=function(t){var e=[];return t.forEach(function(t){var i=this.userHash[t];i&&e.push(i)},this),e},this.matcher=function(t){return function(e){var i=e.tokens;if(this.attr.onlyDMable&&!e.is_dm_able)return!1;if(!this.isEligibleForMediaTagSuggestion(e))return!1;var s=t.every(function(t){var e=i.filter(function(e){return 0===e.indexOf(t)});return e.length});return s?e:void 0}.bind(this)},this.sorter=function(t,e){function i(t,e){var i=t.score_boost?t.score_boost:0,s=e.score_boost?e.score_boost:0,n=t.rounded_score?t.rounded_score:0,o=e.rounded_score?e.rounded_score:0;return o+s-(n+i)}var s=t.prefetched,n=e.prefetched;return s&&!n?-1:n&&!s?1:i(t,e)},this.processRemoteSuggestions=function(t,e,i){var s=i[this.attr.id]||[],n={};return s.forEach(function(t){n[t.id_str]=!0},this),this.requiresRemoteSuggestions(t.queryData)&&e[this.attr.remoteType]&&e[this.attr.remoteType].forEach(function(t){var e=!n[t.id_str]&&(!this.attr.onlyDMable||t.is_dm_able)&&this.isEligibleForMediaTagSuggestion(t)&&!this.isAccountMalformedAndScribe(t,"typeahead_remote");e&&s.push(t)},this),i[this.attr.id]=s.slice(0,this.attr.limit),i[this.attr.id].forEach(function(t){this.removeBlacklistSocialContext(t)},this),i},this.removeBlacklistSocialContext=function(t){t.first_connecting_user_id in this.socialContextBlackList&&(t.first_connecting_user_name=void 0,t.first_connecting_user_id=void 0)},this.requiresRemoteSuggestions=function(t){return!(!t||!t.query)&&(t.accountsWithoutAtSignLocalOnly?this.attr.remoteQueriesEnabled&&("@"===n.getFirstChar(t.query)||t.atSignRemoved):this.attr.remoteQueriesEnabled)},this.isEligibleForMediaTagSuggestion=function(t){return!this.attr.onlyShowUsersWithCanMediaTag||t.can_media_tag||t.id===this.attr.currentUserId},this.isAccountMalformedAndScribe=function(t,e){var i=n.isAccountMalformed(t);return i&&this.scribe({component:"local_storage",element:e,action:"empty"}),i},this.initialize=function(){var t=o({withExpiry:!0});this.storage=new t("typeahead"),this.adjacencyList={},this.userHash={},this.attr.localQueriesEnabled&&this.loadData(this.attr.prefetchPath,this.attr.prefetchType),this.socialContextBlackList=this.storage.getItem(this.attr.storageBlackList)||{}},this.initialize()}var n=i(281),o=i(226),a=i(225),r=i(40),c=i(20),h=i(25),l=i(540);t.exports=s}).call(e,i(1))},function(t,e,i){"use strict";function s(){this.prefetch=function(t,e,i,s){var n={prefetch:!0,result_type:e,count:this.getPrefetchCount(),media_tagging_in_prefetch:this.shouldIncludeCanMediaTag()};this.storage&&(n[e+"_cache_age"]=this.storage.getCacheAge(this.attr.storageHash,this.attr.ttl_ms));var o=this.get({url:t,data:n,eventData:{},success:i,error:s});return o},this.useStaleData=function(){this.storage&&(this.extendTTL(),this.getDataFromLocalStorage())},this.extendTTL=function(){for(var t=this.getStorageKeys(),e=0;e<t.length;e++)this.storage.updateTTL(t[e],this.attr.ttl_ms)},this.loadData=function(t,e){var i=this.getStorageKeys().some(function(t){return this.storage.isExpired(t)},this);i||this.isMetadataExpired()?this.prefetch(t,e,this.processResults.bind(this),this.useStaleData.bind(this)):this.getDataFromLocalStorage()},this.getProtocol=function(){return window.location.protocol},this.shouldIncludeCanMediaTag=function(){return n.getDecider("enable_media_tag_prefetch")}}var n=i(34);t.exports=s},function(t,e,i){(function(e){function s(t,i){this.attr={id:null,ttlMilliseconds:1728e5,itemCount:1e3,limit:6,version:1,localQueriesEnabled:!1,remoteQueriesEnabled:!1,onlyDMable:!1,onlyShowUsersWithCanMediaTag:!1,currentUserId:null,remotePath:"/i/search/typeahead.json",remoteType:"users",prefetchPath:"/i/search/typeahead.json",prefetchType:"users",storageBlackList:"userBlackList",maxLengthBlacklist:100,dbName:i.dbName||"accounts_typeahead",dbVersion:20150128,datastores:{MetadataStore:{name:"MetadataStore",keyPath:"key"},AccountTokensToIds:{name:"AccountTokensToIds",keyPath:"token"},IdsToAccounts:{name:"IdsToAccounts",keyPath:"id"}}},this.attr=d.merge(this.attr,t),this.after=e.noop,this.defaultAttrs=e.noop,l.mixin(this,[c,u,h]),this.initialize=function(t){var e=t||this.openIndexedDB.bind(this);this.isUsingIndexedDB=!0,this.initializeSocialContextBlacklist();var i=[this.attr.datastores.MetadataStore,this.attr.datastores.AccountTokensToIds,this.attr.datastores.IdsToAccounts];return e(this.attr.dbName,this.attr.dbVersion,i).then(this.checkIfLocalDataHasExpired.bind(this)).then(this.fetchDataIfExpired.bind(this)).then(this.repopulateDataStore.bind(this)).then(function(){return this}).fail(this.onInitializationError.bind(this))},this.openIndexedDB=function(t,e,i){return o.open(t,e,i).then(function(t){this.database=t}.bind(this))},this.close=function(){this.database&&this.database.close()},this.checkIfLocalDataHasExpired=function(){return this.getData(this.attr.datastores.MetadataStore.name,this.attr.datastores.MetadataStore.keyPath).then(function(t){return this.isMetadataExpired(t)}.bind(this))},this.fetchDataIfExpired=function(t){return t&&this.attr.localQueriesEnabled&&this.prefetch(this.attr.prefetchPath,this.attr.prefetchType)},this.getData=function(t,e){return this.database.get(t,e)},this.repopulateDataStore=function(t){return t&&this.database.clear().then(this.populateDataStore.bind(this,t))},this.populateDataStore=function(t){return t&&this.database.put(this.processData(t))},this.onInitializationError=function(t){!this.isHttpError(t)&&this.close()},this.getPrefetchCount=function(){return this.attr.itemCount},this.initializeSocialContextBlacklist=function(){var t=m({withExpiry:!0});this.storage=new t("typeahead"),this.socialContextBlackList=this.storage.getItem(this.attr.storageBlackList)||{}},this.isMetadataExpired=function(t){if(!t)return!0;var e=t.version!==this.attr.version,i=this.hasTTLExpired(t.expirationTime),s=t.protocol!==this.getProtocol();return e||i||s},this.processData=function(t){var e=t[this.attr.prefetchType].filter(function(t){return!this.isAccountMalformedAndScribe(t,"typeahead_local")},this);t[this.attr.prefetchType]=e;var i={};return i[this.attr.datastores.AccountTokensToIds.name]=this.createItemsForAccountTokensToIdsObjectstore(t),i[this.attr.datastores.IdsToAccounts.name]=this.createItemsForIdsToAccountsObjectstore(t),i[this.attr.datastores.MetadataStore.name]=this.createItemsForMetadataObjectstore(t),i},this.createItemsForIdsToAccountsObjectstore=function(t){var e=t[this.attr.prefetchType].map(function(t){t.prefetched=!0;var e={};return e[this.attr.datastores.IdsToAccounts.keyPath]=t.id,e.account=t,e},this);return e},this.createItemsForAccountTokensToIdsObjectstore=function(t){var e=this.attr.datastores.AccountTokensToIds.keyPath,i={},s=[];t[this.attr.prefetchType].forEach(function(t){t.tokens.forEach(function(e){var s=e.token;""!==s&&(Array.isArray(i[s])?i[s].push(t.id):i[s]=[t.id])},this)},this);for(var n in i)if(i.hasOwnProperty(n)){var o={};o.ids=i[n],o[e]=n,s.push(o)}return s},this.createItemsForMetadataObjectstore=function(t){var e={};return e[this.attr.datastores.MetadataStore.keyPath]=this.attr.datastores.MetadataStore.keyPath,e.expirationTime=this.attr.ttlMilliseconds+(new Date).getTime(),e.version=this.attr.version,e.protocol=this.getProtocol(),[e]},this.addAccount=function(t){return this.getTokenIdsForAccount(t).then(this.addTokenIdsForAccount.bind(this,t)).then(this.addToIdsToAccounts.bind(this,t))},this.getTokenIdsForAccount=function(t){t=t.account||t;var e=t.tokens.map(function(t){var e=this.standardizeToken(t);return this.database.get(this.attr.datastores.AccountTokensToIds.name,e)},this);return a.collect(e)},this.addTokenIdsForAccount=function(t,e){var i=n.compact(e);i=this.addNewTokenIds(t,i),i=this.addIdToTokenIds(t,i);var s={};return s[this.attr.datastores.AccountTokensToIds.name]=i,this.database.put(s)},this.standardizeToken=function(t){return"string"==typeof t?t:t.token},this.addNewTokenIds=function(t,e){var i=[];return t.tokens.forEach(function(t){var s=e.some(function(e){return e.token===t});s||i.push(this.createTokenId(t))},this),e.concat(i)},this.addIdToTokenIds=function(t,e){return e.forEach(function(e){e.ids.push(t.id)}),e},this.createTokenId=function(t){var e={};return e[this.attr.datastores.AccountTokensToIds.keyPath]=t,e.ids=[],e},this.removeAccount=function(t){return this.database.destroy(this.attr.datastores.IdsToAccounts.name,t)},this.createAddAccountOptions=function(t){var e={},i={};return e[this.attr.datastores.IdsToAccounts.keyPath]=t.id,e.account=t,i[this.attr.datastores.IdsToAccounts.name]=[e],i},this.addToIdsToAccounts=function(t){var e=this.createAddAccountOptions(t);return this.database.put(e)},this.getLocalSuggestions=function(t,e){var i=r.tokenizeText(t.query.replace("@",""));return this.attr.localQueriesEnabled&&""!==t.query?void this.search(i).always(function(t){e(t)}):void e([])},this.search=function(t){return this.getIds(t).then(this.filterForRelevantIds.bind(this)).then(this.getAccounts.bind(this)).then(this.filterAndSortAccounts.bind(this))},this.filterForRelevantIds=function(t){if(0===t.length)return[];var e=this.createIdGroups(t),i=d.uniqueArray(e.candidateIds);return this.getCandidateIdsFoundInAllTermGroups(i,e.allIdGroupsByTerm)},this.getAccounts=function(t){var e=t.map(function(t){return this.database.get(this.attr.datastores.IdsToAccounts.name,t)},this);return a.collect(e)},this.filterAndSortAccounts=function(t){var e=n.compact(t),i=e.map(function(t){return t.account});return t=i.filter(function(t){return!(this.attr.onlyDMable&&!t.is_dm_able)&&!!this.isEligibleForMediaTagSuggestion(t)},this),t.sort(this.sorter),t.slice(0,this.attr.limit)},this.sorter=function(t,e){function i(t,e){var i=t.score_boost?t.score_boost:0,s=e.score_boost?e.score_boost:0,n=t.rounded_score?t.rounded_score:0,o=e.rounded_score?e.rounded_score:0;return o+s-(n+i)}var s=t.prefetched,n=e.prefetched;return s&&!n?-1:n&&!s?1:i(t,e)},this.getIds=function(t){var e=t.map(function(t){return this.database.getByPrefix(this.attr.datastores.AccountTokensToIds.name,t)},this);return a.collect(e)},this.getCandidateIdsFoundInAllTermGroups=function(t,e){return t.filter(function(t){return e.every(function(e){return e.indexOf(t)!==-1})})},this.createIdGroups=function(t){var e=[],i=[];return t.forEach(function(t){var s=[];t.forEach(function(t){e=e.concat(t.ids),s=s.concat(t.ids)}),i.push(s)}),{candidateIds:e,allIdGroupsByTerm:i}},this.processRemoteSuggestions=function(t,e,i){var s=i[this.attr.id]||[],n={};return s.forEach(function(t){n[t.id_str]=!0},this),this.requiresRemoteSuggestions(t.queryData)&&e[this.attr.remoteType]&&e[this.attr.remoteType].forEach(function(t){var e=!n[t.id_str]&&(!this.attr.onlyDMable||t.is_dm_able)&&this.isEligibleForMediaTagSuggestion(t)&&!this.isAccountMalformedAndScribe(t,"typeahead_remote");e&&s.push(t)},this),i[this.attr.id]=s.slice(0,this.attr.limit),i[this.attr.id].forEach(function(t){this.removeBlacklistSocialContext(t)},this),i},this.requiresRemoteSuggestions=function(t){return!(!t||!t.query)&&(t.accountsWithoutAtSignLocalOnly?this.attr.remoteQueriesEnabled&&("@"===r.getFirstChar(t.query)||t.atSignRemoved):this.attr.remoteQueriesEnabled)},this.isHttpError=function(t){return t&&t.status&&t.status>=400&&t.status<600},this.hasTTLExpired=function(t){return t-this.now()<=0},this.now=function(){return(new Date).getTime()},this.removeBlacklistSocialContext=function(t){t.first_connecting_user_id in this.socialContextBlackList&&(t.first_connecting_user_name=void 0,t.first_connecting_user_id=void 0)},this.isEligibleForMediaTagSuggestion=function(t){return!this.attr.onlyShowUsersWithCanMediaTag||t.can_media_tag||t.id===this.attr.currentUserId},this.isAccountMalformedAndScribe=function(t,e){var i=r.isAccountMalformed(t);return i&&this.scribe({component:"indexeddb",element:e,action:"empty"}),i}}var n=i(261),o=i(542),a=i(265),r=i(281),c=i(225),h=i(40),l=i(20),d=i(25),u=i(540),m=i(226);t.exports=s}).call(e,i(1))},function(t,e,i){(function(e){function s(){var t=Array.prototype.slice.call(arguments);if(!(this instanceof s))return s.open.apply(null,t);var e=t[0];this.database=e,this.name=e.name,this.version=e.version,this.stores=n(e),e.onversionchange=function(){e.close(),window.location.reload(!0)}}function n(t){for(var e=[],i=t.objectStoreNames,s=0;s<i.length;s++)e.push(i[s]);return e}var o=i(265),a=e.Deferred,r=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,c=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange,h={readwrite:(window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction||{}).READ_WRITE||"readwrite",readonly:(window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction||{}).READ_ONLY||"readonly"};t.exports=s,s.KeyRange=c,s.deleteDatabase=function(t){return o.rescue(function(){var e=a(),i=r.deleteDatabase(t);return i.onsuccess=i.onerror=e.resolve,e.promise()})},s.isSupported=function(){return!!r},s.open=function(t,e,i,c){var h=o.log(a(),{title:'IndexedDB "'+t+'" version '+e,enabled:window.DEBUG&&window.DEBUG.enabled});if(!s.isSupported())return h.reject("not supported");try{var l,d=e?r.open(t,e):r.open(t);d.onupgradeneeded=function(e){var s=e.target.result,r=o.log(a(),{title:'IndexedDB "'+t+'" migration from version '+e.oldVersion+" to "+e.newVersion,enabled:window.DEBUG&&window.DEBUG.enabled});c||n(s).forEach(function(t){s.deleteObjectStore(t)});var h=n(s),l=(i||[]).map(function(t){return o.rescue(function(){var e=t.name,i=t.keyPath,n=t.indexes||[];if(h.indexOf(e)<0){var o=s.createObjectStore(e,{keyPath:i});return n.forEach(function(t){o.createIndex(t.name,t.keyPath,t)}),o}})});o.collect(l).then(r.resolve,r.reject).promise()},d.onsuccess=function(t){(l||a().resolve()).then(function(){var e=new s(t.target.result);return h.resolveWith(e,[e])}).fail(h.reject)},d.onblocked=function(t){h.reject("open blocked",t.target.error)},d.onerror=function(t){h.reject("open error",t.target.error)}}catch(u){h.reject("open exception",u)}return h.promise()},s.prototype.add=function(t){return this.insert("add",t)},s.prototype.clear=function(){var t=arguments.length?Array.prototype.slice.call(arguments):this.stores,e=t.map(function(t){return this.transaction(t,h.readwrite,function(e){e.objectStore(t).clear()})},this);return o.collect(e,this).promise()},s.prototype.close=function(){return o.rescue(function(){this.database.close()},this)},s.prototype.destroy=function(t,e){return this.transaction(t,h.readwrite,function(i){i.objectStore(t).delete(e)})},s.prototype.get=function(t,e){return this.transaction(t,h.readonly,function(i){return i.objectStore(t).get(e)}).then(function(t){return t.target.result})},s.prototype.getAll=function(){var t=Array.prototype.slice.call(arguments).filter(function(t){return null!=t}),e=t.length,i=t[0],s="string"==typeof t[1]?t[1]:null,n="string"!=typeof t[e-1]?t[e-1]:null;return o.rescue(function(){var t=a(),e=this.database.transaction(i,h.readonly),o=s?e.objectStore(i).index(s):e.objectStore(i),r=[],c=o.openCursor(n);return c.onerror=function(){t.rejectWith(this,arguments)}.bind(this),c.onsuccess=function(e){var i=e.target.result;i?(r.push(i.value),i.continue()):t.resolveWith(this,[r])}.bind(this),t.promise()},this)},s.prototype.getByPrefix=function(){var t=Array.prototype.slice.call(arguments).filter(function(t){return null!=t}),e=t[0],i=3===t.length?t[1]:null,s=t[t.length-1];return this.getAll(e,i,c.bound(s,s+"￿",!1,!1))},s.prototype.put=function(t){return this.insert("put",t)},s.prototype.insert=function(t,e){var i=Object.keys(e),s=i.map(function(i){return this.transaction(i,h.readwrite,function(s){var n=s.objectStore(i);e[i].forEach(function(e){n[t](e)})})},this);return o.collect(s,this).promise()},s.prototype.transaction=function(t,e,i){return o.rescue(function(){var s=a(),n=this.database.transaction(t,e),o=i(n);return o?(o.onsuccess=function(){s.resolveWith(this,arguments)}.bind(this),o.onerror=function(){s.rejectWith(this,arguments)}.bind(this)):(n.oncomplete=function(){s.resolveWith(this,arguments)}.bind(this),n.onerror=function(){s.rejectWith(this,arguments)}.bind(this)),s.promise()},this)}}).call(e,i(1))},function(t,e,i){(function(e){function s(t,i){i=i||{},this.attr={url:"/i/direct_messages/typeahead",dbName:i.dbName||"dm_typeahead",dbVersion:i.dbVersion||20160920,metadata:{name:"metadata",keyPath:"key"},conversations:{name:"conversations",keyPath:"id",indexes:[{name:"title",keyPath:"title",unique:!1}]},users:{name:"users",keyPath:"id",indexes:[{name:"name_lowercase",keyPath:"name_lowercase",unique:!1},{name:"screen_name",keyPath:"screen_name",unique:!0}]}},this.attr=h.merge(this.attr,t),this.after=e.noop,this.defaultAttrs=e.noop,r.mixin(this,[l]),this.initialize=function(){return this.isUsingIndexedDB=!0,this.openIndexedDB(this.attr.dbName,this.attr.dbVersion,[this.attr.metadata,this.attr.users,this.attr.conversations]).then(this.ensureLocalDataBelongsToCurrentUser.bind(this,d.user.id)).then(this.checkIfLocalDataHasExpired.bind(this)).then(this.fetchDataIfExpired.bind(this)).then(this.ensureDataAndSchemaVersionMatch.bind(this)).then(this.repopulateDataStore.bind(this)).then(function(){return this}).fail(this.onInitializationError.bind(this))},this.getLocalSuggestions=function(t,i){var s=e.Deferred(),n=i||s.resolve,o=c.tokenizeText(t.query),r=a.pluralize(this.search,this),h=t.dmConversationsOptions||{};return r(o).then(function(t){return h.excludeGroups?this.removeGroups(t):t}.bind(this)).then(function(t){return h.excludeOneToOnes?this.removeOneToOnes(t):t}.bind(this)).then(function(t){return h.sortBySortId?this.sortBySortId(t):t}.bind(this)).always(function(t){n(t||[])}),s.promise()},this.repopulateIfStale=function(t){if(t=t||[],t.length){var i=o.KeyRange.bound(t[0],t[t.length-1],!1,!1);return this.database.getAll(this.attr.conversations.name,i).then(function(e){return e.length<t.length}).then(function(t){return t&&this.database.clear(this.attr.metadata.name)}.bind(this)).then(function(){return this.initialize()}.bind(this))}return e.Deferred().reject()},this.removeGroups=function(t){return(t||[]).filter(function(t){return t&&!t.is_group})},this.removeOneToOnes=function(t){return(t||[]).filter(function(t){return t&&t.is_group})},this.sortBySortId=function(t){return(t||[]).sort(function(t,e){return u.compare(e.sort_id,t.sort_id)})},this.openIndexedDB=function(t,e,i){return o.open(t,e,i).then(function(t){this.database=t}.bind(this))},this.ensureLocalDataBelongsToCurrentUser=function(t){return this.database.get(this.attr.metadata.name,"user").then(function(e){return e&&e.id===t}).then(function(t){return t||this.database.clear()}.bind(this))},this.checkIfLocalDataHasExpired=function(){var t=this.now();return this.database.get(this.attr.metadata.name,"ttl").then(function(e){return!e||!e.expires||e.expires<t})},this.fetchDataIfExpired=function(t){return t&&this.get({url:this.attr.url})},this.ensureDataAndSchemaVersionMatch=function(t){if(t){var e=(t.metadata||[]).reduce(function(t,e){return e.version||t},0);if(this.database.version===e)return t}},this.repopulateDataStore=function(t){return t&&this.database.clear().then(this.populateDataStore.bind(this,t))},this.populateDataStore=function(t){return t&&this.database.add(t)},this.onInitializationError=function(t){this.database&&this.database.close()},this.hydrateParticipantsForOneToOnes=function(t){var e=t.map(function(t){return t.is_group?t:this.hydrateParticipants(t)}.bind(this));return a.collect(e)},this.hydrateParticipants=function(t){var e=a.pluralize(this.getUserById,this);return e(t.participants).then(function(e){return t.participants=e,t})},this.getUserById=function(t){return this.database.get(this.attr.users.name,t)},this.search=function(t){var e=this.searchUsers(t),i=this.searchConversations(t),s=a.pluralize(this.getConversation,this);return a.collect([e,i]).then(m).then(p).then(s).then(this.hydrateParticipantsForOneToOnes.bind(this))},this.searchUsers=function(t){var e=this.database.getByPrefix(this.attr.users.name,"name_lowercase",t),i=this.database.getByPrefix(this.attr.users.name,"screen_name",t),s=a.collect([e,i]).then(m);return s.then(function(t){return t.map(function(t){return t.conversations})}).then(m)},this.searchConversations=function(t){var e=this.database.getByPrefix(this.attr.conversations.name,"title",t);return e.then(function(t){return t.map(function(t){return t.id})})},this.getConversation=function(t){return this.database.get(this.attr.conversations.name,t)},this.now=function(){return(new Date).getTime()}}var n=i(261),o=i(542),a=i(265),r=i(20),c=i(281),h=i(25),l=i(225),d=i(34),u=i(242),m=n.flatten,p=n.unique;t.exports=s}).call(e,i(1))},function(t,e,i){function s(t){this.attr={id:null,items:[],limit:0,searchPathWithQuery:"/search?src=savs&q=",querySource:"saved_search_click"},this.attr=n.merge(this.attr,t),this.getRemoteSuggestions=function(t,e,i){return i},this.requiresRemoteSuggestions=function(t){return!1},this.getLocalSuggestions=function(t,e){if(t&&t.query){var i=this.attr.items.filter(function(e){return 0===e.name.indexOf(t.query)}).slice(0,this.attr.limit);e(i)}else e(this.attr.items)},this.addSavedSearch=function(t){t&&t.query&&this.attr.items.push({id:t.id,id_str:t.id_str,name:t.name,query:t.query,saved_search_path:this.attr.searchPathWithQuery+encodeURIComponent(t.query),search_query_source:this.attr.querySource})},this.removeSavedSearch=function(t){if(t&&t.query)for(var e=this.attr.items,i=0;i<e.length;i++)if(e[i].query===t.query||e[i].name===t.query)return void e.splice(i,1)}}var n=i(25);t.exports=s},function(t,e,i){function s(t){this.attr={id:null,limit:4,storageList:"recentSearchesList",maxLength:100,ttl_ms:12096e5,searchPathWithQuery:"/search?src=typd&q=",querySource:"typed_query"},this.attr=n.merge(this.attr,t),this.getRemoteSuggestions=function(t,e,i){return i},this.requiresRemoteSuggestions=function(){return!1},this.removeAllRecentSearches=function(){this.items=[],this.updateStorage()},this.getLocalSuggestions=function(t,e){if(t&&""!==t.query){var i=this.items.filter(function(e){return 0===e.name.indexOf(t.query)}).slice(0,this.attr.limit);e(i)}else e(this.items.slice(0,this.attr.limit))},this.updateStorage=function(){this.storage.setItem(this.attr.storageList,this.items,this.attr.ttl_ms)},this.removeOneRecentSearch=function(t){this.removeRecentSearchFromList(t.query),this.updateStorage()},this.addRecentSearch=function(t){t&&t.query&&(t.query=t.query.trim(),this.updateRecentSearchList(t),this.updateStorage())},this.updateRecentSearchList=function(t){var e=this.items,i={normalized_name:t.query.toLowerCase(),name:t.query,recent_search_path:this.attr.searchPathWithQuery+encodeURIComponent(t.query),search_query_source:this.attr.querySource};this.removeRecentSearchFromList(t.query),e.unshift(i),e.length>this.attr.maxLength&&e.pop()},this.removeRecentSearchFromList=function(t){for(var e=this.items,i=-1,s=t.toLowerCase(),n=0;n<e.length;n++)if(e[n].normalized_name===s){i=n;break}i!==-1&&e.splice(i,1)},this.initialize=function(){var t=o({withExpiry:!0});this.storage=new t("typeahead"),this.items=this.storage.getItem(this.attr.storageList)||[]},this.initialize()}var n=i(25),o=i(226);t.exports=s},function(t,e,i){(function(e){function s(){this.defaultAttrs({weights:{CACHED_PROFILE_VISIT:10,UNCACHED_PROFILE_VISIT:75,FOLLOW:100}}),this.cleanupUserData=function(t){this.shouldUseIndexedDB()?this.removeAccountAsync(parseInt(t,10)):this.removeAccount(t),this.addToUserBlacklist(t)},this.onFollowStateChange=function(t,e){if(e.userId){switch(e.newState){case"blocked":this.cleanupUserData(e.userId);break;case"not-following":this.cleanupUserData(e.userId);break;case"following":e.user&&(this.adjustScoreBoost(e.user,this.attr.weights.FOLLOW),this.shouldUseIndexedDB()?this.addAccountForFollowAsync(e.user):this.addAccount(e.user,"following"),this.removeUserFromBlacklist(e.userId))}this.shouldUseIndexedDB()||this.updateLocalStorage()}},this.onProfileVisit=function(t,e){this.shouldUseIndexedDB()?this.handleProfileVisitAsync(e):this.handleProfileVisitSync(e)},this.handleProfileVisitAsync=function(t){this.datasources.accounts.getAccounts([t.id]).then(this.processUserAsync.bind(this,t)).then(this.datasources.accounts.addAccount.bind(this.datasources.accounts))},this.processUserAsync=function(t,e){e=o.compact(e);var i=0!==e.length,s=i?this.attr.weights.CACHED_PROFILE_VISIT:this.attr.weights.UNCACHED_PROFILE_VISIT,a=i?e[0].account:t;return this.adjustScoreBoost(a,s),i||(a.tokens=["@"+a.screen_name,a.screen_name].concat(n.tokenizeText(a.name))),a},this.handleProfileVisitSync=function(t){var e=this.datasources.accounts.userHash[t.id];this.processUserSync(t,e)},this.processUserSync=function(t,e){e?this.adjustScoreBoost(e,this.attr.weights.CACHED_PROFILE_VISIT):(this.adjustScoreBoost(t,this.attr.weights.UNCACHED_PROFILE_VISIT),this.addAccount(t,"visit")),this.updateLocalStorage()},this.updateLocalStorage=function(){this.datasources.accounts.storage.setItem("userHash",this.datasources.accounts.userHash,this.datasources.accounts.attr.ttl),this.datasources.accounts.storage.setItem("adjacencyList",this.datasources.accounts.adjacencyList,this.datasources.accounts.attr.ttl),this.datasources.accounts.storage.setItem("version",this.datasources.accounts.attr.version,this.datasources.accounts.attr.ttl)},this.removeAccount=function(t){if(this.datasources.accounts.userHash[t]){var e=this.datasources.accounts.userHash[t].tokens;e.forEach(function(e){var i=this.datasources.accounts.adjacencyList[e.charAt(0)];if(i){var s=i.indexOf(t);s!==-1&&i.splice(s,1)}},this),delete this.datasources.accounts.userHash[t]}},this.removeAccountAsync=function(t){this.datasources.accounts.removeAccount(t)},this.adjustScoreBoost=function(t,e){t.score_boost?t.score_boost+=e:t.score_boost=e},this.addAccount=function(t,e){this.datasources.accounts.userHash[t.id]=t,t.tokens=["@"+t.screen_name,t.screen_name].concat(n.tokenizeText(t.name)),t.social_proof="following"===e?1:0,t.tokens.forEach(function(e){var i=e.charAt(0);if(e.trim().length)return this.datasources.accounts.adjacencyList[i]?void(this.datasources.accounts.adjacencyList[i].indexOf(t.id)===-1&&this.datasources.accounts.adjacencyList[i].push(t.id)):void(this.datasources.accounts.adjacencyList[i]=[t.id])},this)},this.addAccountForFollowAsync=function(t){t.tokens=["@"+t.screen_name,t.screen_name].concat(n.tokenizeText(t.name)),t.social_proof=1,this.datasources.accounts.addAccount(t)},this.removeOldAccountsInBlackList=function(){var t,e,i=0,s=this.datasources.accounts.attr.maxLengthBlacklist||100,n=this.datasources.accounts.socialContextBlackList,o=(new Date).getTime(),a=this.datasources.accounts.attr.ttl_ms;for(e in n){var r=n[e]+a;r<o?delete n[e]:(t=t||e,t=n[t]>n[e]?e:t,i+=1)}s<i&&delete n[t]},this.updateBlacklistLocalStorage=function(t){this.datasources.accounts.storage.setItem("userBlackList",t,this.attr.ttl)},this.addToUserBlacklist=function(t){var e=this.datasources.accounts.socialContextBlackList;e[t]=(new Date).getTime(),this.removeOldAccountsInBlackList(),this.updateBlacklistLocalStorage(e)},this.removeUserFromBlacklist=function(t){var e=this.datasources.accounts.socialContextBlackList;this.removeOldAccountsInBlackList(),e[t]&&(delete e[t],this.updateBlacklistLocalStorage(e))},this.checkItemTypeForRecentSearch=function(t){return"saved_search"===t||"topics"===t||"recent_search"===t},this.addSavedSearch=function(t,e){this.datasources.savedSearches.addSavedSearch(e)},this.removeSavedSearch=function(t,e){this.datasources.savedSearches.removeSavedSearch(e)},this.addRecentSearch=function(t,e){"search"===e.source?this.datasources.recentSearches.addRecentSearch({query:e.query}):this.checkItemTypeForRecentSearch(e.source)&&e.isSearchInput&&this.datasources.recentSearches.addRecentSearch({query:e.query})},this.removeRecentSearch=function(t,i){i.deleteAll?this.datasources.recentSearches.removeAllRecentSearches():this.datasources.recentSearches.removeOneRecentSearch(i),e(t.target).trigger("dataTypeaheadRecentSearchDeleted")},this.updateSelectedUsers=function(t,e){this.datasources.selectedUsers.updateSelectedUsers(e)},this.setTrendLocations=function(t,e){this.datasources.trendLocations.setTrendLocations(e)},this.updatePrefill=function(t,e){this.datasources.prefillUsers.updateRecentlySelectedUsers(e)},this.checkDMConversationFreshness=function(t,e){this.datasources.dmConversations.repopulateIfStale(e&&e.groups)},this.setupEventListeners=function(t){switch(t){case"accounts":this.on("dataFollowStateChange",this.onFollowStateChange),this.on("profileVisit",this.onProfileVisit);break;case"savedSearches":this.on(document,"dataAddedSavedSearch",this.addSavedSearch),this.on(document,"dataRemovedSavedSearch",this.removeSavedSearch);break;case"recentSearches":this.on("uiSearchQuery uiTypeaheadItemSelected",this.addRecentSearch),this.on("uiTypeaheadDeleteRecentSearch",this.removeRecentSearch);break;case"trendLocations":this.on(document,"dataLoadedTrendLocations",this.setTrendLocations);break;case"selectedUsers":this.on("uiUpdatedSelectedUsers",this.updateSelectedUsers);break;case"prefillUsers":this.on("uiUpdateRecentTags",this.updatePrefill);break;case"dmConversations":this.on("dataDMConversationListResult",this.checkDMConversationFreshness)}}}var n=i(281),o=i(261);t.exports=s}).call(e,i(1))},function(t,e,i){(function(e){function s(t){this.attr={
id:null,ttl_ms:216e5,limit:4,version:4,storageAdjacencyList:"topicsAdjacencyList",storageHash:"topicsHash",storageVersion:"topicsVersion",prefetchLimit:500,localQueriesEnabled:!1,remoteQueriesEnabled:!1,remotePath:"/i/search/typeahead.json",remoteType:"topics",prefetchPath:"/i/search/typeahead.json",prefetchType:"topics",basePath:"/search?",modePathMap:{images:"f=images",videos:"f=videos",news:"f=news"},querySourcePathTypeahead:"src=tyah"},this.attr=r.merge(this.attr,t),this.after=e.noop,this.defaultAttrs=e.noop,a.mixin(this,[o,c]),this.getLocalSuggestions=function(t,e){e([])},this.getTopicObjectsFromStrings=function(t){var e=[];return t.forEach(function(t){var i=this.topicsHash[t];i&&e.push(i)},this),e},this.requiresRemoteSuggestions=function(t){var e=n.getFirstChar(t.query),i=t.topicsMustStartWithHashtag&&h.indexOf(e)===-1;return!(!t||!t.query||i)&&this.attr.remoteQueriesEnabled},this.processRemoteSuggestions=function(t,e,i){var s=i[this.attr.id]||[],n={};return s.forEach(function(t){var e=t.topic||t.hashtag;n[e.toLowerCase()]=!0},this),e[this.attr.remoteType]&&e[this.attr.remoteType].forEach(function(t){var e=t.topic||t.hashtag;t.searchPath=this.constructSearchPath(e,t.filter),n[e.toLowerCase()]||s.push(t)},this),i[this.attr.id]=s.slice(0,this.attr.limit),i},this.constructSearchPath=function(t,e){var i=["q="+encodeURIComponent(t)],s=e?this.attr.modePathMap[e]:"";return s&&i.push(s),i.push(this.attr.querySourcePathTypeahead),this.attr.basePath+i.join("&")},this.initialize=function(){},this.initialize()}var n=i(281),o=i(225),a=i(20),r=i(25),c=i(540),h=["$","#","＃"];t.exports=s}).call(e,i(1))},function(t,e,i){function s(t){var e={woeid:-1,placeTypeCode:-1,name:"No se encontraron resultados. Intenta seleccionando desde una lista."};this.attr={id:null,items:[],limit:10},this.attr=n.merge(this.attr,t),this.getRemoteSuggestions=function(t,e,i){return i},this.requiresRemoteSuggestions=function(t){return!1},this.getLocalSuggestions=function(t,i){var s=this.attr.items,n=function(t){return t.replace(/\s+/g,"").toLowerCase()};if(t&&t.query){var o=n(t.query);s=this.attr.items.filter(function(t){return 0===n(t.name).indexOf(o)})}i(s.length?s.slice(0,this.attr.limit):[e])},this.setTrendLocations=function(t){this.attr.items=t.trendLocations}}var n=i(25);i(22);t.exports=s},function(t,e,i){(function(e){function s(t){this.attr={id:null,ttl_ms:216e5,limit:3,version:1,storageList:"conciergeList",storageVersion:"conciergeVersion",prefetchLimit:3,localQueriesEnabled:!1,remoteQueriesEnabled:!1,prefetchPath:"/i/search/typeahead.json",prefetchType:"oneclick",remotePath:"/i/search/typeahead.json",remoteType:"oneclick",basePath:"/search?",scribeMap:{images:"photos",videos:"video",news:"news",users:"people"},nameMap:{"images near":"Fotos cerca de ti","images follow":"Fotos de las personas que sigues","videos near":"Vídeos cerca de ti","videos follow":"Vídeos de las personas que sigues","news near":"Noticias cerca de ti","news follow":"Noticias compartidas por las personas que sigues","users near":"Personas cerca de ti"},modePathMap:{images:"mode=photos",videos:"mode=videos",news:"mode=news",users:"mode=users"},locationFilterPath:"near=me",followFilterPath:"f=follows",querySourcePath:"src=taoc",querySource:"typeahead_oneclick"},this.attr=o.merge(this.attr,t),this.after=e.noop,this.defaultAttrs=e.noop,n.mixin(this,[r,c]),this.getStorageKeys=function(){return[this.attr.storageVersion,this.attr.storageList]},this.getPrefetchCount=function(){return this.attr.prefetchLimit},this.isMetadataExpired=function(){var t=this.storage.getItem(this.attr.storageVersion);return t!==this.attr.version},this.getDataFromLocalStorage=function(){this.conciergeList=this.storage.getItem(this.attr.storageList)||this.conciergeList},this.processResults=function(t){return t&&t[this.attr.prefetchType]?(t[this.attr.prefetchType].forEach(function(t){var e=this.constructConciergeSuggestion(t);e&&this.conciergeList.push(e)},this),this.storage.setItem(this.attr.storageList,this.conciergeList,this.attr.ttl_ms),void this.storage.setItem(this.attr.storageVersion,this.attr.version,this.attr.ttl_ms)):void this.useStaleData()},this.getLocalSuggestions=function(t,e){e(t&&""!==t.query?[]:this.conciergeList.slice(0,this.attr.limit))},this.requiresRemoteSuggestions=function(t){return!(!t||""!==t.query)&&this.attr.remoteQueriesEnabled},this.processRemoteSuggestions=function(t,e,i){var s=i[this.attr.id]||[];if(e[this.attr.remoteType])for(var n=e[this.attr.remoteType],o=0;o<n.length;o++){var a=this.constructConciergeSuggestion(n[o]);if(a){var r=s.push(a);if(r>=this.attr.limit)break}}return i[this.attr.id]=s.slice(0,this.attr.limit),i},this.constructConciergeSuggestion=function(t){var e=t.filter,i=!!t.location,s=!!t.follow,n=t.topic,o=this.constructName(e,i,s,n);return o?{topic:n,searchPath:this.constructSearchPath(e,i,s,n),name:o,querySource:this.attr.querySource,searchDetails:this.constructScribeDetails(e,i,s,n)}:null},this.constructName=function(t,e,i,s){var n=e?" near":"",o=i?" follow":"",a=s||this.attr.nameMap[t+n+o];return a},this.constructSearchPath=function(t,e,i,s){var n=[this.attr.querySourcePath],o=t?this.attr.modePathMap[t]:"";return o&&n.push(o),e&&n.push(this.attr.locationFilterPath),i&&n.push(this.attr.followFilterPath),s&&n.push("q="+encodeURIComponent(s)),this.attr.basePath+n.join("&")},this.constructScribeDetails=function(t,e,i,s){var n={result_type:this.attr.scribeMap[t]||"everything",social_filter:i?"following":"all"};return s&&(n.query=s),e&&(n.near="me"),n},this.initialize=function(){var t=a({withExpiry:!0});this.storage=new t("typeahead"),this.conciergeList=[],this.attr.localQueriesEnabled&&this.loadData(this.attr.prefetchPath,this.attr.prefetchType)},this.initialize()}var n=i(20),o=i(25),a=(i(22),i(226)),r=i(225),c=i(540);t.exports=s}).call(e,i(1))},function(t,e,i){function s(t){this.attr={id:null,maxLength:100,querySource:"typed_query",items:[]},this.attr=n.merge(this.attr,t),this.getRemoteSuggestions=function(t,e,i){return i},this.requiresRemoteSuggestions=function(){return!1},this.removeAllSelectedUsers=function(){this.attr.items=[]},this.getLocalSuggestions=function(t,e){e(this.attr.items.slice(0,this.attr.maxLength))},this.updateSelectedUsers=function(t){this.attr.items=t.items}}var n=i(25);t.exports=s},function(t,e,i){function s(t){this.attr={id:null,maxLength:10,querySource:"typed_query",customItems:[],ttl_ms:12096e5,storageList:"recentlySelectedList"},this.attr=n.merge(this.attr,t),this.getRemoteSuggestions=function(t,e,i){return i},this.requiresRemoteSuggestions=function(){return!1},this.updateStorage=function(){this.storage.setItem(this.attr.storageList,this.storageItems,this.attr.ttl_ms)},this.updateRecentlySelectedUsers=function(t){var e=this.storageItems;t.items.forEach(function(t){this.removeRecentUserFromList(t),e.unshift(t),e.length>this.attr.maxLength&&(this.storageItems=e.slice(0,this.attr.maxLength))},this),this.updateStorage()},this.removeRecentUserFromList=function(t){var e=this.storageItems,i=this.getSuggestionIndexById(t,e);i!==-1&&e.splice(i,1)},this.getSuggestionIndexById=function(t,e){for(var i=0;i<e.length;i++)if(e[i].id===t.id)return i;return-1},this.getLocalSuggestions=function(t,e){for(var i=this.storageItems.slice(0,this.attr.maxLength),s=0;i.length<this.attr.maxLength&&s<this.attr.customItems.length;s++){var n=this.attr.customItems[s];this.getSuggestionIndexById(i,n)===-1&&i.push(n)}e(i)},this.updateCustomItems=function(t){this.attr.customItems=t.items},this.initialize=function(){var t=o({withExpiry:!0});this.storage=new t("typeahead"),this.storageItems=this.storage.getItem(this.attr.storageList)||[]},this.initialize()}var n=i(25),o=i(226);t.exports=s},function(t,e,i){(function(e){function s(){var t=Array.prototype.slice.call(arguments);if(!(this instanceof s)){var e=t[0],i=e.dbName,a=e.dbVersion,r=o.open(i,a),c=r.then(function(t){return new s(t)});return n(c,e)}this.database=t[0]}function n(t,i){return i=i||{},t.then(i.onSuccess||e.noop,i.onFailure||e.noop)}var o=i(542);t.exports=s,s.prototype.closeConnection=function(){this.database.close()},s.prototype.getItemByKey=function(t){var e=this.database.get(t.objectStoreName,t.key);return n(e,t)},s.prototype.getItemsByPrefix=function(t){var e=this.database.getByPrefix(t.objectStoreName,t.index,t.prefix);return n(e,t)},s.prototype.addItems=function(t){var e={};return e[t.objectStoreName]=t.items,n(this.database.add(e),t)},s.prototype.upsertItems=function(t){var e={};return e[t.objectStoreName]=t.items,n(this.database.put(e),t)},s.prototype.createObjectStore=function(t){var e=this.database.name,i=this.database.version;this.database.close();var s={name:t.objectStoreName,keyPath:t.keyPathName,indexes:t.indexes||[]},a=o.open(e,i+1,[s],!0);return n(a.then(function(t){this.database=t}.bind(this)),t)},s.prototype.deleteItem=function(t){var e=this.database.destroy(t.objectStoreName,t.key);return n(e,t)},s.prototype.clearObjectStore=function(t){var e=this.database.clear(t.objectStoreName);return n(e,t)},s.prototype.clearAllObjectStores=function(t){var e=this.database.clear();return n(e,t)},s.prototype.checkIfObjectStoreExists=function(t){return this.database.stores.indexOf(t)>-1}}).call(e,i(1))},function(t,e,i){(function(e){function s(){this.defaultAttrs({tweetboxSelector:".tweet-box-shadow"}),this.storeCompletionData=function(t,e){if(e.scribeContext&&"tweet_box"===e.scribeContext.component){var i="account"===e.source?"@"+e.display:e.display;this.completions.push(i)}},this.handleTweetCompletion=function(t,i){if("tweet_box"===i.scribeContext.component){var s=e(t.target).find(this.attr.tweetboxSelector).val(),n=a.extractEntitiesWithIndices(s).filter(function(t){return t.screenName||t.cashtag||t.hashtag});n=n.map(function(t){return s.slice(t.indices[0],t.indices[1])});var o=n.filter(function(t){return this.completions.indexOf(t)>=0},this);if(this.completions=[],0!==n.length){var r={query:i.query,message:n.length,event_info:o.length,format_version:2};this.scribe("entities",i,r)}}},this.scribeSelection=function(t,e){if(!e.fromSelectionEvent||"uiTypeaheadItemComplete"!==t.type){var i,s={element:"typeahead_"+e.source,action:"select"};"uiTypeaheadItemComplete"===t.type?i="autocomplete":e.isClick?i="click":"uiTypeaheadItemSelected"===t.type&&(i="key_select");var n={position:e.index,description:i};"account"===e.source?(n.item_type=r.user,n.id=e.query):"topics"===e.source?(n.item_type=r.search,n.item_query=e.query):"saved_search"===e.source?(n.item_type=r.savedSearch,n.item_query=e.query):"recent_search"===e.source?(n.item_type=r.search,n.item_query=e.query):"trend_location"===e.source?(n.item_type=r.trend,n.item_query=e.item.woeid,e.item.woeid===-1&&(s.action="no_results")):"concierge"===e.source&&(n.item_type=r.search,n.item_query=e.query||e.item.name);var o={message:e.input,items:[n],format_version:2,event_info:e.item?e.item.origin:null,search_details:e.item?e.item.searchDetails:null};this.scribe(s,e,o)}},this.scribeMalformedAccount=function(){this.scribe({element:"typeahead_account",action:"empty"})},this.after("initialize",function(){this.completions=[],this.on("uiTypeaheadItemComplete uiTypeaheadItemSelected",this.storeCompletionData),this.on("uiTypeaheadItemComplete uiTypeaheadItemSelected",this.scribeSelection),this.on("uiTweetboxTweetSuccess uiTweetboxReplySuccess",this.handleTweetCompletion),this.on("uiTypeaheadAccountMalformed",this.scribeMalformedAccount)})}var n=i(10),o=i(40),a=i(218),r=i(42);t.exports=n(s,o)}).call(e,i(1))},function(t,e,i){var s=i(233),n=i(10);t.exports=n(function(){this.triggerCommand=function(){var t=this.attr.href,e=s.queryMap(t);switch(e.action){case"compose":this.trigger("uiOpenTweetDialog",this._trimParams(["action","mode"],e)),this._removeQueryStringFromUrl();break;case"overlay":e.screen_name&&e.tweet_id&&(this.trigger("uiOverlayNavigate",{href:e.screen_name+"/status/"+e.tweet_id}),this._removeQueryStringFromUrl())}},this._removeQueryStringFromUrl=function(){if(window.history&&history.replaceState){var t=window.location.href.replace(/\?[^#]*/,"");history.replaceState({title:document.title},document.title,t)}},this._trimParams=function(t,e){var i={};return Object.getOwnPropertyNames(e).forEach(function(s){t.indexOf(s)>=0&&(i[s]=e[s])}),i},this.after("initialize",function(){"string"==typeof this.attr.href&&this.on("uiSwiftLoaded",this.triggerCommand)})})},function(t,e,i){(function(e){function s(){this.defaultAttrs({backgroundSelector:"#uz_bg",containerSelector:"#uz_popup_container",backgroundParentSelector:"body",blockUserSurveyClass:"uz_block_user_survey"}),this.fadeoutSurvey=function(t){e(this.attr.containerSelector).fadeOut(500)},this.openSurvey=function(){window._uzactions=window._uzactions||[];var t=this.overrideCookie?this.overrideCookie:"twittersurvey"+this.surveyId;window._uzactions.push(["_setCookie",t]),window._uzactions.push(["_setCustomVar",["userID",o.user.id]]),window._uzactions.push(["_setCustomVar",["guestId",o.user.guestId]]),window._uzactions.push(["_start"]);var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(e.extend(document.createElement("script"),{type:"text/javascript",async:!0,id:"injected_uz_survey_script",charset:"utf-8",src:"https://cdn5.userzoom.com/files/js/"+this.surveyId+".js?t=uz_til&cuid=2BA733EB49F6DF1188490022196C4538"}),i)},this.onBlockAction=function(){this.$node.hasClass(this.attr.blockUserSurveyClass)&&this.openSurvey()},this.after("initialize",function(){this.surveyId=this.$node.attr("data-survey-id"),this.overrideCookie=this.$node.attr("data-override-cookie"),this.$node.attr("data-show")&&this.openSurvey(),this.on(document,"uiOpenSurvey",this.openSurvey),this.on(this.attr.backgroundParentSelector,"click",{backgroundSelector:this.fadeoutSurvey}),this.on(document,"uiBlockAction",this.onBlockAction)})}var n=i(10),o=i(34);t.exports=n(s)}).call(e,i(1))},,function(t,e,i){(function(e){function s(t){if(!t.no_global_infinite_scroll){var i=t.infiniteScrollNode||window;n.attachTo(i,{contentSelector:t.contentSelector,immediatelyRequestMoreItems:e(".stream-container").hasClass("js-request-more-stream-items")})}var s=t.inOverlay?".PermalinkOverlay":document;a.attachTo(s,t),o.attachTo(document)}var n=i(319),o=i(558),a=i(559);t.exports=s}).call(e,i(1))},function(t,e,i){(function(e){function s(){var t,i="webkitfullscreenchange",s="onwebkitfullscreenchange",n=s in document;this.getFullscreenElement=function(){return document.webkitFullscreenElement},this.getYOffset=function(){return o.getGlobalYOffset()},this.supportsFullscreen=function(){return n},this.isEnteringFullscreen=function(){return Boolean(this.getFullscreenElement())},this.saveFullscreenElement=function(){t=this.getFullscreenElement()},this.scrollToFullscreenElement=function(){if(t){var i=e(t).parents('[data-component-context="tweet"]');i&&"function"==typeof i.offset&&i.offset()&&window.scrollTo(window.scrollX,i.offset().top-o.getGlobalYOffset()),t=void 0}},this.changeFullScreen=function(t,e){this.isEnteringFullscreen()?this.saveFullscreenElement():this.scrollToFullscreenElement()},this.after("initialize",function(){this.supportsFullscreen()&&this.on(document,i,this.changeFullScreen)})}var n=i(10),o=i(74),a=n(s);t.exports=a}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({defaultAjaxData:{include_entities:1,include_available_features:1},noShowError:!0,startPollingInterval:7500,maxPollingInterval:6e4}),this.requestItems=function(t,e){t&&t.stopPropagation();var i=function(i){this.hasTornDown||(e.isNewItemRequest?this.hasActiveNewItemsRequest=!1:this.hasActiveOldItemsRequest=!1,this.trigger(t.target,"dataGotMoreTimelineItems",i))},s=this.requestInterval,n=function(i){this.hasTornDown||(i&&i.xhr&&"timeout"===i.xhr.statusText&&s===this.requestInterval&&(this.requestInterval=Math.min(2*this.requestInterval,this.attr.maxPollingInterval)),e.isNewItemRequest?this.hasActiveNewItemsRequest=!1:this.hasActiveOldItemsRequest=!1,this.trigger(t.target,"dataGotMoreTimelineItemsError",i))},a=e&&e.headers||{};e&&e.fromPolling&&(a["X-Twitter-Polling"]=!0);var r={contextual_tweet_id:e.contextual_tweet_id,cursor:e.cursor,cursor_index:e.cursor_index,cursor_offset:e.cursor_offset,min_position:e.min_position,max_position:e.max_position,is_forward:e.is_forward,latent_count:e.latent_count,composed_count:e.composed_count,composed_ids:e.composed_ids,include_new_items_bar:e.include_new_items_bar,interval:e.interval,count:e.count,timeline_empty:e.timeline_empty,reset_error_state:e.reset_error_state};e.query&&(r.q=e.query),e.curated_timeline_since_id&&(r.curated_timeline_since_id=e.curated_timeline_since_id),e.scroll_cursor&&(r.scroll_cursor=e.scroll_cursor),e.refresh_cursor&&(r.refresh_cursor=e.refresh_cursor),e.excluded&&(r.excluded=e.excluded);var c=e.isNewItemRequest&&this.hasActiveNewItemsRequest||!e.isNewItemRequest&&this.hasActiveOldItemsRequest;c||(this.hasActiveNewItemsRequest=!(!this.hasActiveNewItemsRequest&&!e.isNewItemRequest),this.hasActiveOldItemsRequest=!(!this.hasActiveOldItemsRequest&&e.isNewItemRequest),this.get({url:this.attr.endpoint,headers:a,timeout:this.requestInterval,data:o.merge(this.attr.defaultAjaxData,r),eventData:e,success:i.bind(this),error:n.bind(this)}))},this.before("teardown",function(){this.hasTornDown=!0}),this.after("initialize",function(){this.hasActiveNewItemsRequest=!1,this.hasActiveOldItemsRequest=!1,this.requestInterval=this.attr.startPollingInterval,this.on("uiWantsMoreTimelineItems",this.requestItems)})}var n=i(10),o=i(25),a=i(225);t.exports=n(s,a)},,,,,,,,,,,,,,,,,,,,function(t,e,i){(function(e){function s(){this.defaultAttrs({successFromEndpoints:{destroy:"dataDidDeleteTweet",retweet:"dataDidRetweet",like:"dataDidFavoriteTweet",unretweet:"dataDidUnretweet",unlike:"dataDidUnfavoriteTweet",report:"dataDidReportTweet",pin:"dataDidUserPinTweet",unpin:"dataDidUserUnpinTweet"},errorsFromEndpoints:{destroy:"dataFailedToDeleteTweet",retweet:"dataFailedToRetweet",like:"dataFailedToFavoriteTweet",unretweet:"dataFailedToUnretweet",unlike:"dataFailedToUnfavoriteTweet",report:"dataFailedToReportTweet",pin:"dataFailedToUserPinTweet",unpin:"dataFailedToUserUnpinTweet"},statsName:"swift_tweet_actions"});var t=e("html").attr("lang");this.takeAction=function(e,i,s){var n,a=o.getDeciderValue("use_api_for_tweet_like")&&"like"===e,c=function(i){i&&i.message&&this.trigger("uiShowMessage",{message:i.message}),this.trigger(this.attr.successFromEndpoints[e],i);var s=r.normalizeProfileStats(i);s&&this.trigger("dataGotProfileStats",{stats:s});var n=r.normalizeTweetStats(i,t);n&&this.trigger("dataGotTweetStats",{stats:n})},h=function(t,e){return t?"https://api.twitter.com/1.1/favorites/create.json":"/i/tweet/"+e};n=("like"===e||"retweet"===e)&&"retweetId"in s?{id:s.retweetId}:"report"===e?{tweet_id:s.tweetId,user_id:s.userId,screen_name:s.screenName,block_user:s.blockUser,report_type:s.reportType}:{id:s.id},s.tweetStatCount&&(n.tweet_stat_count=s.tweetStatCount),s.impressionId&&(n.impression_id=s.impressionId,s.disclosureType&&(n.earned="earned"===s.disclosureType)),s.featureContext&&(n.feature_context=s.featureContext);var l={destroy:"DELETE",unretweet:"DELETE"};this.JSONRequest({url:h(a,e),data:n,eventData:s,success:c.bind(this),error:this.attr.errorsFromEndpoints[e],retryIfUnavailable:!0,statsSubcategory:e,useAuthSessionAuth:a},l[e]||"POST")},this.hitEndpoint=function(t){return this.takeAction.bind(this,t)},this.getTweet=function(t,e){var i={id:e.id};e.modal&&(i.modal=e.modal),this.get({url:e.hasStickers?"/i/tweet/stickersHtml":"/i/tweet/html",statsSubcategory:"html",data:i,eventData:e,success:"dataGotTweet",error:"dataFailedToGetTweet"})},this.after("initialize",function(){this.on("uiDidRetweet",this.hitEndpoint("retweet")),this.on("uiDidUnretweet",this.hitEndpoint("unretweet")),this.on("uiDidDeleteTweet",this.hitEndpoint("destroy")),this.on("uiDidFavoriteTweet",this.hitEndpoint("like")),this.on("uiDidUnfavoriteTweet",this.hitEndpoint("unlike")),this.on("uiDidBlockOrReport uiDidReportTweet",this.hitEndpoint("report")),this.on("uiGetTweet",this.getTweet),this.on("uiDidUserPinTweet",this.hitEndpoint("pin")),this.on("uiDidUserUnpinTweet",this.hitEndpoint("unpin"))})}var n=i(10),o=i(34),a=i(225),r=i(580),c=n(s,a);t.exports=c}).call(e,i(1))},function(t,e,i){function s(t,e){return t>=1e3&&p.indexOf(e)===-1}function n(t){return t<9950?1:t<1e6?0:1}function o(t){return u.format(t,{precision:n(t)})}function a(t){return m.format(t)}function r(t,e){return s(t,e)?o(t):a(t)}function c(t,e){function i(t){return void 0===t.retweeted_status?t.favorite_count:t.retweeted_status.favorite_count}var s=i(t);if(t.tweet_stats)return t.tweet_stats;if(void 0!==s){var n=r(s,e),o=m.format(s),a=l.getFavoriteStatTitle(s,o),c=[{status_id:t.id_str,name:"favorite",count:s,commaized_count:o,compact_count:n,title:a}];return c}}function h(t){if(t.profile_stats)return t.profile_stats;if(void 0!==t.user){var e=t.user.favourites_count,i=m.format(e),s=l.getFavoriteStatPhrase(e,i),n=l.getNumericStatText(e,i),o=[{highline_stat_phrase:s,highline_stat_value:n,html:"\n",stat:"favorite",user_id:t.user.id_str}];return o}}var l=i(581),d=i(343),u=new d.ShortDecimalFormatter,m=new d.DecimalFormatter,p=["ja","ko","nl"];t.exports={compactOrCommaize:r,getCommaizedFormat:a,normalizeTweetStats:c,normalizeProfileStats:h}},function(t,e,i){function s(t,e){var i={intnumber:t,localized_number:e};return i["intnumber_"+d.PluralRules.rule_for(t)]=!0,i}function n(t,e,i){var n=s(t,e);return l["i18n_helpers/number_phrases/"+i].render(n).trim()}function o(t,e){return n(t,e,"favorite_stat_text_only")}function a(t,e){return n(t,e,"favorite_stat_title")}function r(t,e){return n(t,e,"reply_stat_title")}function c(t,e){return n(t,e,"retweet_stat_title")}function h(t,e){var i={localized_number:e};return i["intnumber_"+d.PluralRules.rule_for(t)]=!0,l["i18n_helpers/number_phrases/numeric_stat_text_only"].render(i).trim()}var l=i(107),d=i(343);t.exports={getFavoriteStatPhrase:o,getNumericStatText:h,getFavoriteStatTitle:a,getReplyStatTitle:r,getRetweetStatTitle:c}},,,,,,,,,function(t,e,i){(function(e){function s(){this.defaultAttrs({containerSelector:".stream-container",itemsSelector:"#stream-items-id",genericItemSelector:".js-stream-item",timelineEndSelector:".timeline-end",backToTopSelector:".back-to-top",lastItemSelector:".stream-item:last",streamItemContentsSelector:".js-actionable-tweet, .js-actionable-user, .js-activity, .js-story-item",truncationLimit:200,highlightedSelector:".stream-container .stream li.js-stream-item.js-activity",tweetContainerSelector:"li",reloadTimelineSelector:".js-reload-timeline",useDeduping:!1}),this.findFirstItemContent=function(t){var i=t.find(this.attr.streamItemContentsSelector);return i=i.not(".conversation-tweet"),e(i[0])},this.injectItems=function(t,i,s,n){var o=e("<div/>").html(i),a=this.getItemsToInject(o),r=o.find(this.attr.genericItemSelector);if(a.length>0&&this.select("timelineEndSelector").addClass("has-items"),"prepend"===t&&a.length>this.attr.truncationLimit&&(a.length=this.attr.truncationLimit,r.length=this.attr.truncationLimit),this.injectToDOM(t,a),this.reportInjectedItems(r,s,n),"prepend"===t){var c=this.select("itemsSelector");c.find(">:gt("+(this.attr.truncationLimit-1)+")").remove();for(var h,l=c.children().last();l.find(".promoted-tweet").length;)h=l.prev(),l.remove(),l=h}return a},this.getItemsToInject=function(t){return t.children()},this.injectToDOM=function(t,e){this.select("itemsSelector")[t](e)},this.removeDuplicates=function(t){var e=[];return t.filter(function(t){return!t.tweetId||e.indexOf(t.tweetId)===-1&&(e.push(t.tweetId),!0)})},this.extractTimestamp=function(t){return t.find("[data-time-ms]").attr("data-time-ms")},this.reportInjectedItems=function(t,i,s){function n(t){return"uiHasInjectedNewTimeline"===i||"uiHasInjectedOldTimelineItems"===i||"uiHasInjectedRangeTimelineItems"===i}var o=[],a=0;t.each(function(t,s){n(i)&&(o=o.concat(this.extraInteractionData(e(s))),o.push(this.interactionData(this.findFirstItemContent(e(s)))),a=Math.max(a,this.extractTimestamp(e(s)))),this.trigger(s,"uiHasInjectedTimelineItem")}.bind(this)),o=this.removeDuplicates(o);var c={};n(i)&&(c={scribeContext:{component:"stream"},scribeData:{},items:o},s&&s.autoplay&&(c.scribeData.event_initiator=r.clientSideApp)),this.trigger("uiWantsToRefreshTimestamps"),this.trigger(i,c)},this.inspectItemsFromServer=function(t,e){this.isOldItem(e)?this.injectOldItems(e):this.isNewItem(e)?this.notifyNewItems(e):this.wasRangeRequest(e)&&this.injectRangeItems(e)},this.investigateDataError=function(t,e){var i=e.sourceEventData;i&&(this.wasRangeRequest(i)?this.notifyRangeItemsError(e):this.wasNewItemsRequest(i)||this.wasOldItemsRequest(i)&&this.notifyOldItemsError(e))},this.possiblyShowBackToTop=function(){var t=this.select("lastItemSelector").position();t&&t.top>=e(window).height()&&this.select("backToTopSelector").show()},this.scrollToTop=function(){h(0,"fast")},this.getTimelinePosition=function(t){return t.closest(this.attr.genericItemSelector).index()},this.updateHighlighting=function(t,i){var s=this.select("highlightedSelector");s.each(function(t,s){var n=e(s),o=this.extractTimestamp(n);n.toggleClass("highlighted",o>i),o<=i&&n.removeClass("highlighted")}.bind(this))},this.handleTweetRemoved=function(){this.select("genericItemSelector").length||this.select("timelineEndSelector").removeClass("has-items")},this.handleTweetDelete=function(t,i){var s=this.$node.find('[data-tweet-id="'+i.sourceEventData.id+'"]');s.toArray().forEach(function(t,s){var n=e(t);this.trigger(n,"uiBeforeTweetRemoved",i),n.closest(this.attr.tweetContainerSelector).remove(),this.trigger("uiTweetRemoved",i)},this)},this.reloadTimeline=function(t,e){t.preventDefault(),this.trigger("uiNearTheBottom")},this.injectDeferredItems=function(){var t=this.$node.find('script[type="text/twitter-deferred-timeline-stream-items"]');t.length&&(this.injectItems("append",t.html(),"uiHasInjectedOldTimelineItems"),t.remove())},this.after("initialize",function(){this.on("dataGotMoreTimelineItems",this.inspectItemsFromServer),this.on("dataGotMoreTimelineItemsError",this.investigateDataError),this.on(document,"uiUpdateActivityHighlighting",this.updateHighlighting),this.on("uiTweetRemoved",this.handleTweetRemoved),this.on("uiReplyToTweet","uiOpenReplyDialog"),this.on(document,"dataDidDeleteTweet",this.handleTweetDelete),this.on("click",{backToTopSelector:this.scrollToTop,reloadTimelineSelector:this.reloadTimeline}),this.possiblyShowBackToTop(),window.requestIdleCallback(this.injectDeferredItems.bind(this))})}var n=i(10),o=i(591),a=i(36),r=i(593),c=i(594),h=i(578),l=i(595),d=i(596);t.exports=n(s,o,a,c,l,d)}).call(e,i(1))},function(t,e,i){(function(e){function s(){n.mixin(this,[o]),this.defaultAttrs({navigationActiveClass:"js-navigation-active",selectedClass:"selected-stream-item",unselectableClass:"js-unselectable-stream-item",firstItemSelector:".js-stream-item:first-child:not(.js-unselectable-stream-item)",profilePageSelector:".route-profile",profileOwnerUserIdSelector:".ProfileNav .user-actions",pushStateSelector:"a.js-nav",selectedSelector:".selected-stream-item"}),this.moveSelection=function(t){var i=e(t.target);if(!i.closest(this.attr.selectedSelector).length){var s=i.closest(this.attr.genericItemSelector);i.closest(this.attr.pushStateSelector).length&&(this.$linkClicked=s,clearTimeout(this.linkTimer),this.linkTimer=setTimeout(function(){this.$linkClicked=e()}.bind(this),0)),this.$selected.length&&this.selectItem(s)}},this.clearSelection=function(){var t=e(this.attr.selectedSelector);this.$previousSelection=t,t.removeAttr("tabIndex").removeClass(this.attr.selectedClass),this.$selected=e(),this.trigger(t,"uiTimelineSelectionCleared")},this.selectTopItemHandler=function(){this.selectTopItem()},this.selectTopItem=function(t){this.clearSelection(),this.trigger("uiInjectNewItems",t||{}),this.selectAdjacentItem("next",{scrollToTop:!0})},this.injectAndPossiblySelectTopItem=function(t,e){var i=this.$selected.length;i&&this.clearSelection(),this.trigger("uiInjectNewItems",e||{}),i&&this.selectAdjacentItem("next")},this.selectTopItemByKeyboard=function(){this.selectTopItem({wasPeriodPress:!0})},this.selectPrevItem=function(){this.selectAdjacentItem("prev")},this.selectNextItem=function(t,e){this.selectAdjacentItem("next",e)},this.selectNextAdjacentItem=function(){var t=this.$selected;this.selectAdjacentItem("next"),t===this.$selected&&this.selectAdjacentItem("prev")},this.selectNextItemNotFrom=function(t){for(var e="next",i=this.$selected;this.getUserIdFromNode(this.$selected)===t;)if(this.selectAdjacentItem(e),i===this.$selected){if("next"!==e)return;e="prev"}else i=this.$selected},this.getAdjacentParentItem=function(t,e){var i=t.closest(".js-navigable-stream"),s=t;return i.length&&(t=i.closest(".js-stream-item"),s=t[e](),!s.length)?this.getAdjacentParentItem(t,e):s},this.getAdjacentChildItem=function(t,e){var i=t,s=i.hasClass("js-has-navigable-stream"),n="next"===e?"first-child":"last-child";return i.length&&s?(i=i.find(".js-navigable-stream").eq(0).find(">li:"+n),this.getAdjacentChildItem(i,e)):i},this.selectAdjacentItem=function(t,e){var i;if(i=this.$selected.length?this[t](this.$selected):this.select("firstItemSelector").eq(0),i.length||(i=this.getAdjacentParentItem(this.$selected,t)),i=this.getAdjacentChildItem(i,t),i.length&&i.hasClass(this.attr.unselectableClass))return this.$selected=i,this.selectAdjacentItem(t,e);this.selectItem(i);var s="next"===t?"uiNextItemSelected":"uiPreviousItemSelected";this.trigger(this.$selected,s),this.focusSelected(),!i.length||e&&e.maintainPosition||this.adjustScrollForSelectedItem(e)},this.next=function(t){return t.next()},this.prev=function(t){return t.prev()},this.selectItem=function(t){t.length&&this.$selected!==t&&(this.clearSelection(),this.$selected=t,this.$selected.addClass(this.attr.selectedClass),this.trigger(this.$selected,"uiTimelineItemSelected"))},this.focusSelected=function(){this.$selected.attr("tabIndex",-1).focus(),setTimeout(function(t){this.trigger(t,"uiAfterTimelineSelectionFocused")}.bind(this),0,this.$previousSelection)},this.deselect=function(t){var i=["HTML","BODY"].indexOf(t.target.tagName)!==-1,s="page-outer"===t.target.id&&!e(t.target).parents("#page-container").length;(i||s)&&this.clearSelection()},this.muteUser=function(){this.triggerBlockActionOnNode(this.$selected,"uiDidMuteUser")},this.blockUser=function(){this.triggerBlockActionOnNode(this.$selected,"uiOpenBlockUserDialog")},this.updateAfterBlock=function(t,i){var s=i.userId.toString()===e(this.attr.profileOwnerUserIdSelector).attr("data-user-id"),n=0!==e(this.attr.profilePageSelector).size();s?this.trigger("uiHideProfileTweets"):n||(this.selectNextItemNotFrom(i.userId),this.trigger("uiRemoveTweetsFromUser",i))},this.removeTweetsAndEngagementsFromUser=function(t,e){this.selectNextItemNotFrom(e.userId),this.trigger("uiRemoveTweetsFromUser",e)},this.updateSelectionBeforeDelete=function(t,e){this.select("genericItemSelector").length&&this.$selected.attr("data-item-id")===e.sourceEventData.id.toString()&&this.selectNextAdjacentItem()},this.adjustScrollForItem=function(t,i){i&&i.scrollToTop?e(window).scrollTop(0):t.length&&e(window).scrollTop(t.offset().top-e(window).height()/10)},this.notifyExpansionRequest=function(t,i){var s=this.$selected.find(".tweet"),n=s.data("permalink-path"),o=s.data("conversation-id");n&&e(document).trigger("uiNavigate",{href:n,conversation_id:o})},this.adjustScrollForSelectedItem=function(t){this.adjustScrollForItem(this.$selected,t)},this.processActiveNavigation=function(){var t=2;setTimeout(this.removeActiveNavigationClass.bind(this),1e3*t)},this.setNavigationActive=function(){this.$linkClicked.addClass(this.attr.navigationActiveClass)},this.removeActiveNavigationClass=function(){var t=this.$node.find("."+this.attr.navigationActiveClass);t.removeClass(this.attr.navigationActiveClass)},this.handleEvent=function(t){return function(){e("body").hasClass("modal-enabled")||this[t].apply(this,arguments)}},this.changeSelection=function(t,i){var s=e(t.target);this.$selected.length&&(this.selectItem(s),
i&&i.setFocus&&this.focusSelected())},this.after("initialize",function(){this.$selected=this.$node.find(this.attr.selectedSelector),this.$linkClicked=e(),this.on(document,"uiShortcutSelectPrev",this.handleEvent("selectPrevItem")),this.on(document,"uiShortcutSelectNext uiSelectNext",this.handleEvent("selectNextItem")),this.on(document,"uiSelectItem",this.handleEvent("changeSelection")),this.on(document,"uiShortcutEnter",this.handleEvent("notifyExpansionRequest")),this.on(document,"uiSelectTopTweet",this.handleEvent("selectTopItemHandler")),this.on(document,"uiShortcutGotoTopOfScreen",this.handleEvent("selectTopItemByKeyboard")),this.on(document,"uiGotoTopOfScreen",this.handleEvent("injectAndPossiblySelectTopItem")),this.on(document,"uiShortcutMuteUser",this.handleEvent("muteUser")),this.on(document,"uiShortcutBlock",this.handleEvent("blockUser")),this.on(document,"uiUpdateAfterBlock",this.updateAfterBlock),this.on(document,"uiRemoveTweetsAndEngagementsFromUser",this.removeTweetsAndEngagementsFromUser),this.on(document,"uiBeforeTweetRemoved",this.updateSelectionBeforeDelete),this.on(document,"uiRemovedSomeTweets",this.adjustScrollForSelectedItem),this.on(document,"uiBeforePageChanged uiClearSelection",this.clearSelection),this.on(document,"uiPageChanged",this.processActiveNavigation),this.on("click",{genericItemSelector:this.moveSelection}),this.on(document,"uiNavigate",this.setNavigationActive),this.on(document,"click",this.deselect)})}var n=i(20),o=i(592);t.exports=s}).call(e,i(1))},function(t,e,i){function s(){this.defaultAttrs({actionableTweetSelector:".js-actionable-tweet"}),this.triggerBlockActionOnNode=function(t,e){!this.itemIsMine(t)&&this.itemIsBlockable(t)&&this.trigger(t,e,{userId:this.getUserIdFromNode(t),username:this.getUsernameFromNode(t),tweetId:this.getUserTweetIdFromNode(t),fromShortcut:!0})},this.getUserIdFromNode=function(t){var e=n.getId(t);return e||(e=n.getId(t.find("[data-user-id]"))),e},this.getUserTweetIdFromNode=function(t){var e=t.attr("data-tweet-id");return e||(e=t.find("[data-tweet-id]").attr("data-tweet-id")),e},this.getUsernameFromNode=function(t){var e=n.getName(t);return e||(e=n.getName(t.find("[data-name]"))),e},this.itemIsMine=function(t){return t.is(this.attr.ownTweetSelector)||t.find(this.attr.ownTweetSelector).length>0},this.itemIsBlockable=function(t){return t.find(this.attr.actionableTweetSelector).length>0||t.is(this.attr.actionableTweetSelector)}}var n=i(397);t.exports=s},function(t,e){t.exports={clientSideUser:0,serverSideUser:1,clientSideApp:2,serverSideApp:3}},function(t,e,i){(function(e){"use strict";function i(){this.defaultAttrs({focusClass:"focus",focusContainerSelector:".tweet"}),this.addFocusStyle=function(t,i){e(i.el).addClass(this.attr.focusClass)},this.addFocusStyleToTarget=function(t){e(t.target).addClass(this.attr.focusClass)},this.removeFocusStyle=function(t,i){setTimeout(function(){var t=i.el,s=document.activeElement;e.contains(t,s)||t===s||e(t).removeClass(this.attr.focusClass)}.bind(this),0)},this.after("initialize",function(){this.on(document,"uiShouldAddFocusStyle",this.addFocusStyleToTarget),this.on("focusin",{focusContainerSelector:this.addFocusStyle}),this.on("focusout",{focusContainerSelector:this.removeFocusStyle})})}t.exports=i}).call(e,i(1))},function(t,e,i){(function(e){function s(t,e){return t=t.getAttribute("data-aria-label-part")||0,e=e.getAttribute("data-aria-label-part")||0,"last"===t?1:"last"===e?-1:(t=parseInt(t,10),e=parseInt(e,10),t||e?t?e?t&&e?t===e?1:t-e:void 0:-1:1:0)}function n(){this.createImageLabel=function(t,i){var s=e(i);s.removeAttr("data-aria-label-part");var n=s.attr("alt");if(n){s.attr({alt:"","data-alt":n});var o=e("<span>",{addClass:"u-hiddenVisually image-description","data-aria-label-part":"",text:_("Imagen: {{imageDescription}}",{imageDescription:n})});s.before(o)}},this.createARIALabel=function(t,i){var n=t.target,a=e(n),r=a.find("img[data-aria-label-part]");r.each(this.createImageLabel);var c=a.find("[data-aria-label-part]").toArray();if(c.length){c.sort(s);var h=c.map(function(t,e){return o(t)});n.setAttribute("aria-labelledby",h.join(" ")),r.attr("data-aria-label-part","")}},this.removeItemLabel=function(t,i){var s=e(t.target);s.removeAttr("aria-labelledby").find(".image-description[data-aria-label-part]").remove(),s.find("img[data-alt]").each(function(t,i){var s=e(i);s.attr("alt",s.attr("data-alt")).removeAttr("data-alt")})},this.after("initialize",function(){this.on("uiBeforeTimelineSelectionCleared uiAfterTimelineSelectionFocused",this.removeItemLabel),this.on("uiTimelineItemSelected",this.createARIALabel)})}var _=i(22),o=i(266);t.exports=n}).call(e,i(1))},function(t,e,i){(function(e){function i(){this.registerItem=function(t){var i=e(t),s=i.attr("data-item-id");s&&(this.idHash[s]?this.idHash[s]=!0:this.dedupItem(s))},this.dedupItem=function(t){var i=this.select("genericItemSelector").filter("[data-item-id="+t+"]").filter(function(t,i){return 0===e(i).closest(".js-no-dedup").length}),s=i.slice(1);s.remove()},this.registerInjectedItem=function(t,e){this.registerItem(t.target)},this.registerExistingItems=function(){var t=this.select("genericItemSelector");t.get().forEach(function(t){this.registerItem(t)}.bind(this))},this.after("initialize",function(){this.attr.useDeduping&&(this.idHash={},this.registerExistingItems(),this.on("uiHasInjectedTimelineItem",this.registerInjectedItem))})}t.exports=i}).call(e,i(1))},function(t,e,i){(function(e){function i(){function t(t){return t.removeClass("u-hidden").show()}function i(t){return t.addClass("u-hidden").hide()}this.defaultAttrs({endOfStreamSelector:".stream-footer",errorMessageSelector:".stream-fail-container",tryAgainSelector:".try-again-after-whale"}),this.getOldItems=function(t){t&&t.stopPropagation(),this.shouldGetOldItems()&&this.trigger("uiWantsMoreTimelineItems",this.getOldItemsData())},this.injectOldItems=function(t){this.hideWhaleEnd(),this.resetStateVariables(t),t.has_more_items?this.showMoreSpinner():this.hideMoreSpinner(),this.injectItems("append",t.items_html,"uiHasInjectedOldTimelineItems"),this.possiblyShowBackToTop()},this.notifyOldItemsError=function(t){this.showWhaleEnd()},this.showWhaleEnd=function(){t(this.select("errorMessageSelector")),i(this.select("endOfStreamSelector")),this.select("timelineEndSelector").addClass("has-items-error")},this.hideWhaleEnd=function(){i(this.select("errorMessageSelector")),t(this.select("endOfStreamSelector")),this.select("timelineEndSelector").removeClass("has-items-error")},this.showMoreSpinner=function(){this.select("timelineEndSelector").addClass("has-more-items")},this.hideMoreSpinner=function(){this.select("timelineEndSelector").removeClass("has-more-items")},this.tryAgainAfterWhale=function(t){t.preventDefault(),this.hideWhaleEnd(),this.getOldItems()},this.after("initialize",function(){var t=this.attr.inOverlay?".PermalinkOverlay":window;this.on(t,"uiNearTheBottom",this.getOldItems),this.$document=e(document),this.$window=e(window),this.on("click",{tryAgainSelector:this.tryAgainAfterWhale})})}t.exports=i}).call(e,i(1))},,,,,,,,,function(t,e,i){(function(e){function i(){this.isOldItem=function(t){return"undefined"!=typeof t.min_position},this.isNewItem=function(t){return"undefined"!=typeof t.max_position},this.getNewItemsData=function(){return{min_position:this.max_position,isNewItemRequest:!0}},this.getOldItemsData=function(){return{max_position:this.min_position,reset_error_state:void 0===this.min_position&&void 0===this.max_position&&!e(".permalink-container").length}},this.resetStateVariables=function(t){"undefined"!=typeof t.max_position&&(this.max_position=t.max_position,this.select("containerSelector").attr("data-max-position",this.max_position)),"undefined"!=typeof t.min_position&&(this.min_position=t.min_position,this.select("containerSelector").attr("data-min-position",this.min_position))},this.wasRangeRequest=function(){return!1},this.wasNewItemsRequest=function(t){return this.isOldItem(t)},this.wasOldItemsRequest=function(t){return this.isNewItem(t)},this.shouldGetOldItems=function(){return null!==this.min_position},this.shouldGetNewItems=function(){return null!==this.max_position},this.after("initialize",function(){this.min_position=this.select("containerSelector").attr("data-min-position")||void 0,this.max_position=this.select("containerSelector").attr("data-max-position")||void 0})}t.exports=i}).call(e,i(1))}]));
//# sourceMappingURL=16.commons.es.9a0390d033c9d5e36b63.js.map